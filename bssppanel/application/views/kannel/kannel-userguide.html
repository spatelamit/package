<html>
    <head>
        <title>Kannel 1.4.4 User's Guide</title>
        <meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.79">
    </head>
    <body class="book" alink="#0000FF" bgcolor="#FFFFFF" link="#0000FF" text="#000000" vlink="#840084">
        <div class="BOOK">
            <a name="AEN1"></a>
            <div class="TITLEPAGE">
                <h1 class="title"><a name="AEN2">Kannel 1.4.4 User's Guide</a></h1>
                <h2 class="subtitle">Open Source WAP and SMS gateway</h2>
                <h3 class="author"><a name="AEN6"></a>Andreas Fink</h3>
                <div class="affiliation">
                    <span class="jobtitle">Chairman &amp; CTO<br></span><span class="orgname">Global Networks Inc.<br></span>
                    <div class="address">
                        <p class="address">&nbsp;<code class="email">&lt;<a href="mailto:andreas@fink.org">andreas@fink.org</a>&gt;</code><br>
                            http://www.smsrelay.com/<br>
                            http://www.gni.ch/<br>
                        </p>
                    </div>
                </div>
                <h3 class="author"><a name="AEN16"></a>Bruno Rodrigues</h3>
                <div class="affiliation">
                    <div class="address">
                        <p class="address">&nbsp;<br>
                            <code class="email">&lt;<a href="mailto:bruno.rodrigues@litux.org">bruno.rodrigues@litux.org</a>&gt;</code><br>
                            http://litux.org/bruno<br>
                        </p>
                    </div>
                </div>
                <h3 class="author"><a name="AEN23"></a>Stipe Tolj</h3>
                <div class="affiliation">
                    <span class="jobtitle">System Architect<br></span><span class="orgname">Tolj System Architecture<br></span>
                    <div class="address">
                        <p class="address">&nbsp;<br>
                            <code class="email">&lt;<a href="mailto:stolj@kannel.org">stolj@kannel.org</a>&gt;</code><br>
                            http://www.tolj.org/<br>
                        </p>
                    </div>
                </div>
                <h3 class="author"><a name="AEN32"></a>Aarno Syvï¿½nen</h3>
                <div class="affiliation">
                    <span class="jobtitle">Chief MMS Developer<br></span><span class="orgname">Global Networks Inc.<br></span>
                    <div class="address">
                        <p class="address">&nbsp;<br>
                            <code class="email">&lt;<a href="mailto:as@gni.ch">as@gni.ch</a>&gt;</code><br>
                            http://www.gni.ch/<br>
                        </p>
                    </div>
                </div>
                <h3 class="author"><a name="AEN41"></a>Alexander Malysh</h3>
                <div class="affiliation">
                    <span class="jobtitle">Senior Software Engineer<br></span><span class="orgname">GTX Ltd.<br></span>
                    <div class="address">
                        <p class="address">&nbsp;<br>
                            <code class="email">&lt;<a href="mailto:amalysh at kannel.org">amalysh at kannel.org</a>&gt;</code><br>
                            http://www.gtx-messaging.com/<br>
                        </p>
                    </div>
                </div>
                <h3 class="author"><a name="AEN50"></a>Alejandro Guerrieri</h3>
                <div class="affiliation">
                    <span class="jobtitle">Senior System Architect<br></span><span class="orgname">3Cinteractive, L.L.C.<br></span>
                    <div class="address">
                        <p class="address">&nbsp;<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code class="email">&lt;<a href="mailto:aguerrieri@kannel.org">aguerrieri@kannel.org</a>&gt;</code><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://www.3cinteractive.com/<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        </p>
                    </div>
                </div>
                <h3 class="author"><a name="AEN59"></a>Lars Wirzenius</h3>
                <div class="affiliation"><span class="jobtitle">Gateway architect<br></span><span class="orgname">former Wapit Ltd<br></span></div>
                <h3 class="author"><a name="AEN65"></a>Kalle Marjola</h3>
                <div class="affiliation">
                    <span class="jobtitle">Senior Software Engineer<br></span><span class="orgname">Enpocket<br></span>
                    <div class="address">
                        <p class="address">&nbsp;<br>
                            <code class="email">&lt;<a href="mailto:marjola@enpocket.com">marjola@enpocket.com</a>&gt;</code><br>
                            http://www.enpocket.com<br>
                        </p>
                    </div>
                </div>
                <div>
                    <div class="abstract">
                        <a name="AEN74"></a>
                        <p><b>Abstract</b></p>
                        <p>
                            This document describes how
                            to install and use Kannel, the Open Source WAP and SMS Gateway
                            originally developed by Wapit Ltd (now out of business) and now
                            being developed further by the open source community, namely the 
                            Kannel Group.
                        </p>
                    </div>
                </div>
                <hr>
            </div>
            <div class="TOC">
                <dl>
                    <dt><b>Table of Contents</b></dt>
                    <dt>1. <a href="#AEN81">Introduction</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN99">Overview of WAP</a></dt>
                            <dt><a href="#AEN111">Overview of WAP Push</a></dt>
                            <dt><a href="#AEN118">Overview of SMS</a></dt>
                            <dt><a href="#AEN132">Features</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN134">WAP</a></dt>
                                    <dt><a href="#AEN142">WAP Push</a></dt>
                                    <dt><a href="#AEN150">SMS</a></dt>
                                </dl>
                            </dd>
                            <dt><a href="#AEN163">Requirements</a></dt>
                        </dl>
                    </dd>
                    <dt>2. <a href="#AEN189">Installing the gateway</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN195">Getting the source code</a></dt>
                            <dt><a href="#AEN200">Finding the documentation</a></dt>
                            <dt><a href="#AEN222">Compiling the gateway</a></dt>
                            <dt><a href="#AEN324">Installing the gateway</a></dt>
                            <dt><a href="#AEN340">Using pre-compiled binary packages</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN342">Installing Kannel from RPM packages</a></dt>
                                    <dt><a href="#AEN384">Installing Kannel from DEB packages</a></dt>
                                </dl>
                            </dd>
                        </dl>
                    </dd>
                    <dt>3. <a href="#AEN435">Using the gateway</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN441">Configuring the gateway</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN445">Configuration file syntax</a></dt>
                                    <dt><a href="#includes">Inclusion of configuration files</a></dt>
                                    <dt><a href="#AEN475">Core configuration</a></dt>
                                </dl>
                            </dd>
                            <dt><a href="#AEN778">Running Kannel</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN781">Starting the gateway</a></dt>
                                    <dt><a href="#arguments">Command line options</a></dt>
                                    <dt><a href="#AEN910">Kannel statuses</a></dt>
                                    <dt><a href="#AEN926">HTTP administration</a></dt>
                                </dl>
                            </dd>
                        </dl>
                    </dd>
                    <dt>4. <a href="#wap-gateway">Setting up a WAP gateway</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN1027">WAP gateway configuration</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN1035">Wapbox group</a></dt>
                                </dl>
                            </dd>
                            <dt><a href="#AEN1146">Running WAP gateway</a></dt>
                            <dt><a href="#AEN1149">Checking whether the WAP gateway is alive</a></dt>
                        </dl>
                    </dd>
                    <dt>5. <a href="#wtls">Setting up wtls security</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN1245">Wtls configuration</a></dt>
                        </dl>
                    </dd>
                    <dt>6. <a href="#msisdn-provisioning">Setting up MSISDN provisioning for WAP gateway</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN1287">RADIUS accounting proxy configuration</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN1290">RADIUS-Acct configuration</a></dt>
                                    <dt><a href="#AEN1363">Using the MSISDN provisioning on HTTP server side</a></dt>
                                </dl>
                            </dd>
                        </dl>
                    </dd>
                    <dt>7. <a href="#sms-gateway">Setting up a SMS Gateway</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN1370">Required components</a></dt>
                            <dt><a href="#AEN1376">SMS gateway configuration</a></dt>
                            <dt><a href="#AEN1386">SMS centers</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN1589">Nokia CIMD 1.37 and 2.0</a></dt>
                                    <dt><a href="#AEN1655">CMG UCP/EMI 4.0 and 3.5</a></dt>
                                    <dt><a href="#AEN1870">SMPP 3.3, 3.4 and 5.0</a></dt>
                                    <dt><a href="#AEN2081">Sema Group SMS2000 OIS 4.0, 5.0 and 5.8</a></dt>
                                    <dt><a href="#AEN2191">SM/ASI (for CriticalPath InVoke SMS Center 4.x)</a></dt>
                                    <dt><a href="#AEN2263">GSM modem</a></dt>
                                    <dt><a href="#AEN2549">GSMA OneAPI v1.0 ParlayX SMS SOAP</a></dt>
                                    <dt><a href="#AEN2616">Fake SMSC</a></dt>
                                    <dt><a href="#AEN2646">HTTP-based relay and content gateways</a></dt>
                                    <dt><a href="#AEN2906">Loopback SMSC (MT to MO direction switching)</a></dt>
                                    <dt><a href="#AEN2924">Using multiple SMS centers</a></dt>
                                    <dt><a href="#AEN2930">Feature checklist</a></dt>
                                </dl>
                            </dd>
                            <dt><a href="#AEN3457">External delivery report (DLR) storage</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN3461">Internal DLR storage</a></dt>
                                    <dt><a href="#AEN3466">MySQL DLR storage</a></dt>
                                    <dt><a href="#AEN3532">LibSDB DLR storage</a></dt>
                                    <dt><a href="#AEN3544">Oracle 8i/9i DLR storage</a></dt>
                                    <dt><a href="#AEN3555">PostgreSQL DLR storage</a></dt>
                                    <dt><a href="#AEN3565">MS-SQL/Sybase DLR storage</a></dt>
                                    <dt><a href="#AEN3579">SQLite3 DLR storage</a></dt>
                                    <dt><a href="#AEN3589">Redis DLR storage</a></dt>
                                    <dt><a href="#AEN3659">DLR database field configuration</a></dt>
                                </dl>
                            </dd>
                            <dt><a href="#AEN3737">SMSBox configuration</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN3739">Smsbox group</a></dt>
                                    <dt><a href="#AEN3937">Smsbox routing inside bearerbox</a></dt>
                                    <dt><a href="#AEN3976">SMS-service configurations</a></dt>
                                    <dt><a href="#AEN4412">How sms-service interprets the HTTP response</a></dt>
                                    <dt><a href="#AEN4739">SendSMS-user configurations</a></dt>
                                    <dt><a href="#AEN4886">Over-The-Air configurations</a></dt>
                                    <dt><a href="#AEN5027">Setting up more complex services</a></dt>
                                </dl>
                            </dd>
                            <dt><a href="#AEN5056">Running SMS gateway</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN5058">Using the HTTP interface to send SMS messages</a></dt>
                                    <dt><a href="#AEN5273">Using the HTTP interface to send OTA configuration messages</a></dt>
                                </dl>
                            </dd>
                        </dl>
                    </dd>
                    <dt>8. <a href="#ppg">Setting up Push Proxy Gateway</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN5372">Configuring ppg core group, for push initiator (PI) interface</a></dt>
                            <dt><a href="#AEN5513">Configuring PPG user group variables</a></dt>
                            <dt><a href="#AEN5642">Finishing ppg configuration</a></dt>
                            <dt><a href="#AEN5655">Running a push proxy gateway</a></dt>
                            <dt><a href="#AEN5660">An example using HTTP SMSC</a></dt>
                            <dt><a href="#AEN5663">An example of minimum SI document</a></dt>
                            <dt><a href="#AEN5668">An example push (tokenized SI) document</a></dt>
                            <dt><a href="#AEN5673">Default network and bearer used by push proxy gateway</a></dt>
                            <dt><a href="#AEN5677">Push related Kannel headers</a></dt>
                            <dt><a href="#AEN5714">Requesting SMS level delivery reports for WAP pushes</a></dt>
                            <dt><a href="#AEN5746">Routing WAP pushes to a specific smsc</a></dt>
                        </dl>
                    </dd>
                    <dt>9. <a href="#ssl-enabling">Using SSL for HTTP</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN5769">Using SSL client support</a></dt>
                            <dt><a href="#AEN5774">Using SSL server support for the administration HTTP
                                interface</a>
                            </dt>
                            <dt><a href="#AEN5778">Using SSL server support for the sendsms HTTP
                                interface</a>
                            </dt>
                            <dt><a href="#AEN5782">Using SSL server support for PPG HTTPS interface</a></dt>
                        </dl>
                    </dd>
                    <dt>10. <a href="#delivery-reports">SMS Delivery Reports</a></dt>
                    <dt>11. <a href="#bug-reporting">Getting help and reporting bugs</a></dt>
                    <dt>A. <a href="#upgrading-notes">Upgrading notes</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN5846">From 1.2.x or 1.3.1 to 1.3.2 and later</a></dt>
                        </dl>
                    </dd>
                    <dt>B. <a href="#certificates">Certificate generation</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN5865">Self-signed 1024-bit RSA SSL certificates using openssl</a></dt>
                        </dl>
                    </dd>
                    <dt>C. <a href="#AEN5901">Using the fake WAP sender</a></dt>
                    <dt>D. <a href="#AEN5904">Using the fake SMS center</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN5908">Setting up fakesmsc</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN5911">Compiling fakesmsc</a></dt>
                                    <dt><a href="#AEN5916">Configuring Kannel</a></dt>
                                </dl>
                            </dd>
                            <dt><a href="#AEN5927">Running Kannel with fakesmsc connections</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN5930">Starting fake SMS center</a></dt>
                                </dl>
                            </dd>
                        </dl>
                    </dd>
                    <dt>E. <a href="#AEN5994">Setting up a test environment for Push Proxy Gateway</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN5997">Creating push content and control document for testing</a></dt>
                            <dt><a href="#AEN6012">Starting necessary programs</a></dt>
                            <dt><a href="#AEN6134">Using Nokia Toolkit as a part of a developing environment</a></dt>
                            <dt><a href="#AEN6149">Testing PAP protocol over HTTPS</a></dt>
                        </dl>
                    </dd>
                    <dt>F. <a href="#AEN6231">Setting up a dial-up line</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN6234">Analog modem</a></dt>
                            <dt><a href="#AEN6259">ISDN terminal</a></dt>
                        </dl>
                    </dd>
                    <dt>G. <a href="#regular-expressions">Regular Expressions</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN6266">Syntax and semantics of the regex configuration parameter</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN6271">How-to setup the regex-parameters</a></dt>
                                    <dt><a href="#AEN6334">Regex and non-regex-parameters</a></dt>
                                    <dt><a href="#AEN6338">Performance issues</a></dt>
                                </dl>
                            </dd>
                            <dt><a href="#AEN6341">Examples</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN6344">Example 1: core-configuration</a></dt>
                                    <dt><a href="#AEN6349">Example 3: smsc-configuration</a></dt>
                                    <dt><a href="#AEN6354">Example 4: sms-service-configuration</a></dt>
                                </dl>
                            </dd>
                        </dl>
                    </dd>
                    <dt>H. <a href="#meta-data">Meta Data</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN6364">Overview</a></dt>
                            <dt><a href="#AEN6370">SMPP Implementation</a></dt>
                            <dd>
                                <dl>
                                    <dt><a href="#AEN6411">MO Messages</a></dt>
                                    <dt><a href="#AEN6419">MT Messages</a></dt>
                                </dl>
                            </dd>
                        </dl>
                    </dd>
                    <dt>I. <a href="#AEN6446">Log files</a></dt>
                    <dd>
                        <dl>
                            <dt><a href="#AEN6449">Bearerbox Access Log</a></dt>
                            <dt><a href="#AEN6520">Log rotation</a></dt>
                        </dl>
                    </dd>
                    <dt><a href="#AEN6526">Glossary</a></dt>
                    <dt><a href="#AEN6553">Bibliography</a></dt>
                </dl>
            </div>
            <div class="LOT">
                <dl class="LOT">
                    <dt><b>List of Tables</b></dt>
                    <dt>3-1. <a href="#AEN483">Core Group Variables</a></dt>
                    <dt>3-2. <a href="#AEN805">Kannel Command Line Options</a></dt>
                    <dt>3-3. <a href="#AEN932">Kannel HTTP Administration Commands</a></dt>
                    <dt>4-1. <a href="#AEN1042">Wapbox Group Variables</a></dt>
                    <dt>5-1. <a href="#AEN1247">Wtls Group Variables</a></dt>
                    <dt>6-1. <a href="#AEN1294">RADIUS-Acct Group Variables</a></dt>
                    <dt>7-1. <a href="#AEN1393">SMSC Group Variables</a></dt>
                    <dt>7-2. <a href="#AEN2934">SMSC driver features</a></dt>
                    <dt>7-3. <a href="#AEN3154">SMSC driver internal features</a></dt>
                    <dt>7-4. <a href="#AEN3481">MySQL Connection Group Variables</a></dt>
                    <dt>7-5. <a href="#AEN3613">Redis Connection Group Variables</a></dt>
                    <dt>7-6. <a href="#AEN3663">DLR Database Field Configuration Group Variables</a></dt>
                    <dt>7-7. <a href="#AEN3745">Smsbox Group Variables</a></dt>
                    <dt>7-8. <a href="#AEN3945">Smsbox-route Group Variables</a></dt>
                    <dt>7-9. <a href="#AEN3989">SMS-Service Group Variables</a></dt>
                    <dt>7-10. <a href="#escapecodes">Parameters (Escape Codes)</a></dt>
                    <dt>7-11. <a href="#AEN4445">X-Kannel Headers</a></dt>
                    <dt>7-12. <a href="#AEN4584">X-Kannel Post Headers</a></dt>
                    <dt>7-13. <a href="#AEN4743">SendSMS-User Group Variables</a></dt>
                    <dt>7-14. <a href="#AEN4894">OTA Setting Group Variables</a></dt>
                    <dt>7-15. <a href="#AEN4991">OTA Bookmark Group Variables</a></dt>
                    <dt>7-16. <a href="#AEN5063">SMS Push reply codes</a></dt>
                    <dt>7-17. <a href="#AEN5095">SMS Push (send-sms) CGI Variables</a></dt>
                    <dt>7-18. <a href="#AEN5301">OTA CGI Variables</a></dt>
                    <dt>8-1. <a href="#AEN5379">PPG core group configuration variables</a></dt>
                    <dt>8-2. <a href="#AEN5519">PPG user group configuration variables</a></dt>
                    <dt>8-3. <a href="#AEN5681">Kannel headers used by PPG</a></dt>
                    <dt>D-1. <a href="#AEN5953">Fakesmsc command line options</a></dt>
                    <dt>E-1. <a href="#AEN6033">Test_ppg's command line options</a></dt>
                    <dt>E-2. <a href="#AEN6156">Test_ppg's configuration file directives</a></dt>
                </dl>
            </div>
            <div class="LOT">
                <dl class="LOT">
                    <dt><b>List of Figures</b></dt>
                    <dt>1-1. <a href="#AEN105">Logical position of WAP gateway (and PPG) between a phone and a 
                        content server.</a>
                    </dt>
                    <dt>1-2. <a href="#AEN126">Logical position of SMS gateway between a phone and a content server.</a></dt>
                </dl>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="AEN81"></a>Chapter 1. Introduction</h1>
                <div class="highlights">
                    <a name="AEN83"></a>
                    <p>This chapter introduces WAP and SMS in general terms, and explains the
                        role of the gateway in WAP and SMS, outlining their duties and features. It
                        also explains why the Kannel project was started in the first place,
                        and why it is open source.
                    </p>
                </div>
                <p>With hundreds of millions of mobile phones in use all over the
                    world, the market for services targeted at mobile users
                    is mind-bogglingly immense.  Even simple services find plenty of users,
                    as long as they're useful or fun. Being able to get news, send e-mail
                    or just be entertained wherever you are is extremely attractive to
                    many.
                </p>
                <p>The hottest technology for implementing mobile services is WAP,
                    short for Wireless Application Protocol. It lets the phone act
                    as a simple web browser, but optimizes the markup language,
                    scripting language, and the transmission protocols for wireless
                    use. The optimized protocols are translated to plain old HTTP by
                    a <span class="emphasis"><i class="emphasis">WAP gateway</i></span>.
                </p>
                <p>Kannel is an open source WAP gateway. It attempts to
                    provide this essential part of the WAP infrastructure freely
                    to everyone so that the market potential for WAP services,
                    both from wireless operators and specialized service providers,
                    will be realized as efficiently as possible.
                </p>
                <p>Kannel also works as an SMS gateway for GSM networks. Almost
                    all GSM phones can send and receive SMS messages, so this is
                    a way to serve many more clients than just those using a new
                    WAP phone.
                </p>
                <p>In addition, Kannel operates as <span class="emphasis"><i class="emphasis">Push Proxy Gateway 
                        </i></span>, or <span class="emphasis"><i class="emphasis">PPG</i></span>, making possible for content 
                    servers to send data to the phones. This is a new type of WAP service,
                    and have many interesting applications. Usually servers know whether
                    some data is new, not the users. 
                </p>
                <p>Kannel's quality has been recognized on March 7, 2001 when it
                    was <a href="http://www.kannel.org/oldnews.shtml#wapcert" target="_top">certified</a> 
                    by <a href="http://www.wapforum.org" target="_top">WAP Forum</a>
                    as the first WAP 1.1 gateway in the world.
                </p>
                <p>Greater quality recognition are the quantity of companies 
                    using Kannel to successful connect to a variety of SMSC protocols 
                    in lots of countries.
                </p>
                <p><a href="http://www.opensource.org" target="_top">Open Source</a>
                    is a way to formalize the principle of openness by placing the
                    source code of a product under a Open Source compliant software
                    license. The BSD license was chosen over other Open Source
                    licenses by the merit of placing the least amount of limitations
                    on what a third party is able to do with the source code. In
                    practice this means that Kannel is going to be a fully-featured
                    WAP implementation and compatible with the maximum number of
                    bearers with special emphasis on SMSC compatibility.
                    The Kannel project was founded by Wapit Ltd in June, 1999.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN99">Overview of WAP</a></h2>
                    <p>WAP, short for Wireless Application Protocol, is a
                        collection of various languages and tools and an infrastructure for
                        implementing services for mobile phones. Traditionally such
                        services have worked via normal phone calls or short textual
                        messages (e.g., SMS messages in GSM networks). Neither are very
                        efficient to use, nor very user friendly.  WAP makes it possible
                        to implement services similar to the World Wide Web.
                    </p>
                    <p>Unlike marketers claim, WAP does not bring the existing
                        content of the Internet directly to the phone. There are too many
                        technical and other problems for this to ever work properly. The
                        main problem is that Internet content is mainly in the form of
                        HTML pages, and they are written in such way that they require
                        fast connections, fast processors, large memories, big screens,
                        audio output and often also fairly efficient input mechanisms.
                        That's OK, since they hopefully work better for traditional
                        computers and networks that way. However, portable phones have
                        very slow processors, very little memory, abysmal and intermittent
                        bandwidth, and extremely awkward input mechanisms. Most existing
                        HTML pages do not work on mobiles phones, and never will.
                    </p>
                    <p>WAP defines a completely new markup language, the Wireless
                        Markup Language (WML), which is simpler and much more strictly
                        defined than HTML.  It also defines a scripting language,
                        WMLScript, which all browsers are required to support. To make
                        things even simpler for the phones, it even defines its own
                        bitmap format (Wireless Bitmap, or WBMP).
                    </p>
                    <p>HTTP is also too inefficient for wireless use. However, by using
                        a semantically similar binary and compressed format it
                        is possible to reduce the protocol overhead to a few bytes per
                        request, instead of the usual hundreds of bytes. Thus, WAP defines a
                        new protocol stack to be used. However, to make things simpler
                        also for the people actually implementing the services, WAP
                        introduces a gateway between the phones and the servers providing
                        content to the phones.
                    </p>
                    <div class="figure">
                        <a name="AEN105"></a>
                        <p><b>Figure 1-1. Logical position of WAP gateway (and PPG) between a phone and a 
                                content server.</b>
                        </p>
                        <p><img src="Assets/img/wap-gateway.png"></p>
                    </div>
                    <p>The WAP gateway talks to the phone using the WAP protocol
                        stack, and translates the requests it receives to normal
                        HTTP. Thus content providers can use any HTTP servers and
                        utilize existing know-how about HTTP service implementation
                        and administration.
                    </p>
                    <p>In addition to protocol translations, the gateway
                        also compresses the WML pages into a more compact form, to
                        save on-the-air bandwidth and to further reduce the phone's
                        processing requirements. It also compiles WMLScript programs
                        into a byte-code format. Latest WAP specifications defines some 
                        additional conversions that Kannel is starting to implement, like
                        multipart/form-data, multipart/mixed or MMS content conversion.
                    </p>
                    <p>Kannel is not just a WAP gateway. It also works as an
                        SMS gateway.  Although WAP is the hot and technically superior
                        technology, SMS phones exist in huge numbers and SMS services are
                        thus quite useful. Therefore, Kannel functions simultaneously
                        as both a WAP and an SMS gateway.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN111">Overview of WAP Push</a></h2>
                    <p>Previous chapter explained pull mode of operation: the phone
                        initiates the transaction. There is, however, situations when the
                        server (called in this context a push initiator) should be the 
                        initiator, for instance, when it must send a mail notification or a
                        stock quote. For this purpose WAP Forum defined WAP Push.
                    </p>
                    <p>Push is an application level service, sitting on the top of
                        existing WAP stack. It defines two protocols, OTA and PAP. OTA is
                        a ligthweigth protocol speaking with WAP stack (to be more specific,
                        with WSP), PAP speaks with the push initiator. It defines three kind
                        of XML documents, one for the push data itself and another for 
                        protocol purposes (these are called pap document or push control 
                        documents). 
                    </p>
                    <p>The server does not simply send push content to the phone, the
                        user would surely not accept, for instance, interrupting of a voice 
                        call. Instead it sends a specific XML document, either Service 
                        Indication or Service Loading. These inform the user about the content 
                        become available, and it is displayed only when it is not interrupting 
                        anything. It contains an URL specifying the service and a text for user 
                        describing the content. Then the user can decide does he accept push or not.
                    </p>
                    <p>The push content is send ed to the phones over SMS, but the 
                        content is fetched by the phone over IP bearer, for instance CSD
                        or GPRS. Because Push Proxy Gateway tokenises SI and SL documents, it 
                        may fit one SMS message (if not, it is segmented for transfer). 
                    </p>
                    <p>Using two bearers seems to be an unnecessary complication. But
                        quite simply, phones currently operate this way. Push over GPRS can 
                        only simplify matters.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN118">Overview of SMS</a></h2>
                    <p>SMS, short messaging service, is a way to send short (160
                        character) messages from one GSM phone to another. It can also
                        be used to send regular text as well as advanced content like 
                        operator logos, ringing tones, business cards
                        and phone configurations.
                    </p>
                    <p><span class="emphasis"><i class="emphasis">SMS services</i></span> are content services
                        initiated by SMS message to certain (usually short) phone
                        number, which then answers with requested content, if available.
                    </p>
                    <p>When SMS services are used, the client (mobile terminal) 
                        sends an SMS
                        message to certain number, usually a very short specialized
                        number, which points to specific SMS center responsible
                        for that number (plus possibly many others). This SMS center
                        then sends the message onward to specified receiver in intra- or
                        Internet, using an SMS center specific protocol. For example, a
                        Nokia SMS center uses CIMD protocol.
                    </p>
                    <p>As practically every different kind of SMS center uses different
                        protocol, an <span class="emphasis"><i class="emphasis">SMS gateway</i></span> is used to handle
                        connections with SMS centers and to relay them onward in an
                        unified form. Kannel's biggest feature is to abstract each SMSC protocol
                        to a well-known HTTP protocol, simplifying services deployment.
                    </p>
                    <div class="figure">
                        <a name="AEN126"></a>
                        <p><b>Figure 1-2. Logical position of SMS gateway between a phone and a content server.</b></p>
                        <p><img src="Assets/img/sms-gateway.png"></p>
                    </div>
                    <p>An SMS gateway can also be used to relay SMS messages from
                        one GSM network to another, if the networks do not roam messages
                        normally.
                    </p>
                    <p>Kannel works as an SMS gateway, talking with many
                        different kind of SMS centers, and relaying the messages onward
                        to content providers, as HTTP queries. Content providers then
                        answer to this HTTP query and the answer is sent back to mobile
                        terminal, with appropriate SMS center connection using SMS center
                        specific protocol.
                    </p>
                    <p>In addition to serving mobile originated (MO) SMS messages
                        Kannel also works as an SMS push gateway - content providers can
                        request Kannel to send SMS messages to terminals. Kannel then
                        determines the correct SMS center to relay the SMS message and
                        sends the SMS message to that SMS center, again using SMS center
                        specific protocol. This way the content provider does not need
                        to know any SMS center specific protocol, just unified Kannel
                        SMS sending interface.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN132">Features</a></h2>
                    <div class="sect2">
                        <h3 class="sect2"><a name="AEN134">WAP</a></h3>
                        <p>
                        </p>
                        <p></p>
                        <ul>
                            <li>
                                <p>Fully compliant with WAP 1.1 specification</p>
                            </li>
                            <li>
                                <p>Already implements some WAP 1.2 and even WAP 2.0 features.</p>
                            </li>
                        </ul>
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN142">WAP Push</a></h3>
                        <p>
                        </p>
                        <p></p>
                        <ul>
                            <li>
                                <p>Supports WAP Push SI and SL</p>
                            </li>
                            <li>
                                <p>...</p>
                            </li>
                        </ul>
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN150">SMS</a></h3>
                        <p>
                        </p>
                        <p></p>
                        <ul>
                            <li>
                                <p>Supports a variety of SMSC protocols, namely:</p>
                                <p></p>
                                <ul>
                                    <li>
                                        <p>CMG's UCP/EMI 4.0 and 3.5</p>
                                    </li>
                                    <li>
                                        <p>...</p>
                                    </li>
                                </ul>
                            </li>
                            <li>
                                <p>Full support for MO and MT messages</p>
                            </li>
                        </ul>
                        <p></p>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN163">Requirements</a></h2>
                    <p>Kannel is being developed on Linux systems,
                        and should be fairly easy to export to other Unix-like
                        systems. However, we don't yet support other platforms, due to lack
                        of time, although it should be working without major problems on 
                        Windows (through Cygwin), Solaris and FreeBSD.
                    </p>
                    <p>Kannel requires the following software environment:
                    </p>
                    <p></p>
                    <ul>
                        <li>
                            <p>C compiler and libraries for ANSI C, with normal
                                Unix extensions such as BSD sockets and related tools. 
                                (GNU's GCC tool-chain is recommended)
                            </p>
                        </li>
                        <li>
                            <p>The Gnome XML library (known as
                                gnome-xml and libxml), version 2.2.5 or newer. See <a href="http://xmlsoft.org/xml.html" target="_top">http://xmlsoft.org/xml.html</a>.
                            </p>
                            <p>If you are installing it from your distribution's packages, you'll need
                        <tt class="literal">libxml2-dev</tt> in addition to run-time <tt class="literal">libxml2</tt> package
                        libraries.
                        </p>
                        </li>
                        <li>
                            <p>GNU Make.</p>
                        </li>
                        <li>
                            <p>An implementation of POSIX threads
                                (<tt class="filename">pthread.h</tt>).
                        </p>
                        </li>
                        <li>
                            <p>GNU Bison 1.28, if you want to modify the WMLScript
                                compiler (a pre-generated parser is included for those who just
                                want to compile Kannel).
                            </p>
                        </li>
                        <li>
                            <p>DocBook processing tools: DocBook style-sheets,
                                jade, jadetex, etc; see <tt class="filename">README</tt>, section
                        `Documentation', for more information (pre-formatted versions
                        of the documentation are available, and you can compile Kannel
                        itself even without the documentation tools).
                        </p>
                        </li>
                        <li>
                            <p>GNU autoconf, if you want to modify the
                                configuration script.
                            </p>
                        </li>
                    </ul>
                    <p></p>
                    <p>Hardware requirements are fluffier. Some informal benchmarking 
                        have shown that with a reasonably fast PC architecture (e.g. 400MHz 
                        Pentium II with 128MB RAM), SMS performance's bottleneck is always on the
                        SMSC side, even for example with multiple connections summing a pipeline with 
                        400 msg/sec.  We haven't benchmarked Kannel yet on WAP side, so there are 
                        no hard numbers.
                    </p>
                </div>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="AEN189"></a>Chapter 2. Installing the gateway</h1>
                <p>This chapter explains how the gateway can be installed,
                    either from a source code package or by using a pre-compiled
                    binary version. The goal of this chapter is to get the gateway
                    compiled and all the files in the correct places; the next
                    chapter will explain how the gateway is configured.
                </p>
                <div class="note">
                    <blockquote class="note">
                        <p><b>Note: </b>If you are upgrading from a previous version, please look at
                            <a href="#upgrading-notes">Appendix A</a> for any important information.
                        </p>
                    </blockquote>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN195">Getting the source code</a></h2>
                    <p>The source code to
                        Kannel is available for download at <a href="http://www.kannel.org/download.shtml" target="_top">http://www.kannel.org/download.shtml</a>.
                        It is available in various formats and you can choose to download
                        either the latest release version or the daily snapshot of the
                        development source tree for the next release version, depending
                        on whether you want to use Kannel for production use or to
                        participate in the development.
                    </p>
                    <p>If you're serious about development, you probably want to
                        use CVS, the version control system used by the Kannel project.
                        This allows you to participate in Kannel development much
                        more easily than by downloading the current daily snapshot and
                        integrating any changes you've made every day. CVS does that
                        for you. (See the Kannel web site for more information on how
                        to use CVS.)
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN200">Finding the documentation</a></h2>
                    <p>The documentation for Kannel consists of three parts:
                    </p>
                    <p></p>
                    <ol type="1">
                        <li>
                            <p><i class="citetitle">User's Guide</i>, i.e., the one
                                you're reading at the moment.
                            </p>
                        </li>
                        <li>
                            <p><i class="citetitle">Architecture and
                                    Design</i>, in <tt class="filename">doc/arch</tt> or
                        at <a href="http://www.kannel.org/arch.shtml" target="_top">
                            http://www.kannel.org/arch.shtml</a>
                        </p>
                        </li>
                        <li>
                            <p>The <tt class="filename">README</tt> and various other
                        text files in the source tree.
                        </p>
                        </li>
                    </ol>
                    <p></p>
                    <p>You can also find general information on Kannel's 
                        <a href="http://www.kannel.org" target="_top">website</a> and
                        information about existing problems at 
                        <a href="http://bugs.kannel.org" target="_top">our bug tracker</a>.
                    </p>
                    <p>
                        We intend to cover everything you need to install and use Kannel
                        is in <i class="citetitle">User's Guide</i>, but the guide is still 
                        incomplete in this respect. Similarly, the <i class="citetitle">Architecture and
                            Design</i> document should tell you everything you need
                        to know to dive into the sources and quickly make your own modifications. 
                        It's not a replacement for actually
                        reading the source code, but it should work as a map to the
                        source code.  The <tt class="filename">README</tt> is not supposed
                    to be very important, nor contain much information. Instead,
                    it will just point at the other documentation.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN222">Compiling the gateway</a></h2>
                    <p>If you are using Kannel on a supported platform, or one
                        that is similar enough to one, compiling Kannel should be trivial.
                        After you have unpacked the source package of your choose,
                        or after you have checked out the source code from CVS, enter
                        the following commands:
                    </p>
                    <pre class="screen"><kbd class="userinput">
        ./configure
        make
	</kbd></pre>
                    The <tt class="filename">configure</tt> script investigates various
                    things on your computer for the Kannel compilation needs, and
                    writes out the <tt class="filename">Makefile</tt> used to compile
                    Kannel. <b class="command">make</b> then runs the commands to actually
                    compile Kannel.
                    <p></p>
                    <p>If either command writes out an error message and stops
                        before it finishes its job, you have a problem, and you either
                        need to fix it yourself, if you can, or report the
                        problem to the Kannel project. See <a href="#bug-reporting">Chapter 11</a>
                        for details.
                    </p>
                    <p>For detailed instruction on using the configuration
                        script, see file <tt class="filename">INSTALL</tt>. That file is
                    a generic documentation for <b class="command">configure</b>. Kannel
                    defines a few additional options:
                    </p>
                    <p></p>
                    <ul>
                        <li>
                            <p><tt class="literal">--with-defaults=</tt><tt class="replaceable"><i>type</i></tt>
                        Set defaults for the other options.
                        <tt class="replaceable"><i>type</i></tt> is either <tt class="literal">speed</tt>
                        or <tt class="literal">debug</tt>.  The default is
                        <tt class="literal">speed</tt>. <tt class="literal">speed</tt> options is equivalent to 
                        <tt class="literal">--with-malloc=native --disable-assertions</tt>, while 
                        <tt class="literal">debug</tt> is <tt class="literal">--with-malloc=checking --enable-assertions</tt>.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--disable-docs (default is --enable-docs)</tt>
                        Use this option if you don't have DocBook installed and/or 
                        you want to save some time and CPU cycles. 
                        Pre-generated documentation is available on Kannel's site.
                        Default behavior is to build documentation, b.e., converting the User Guide and
                        the Architecture Guide from the DocBook markup language to
                        PostScript and HTML if DocBook is available.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--enable-drafts (default is --disable-drafts)</tt>
                        When building documentation, include the sections marked as
                        <tt class="literal">draft</tt>.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--enable-debug (default is --disable-debug)</tt>
                        Enable non-reentrant development time
                        debugging of WMLScript compiler.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--disable-localtime (default is --enable-localtime)</tt>
                        Write log file time stamps in GMT, not in local time.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--enable-assertions / --disable-assertions</tt>
                        Turn on or off runtime assertion checking.  <tt class="literal">enable</tt> makes
                        Kannel faster, but gives less information if it crashes.
                        Default value is dependent on <tt class="literal">--with-defaults</tt>.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--with-malloc=</tt><tt class="replaceable"><i>type</i></tt>
                        Select memory allocation module to use:
                        <tt class="replaceable"><i>type</i></tt> is <tt class="literal">native</tt>,
                        <tt class="literal">checking</tt>, or
                        <tt class="literal">slow</tt>.  For production use you probably
                        want <tt class="literal">native</tt>.  The <tt class="literal">slow</tt>
                        module is more thorough than <tt class="literal">checking</tt>,
                        but much slower. 
                        Default value is dependent on <tt class="literal">--with-defaults</tt>.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--enable-mutex-stats</tt>
                        Produce information about lock contention.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--enable-start-stop-daemon</tt>
                        Compile the start-stop-daemon program.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--enable-pam</tt>
                        Enable using PAM for authentication of sendsms users for
                        smsbox.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--with-mssql<tt class="replaceable"><i>[=DIR]</i></tt></tt>
                        Enable using FreeTDS libraries for DBPool and
                        DLR support on MS-SQL and Sybase. Optional DIR specifies where to look for
                        FreeTDS libraries and include files (defaults to /usr/local).
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--with-mysql</tt>
                        Enable using MySQL libraries for DBPool and
                        DLR support.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--with-mysql-dir=</tt><tt class="replaceable"><i>DIR</i></tt>
                        Where to look for MySQL libs and header files.
                        DIR points to the installation of MySQL.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--with-sdb</tt>
                        Enable using LibSDB libraries for dlr support.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--with-oracle</tt>
                        Enable using Oracle OCI-Libraries for Oracle 8i/9i DBPool and
                        DLR support.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--with-oracle-includes=</tt><tt class="replaceable"><i>DIR</i></tt>
                        Where to look for Oracle OCI-Header files.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--with-oracle-libs=</tt><tt class="replaceable"><i>DIR</i></tt>
                        Where to look for Oracle OCI-Library files.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--with-redis</tt>
                        Enable using Redis for DBPool and DLR support. Requires the hiredis library.
                        </p>
                        </li>
                        <li>
                            <p><tt class="literal">--with-redis-dir=</tt><tt class="replaceable"><i>DIR</i></tt>
                        Where to look for the hiredis library and header files.
                        </p>
                        </li>
                    </ul>
                    <p></p>
                    <p>You may need to add compilations flags to configure:
                    </p>
                    <pre class="screen"><kbd class="userinput">
	CFLAGS='-pthread' ./configure
	</kbd></pre>
                    The above, for instance, seems to be required on FreeBSD. If you
                    want to develop Kannel, you probably want to add CFLAGS that make
                    your compiler use warning messages. For example, for GCC:
                    <pre class="screen"><kbd class="userinput">
	CFLAGS='-Wall -O2 -g' ./configure
	</kbd></pre>
                    (You may, at your preference, use even stricter checking options.)
                    <p></p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN324">Installing the gateway</a></h2>
                    <p>After you have compiled Kannel, you need to install
                        certain programs in a suitable place. This is most easily
                        done by using <b class="command">make</b> again:
                    </p>
                    <pre class="screen"><kbd class="userinput">
	make bindir=<tt class="replaceable"><i>/path/to/directory</i></tt> install
	</kbd></pre>
                    Replace <tt class="replaceable"><i>/path/to/directory</i></tt> with the
                    pathname of the actual directory where the programs should be
                    installed. The programs that are installed are (as filenames
                    from the root of the source directory):
                    <p></p>
                    <table border="0">
                        <tbody>
                            <tr>
                                <td><tt class="filename">gw/bearerbox</tt></td>
                        </tr>
                        <tr>
                            <td><tt class="filename">gw/smsbox</tt></td>
                        </tr>
                        <tr>
                            <td><tt class="filename">gw/wapbox</tt></td>
                        </tr>
                        </tbody>
                    </table>
                    <p></p>
                    The version number of the gateway is added to the file names
                    during installation. This makes it easier to have several
                    versions installed, and makes it easy to go back to an older
                    version if the new version proves problematic.
                    <p></p>
                    <p>Kannel consists of three programs called boxes: the
                        bearer box is the interface towards the phones. It accepts
                        WAP and SMS messages from the phones and sends them to the
                        other boxes. The SMS box handles SMS gateway functionality,
                        and the WAP box handles WAP gateway functionality. There can
                        be several SMS boxes and several WAP boxes running and they
                        don't have to run on the same host. This makes it possible
                        to handle much larger loads.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN340">Using pre-compiled binary packages</a></h2>
                    <div class="sect2">
                        <h3 class="sect2"><a name="AEN342">Installing Kannel from RPM packages</a></h3>
                        <p>This chapter explains how to install, upgrade and remove
                            Kannel binary RPM packages.
                        </p>
                        <p>Before you install Kannel, check that you have libxml2
                            installed on your system:
                        </p>
                        <pre class="screen"><kbd class="userinput">
	rpm -q libxml2
	</kbd></pre>
                        <p>Installing Kannel</p>
                        <p>1. Download the binary RPM packet from the Kannel
                            web site.
                        </p>
                        <p>2. Install the RPM package:
                        </p>
                        <pre class="screen"><kbd class="userinput">
	rpm -ivh kannel-<tt class="replaceable"><i>VERSION</i></tt>.<tt class="replaceable"><i>i386</i></tt>.rpm
	</kbd></pre>
                        <p></p>
                        <p>Upgrading Kannel</p>
                        <p>1. Download the binary RPM packet from the Kannel
                            web site.
                        </p>
                        <p>2. Upgrade the RPM package:
                        </p>
                        <pre class="screen"><kbd class="userinput">
	rpm -Uvh kannel-<tt class="replaceable"><i>VERSION</i></tt>.<tt class="replaceable"><i>i386</i></tt>.rpm
	</kbd></pre>
                        <p></p>
                        <p>Removing Kannel</p>
                        <p>1. Remove the RPM package:
                        </p>
                        <pre class="screen"><kbd class="userinput">
	rpm -e kannel
	</kbd></pre>
                        <p></p>
                        <p>After you have installed Kannel from the RPM packages you
                            should now be able to run the Kannel init.d script that will
                            start Kannel as a WAP gateway. Run the script as root.
                        </p>
                        <pre class="screen"><kbd class="userinput">
	/etc/rc.d/init.d/kannel start
	</kbd></pre>
                        <p>To stop the gateway just run the same script with the
                            stop parameter.
                        </p>
                        <pre class="screen"><kbd class="userinput">
	/etc/rc.d/init.d/kannel stop
	</kbd></pre>
                        <p>If Kannel is already running and you just want to quickly
                            stop and start the gateway,e.g.to set a new configuration option,
                            run the script with the restart parameter.
                        </p>
                        <pre class="screen"><kbd class="userinput">
	/etc/rc.d/init.d/kannel restart
	</kbd></pre>
                        <p>If you want Kannel to run as a daemon, you need to add a
                            symbolic link to the Kannel script from the runlevel you want
                            Kannel to run in. E.g. to run Kannel in runlevel 5 add symbolic
                            links to /etc/rc.d/rc5.d/.
                        </p>
                        <pre class="screen"><kbd class="userinput">
	cd /etc/rc.d/rc5.d/
	ln -s ../init.d/kannel S91kannel
	ln -s ../init.d/kannel K91kannel
	</kbd></pre>
                        <p>To run Kannel as a SMS gateway you need to edit the
                            configuration file which is at /etc/kannel/kannel.conf.
                            In Kannel's documentation directory 
                            (<tt class="filename">/usr/share/doc/kannel</tt>) 
                        there is an example file called examples/smskannel.conf. 
                        It has some basic examples of the configuration groups needed 
                        to run Kannel as a SMS gateway. For more detailed information 
                        please see <tt class="filename">examples/kannel.conf</tt> in the
                        same directory for a commented complete example, and read the 
                        section "SMS gateway configuration" later in this same 
                        document.
                        </p>
                        <p>The logging is disabled by default and you can enable
                            it from the kannel.conf file. Just add the log-file option
                            to the group of which box you want to log.
                        </p>
                        <p>The documentation will be installed at 
                            /usr/doc/kannel-VERSION/ or /usr/share/doc/kannel-VERSION/
                            depending on if you used the RedHat 6.x or a 7.x or newer 
                            package.
                        </p>
                        <p>In the Kannel documentation directory there is a HTML
                            file called control.html. It is an example file that shows
                            how to use the Kannel HTTP administration interface. It
                            also has a template for sending SMS messages.
                        </p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN384">Installing Kannel from DEB packages</a></h3>
                        <p>This chapter explains how to install, upgrade and remove
                            Kannel binary DEB packages.
                        </p>
                        <p>Kannel's packages are available on main Debian repository 
                            (<a href="http://packages.debian.org/kannel" target="_top">http://packages.debian.org/kannel</a>)
                            although that version may be out-of-sync with latest Kannel version.
                        </p>
                        <p>Before you install Kannel, check that you have libxml2
                            installed on your system:
                        </p>
                        <pre class="screen"><kbd class="userinput">
	dpkg -l libxml2
	</kbd></pre>
                        <p>Installing or upgrading Kannel from Debian or Kannel repository</p>
                        <p>1. Install or upgrade the package:
                        </p>
                        <pre class="screen"><kbd class="userinput">
	apt-get install kannel
	</kbd></pre>
                        <p></p>
                        <p>See http://kannel.org/download.shtml#debian_repository for 
                            information about kannel repository sources.list
                        </p>
                        <p>Installing or upgrading Kannel from a file</p>
                        <p>1. Download the binary DEB packet from the Kannel
                            web site.
                        </p>
                        <p>2. Log in as root:</p>
                        <pre class="screen"><kbd class="userinput">
	su -
	</kbd></pre>
                        <p>3. Install or upgrade the DEB package:</p>
                        <pre class="screen"><kbd class="userinput">
	dpkg -i kannel-<tt class="replaceable"><i>VERSION</i></tt>.deb
	</kbd></pre>
                        <p>Removing Kannel</p>
                        <p>1. Log in as root:</p>
                        <p>2. Remove the package keeping configuration files:</p>
                        <pre class="screen"><kbd class="userinput">
	dpkg --remove kannel
	</kbd></pre>
                        <p>3. Remove the package completely:</p>
                        <pre class="screen"><kbd class="userinput">
	dpkg --purge kannel
	</kbd></pre>
                        <p>After you have installed Kannel from the DEB packages you
                            should now be able to run the Kannel init.d script that will
                            start Kannel as a WAP gateway. Run the script as root.
                        </p>
                        <pre class="screen"><kbd class="userinput">
	/etc/init.d/kannel start
	</kbd></pre>
                        <p>To stop the gateway just run the same script with the
                            stop parameter.
                        </p>
                        <pre class="screen"><kbd class="userinput">
	/etc/init.d/kannel stop
	</kbd></pre>
                        <p>If Kannel is already running and you just want to quickly
                            stop and start the gateway,e.g.to set a new configuration option,
                            run the script with the restart parameter.
                        </p>
                        <pre class="screen"><kbd class="userinput">
	/etc/init.d/kannel restart
	</kbd></pre>
                        <p>If you don't want Kannel to run as a daemon, 
                            run: 
                        </p>
                        <pre class="screen"><kbd class="userinput">
	update-rc.d -f kannel remove
	</kbd></pre>
                        <p>If you want to restore Kannel running as a daemon, you 
                            need to add a
                            symbolic link to the Kannel script from the runlevel you want
                            Kannel to run in. E.g. to run Kannel in default runlevel, 
                            just run: 
                        </p>
                        <pre class="screen"><kbd class="userinput">
	update-rc.d kannel defaults
	</kbd></pre>
                        <p>Kannel package starts by default with a wapbox daemon.
                            To activate smsbox or select which box you want to start, 
                            edit /etc/default/kannel and comment/uncomment START_xxxBOX.
                        </p>
                        <p>To run Kannel as a SMS gateway you need to edit the
                            configuration file which is at /etc/kannel/kannel.conf.
                            In /usr/share/docs/kannel/examples/ there are example files. 
                            They have some basic examples of the configuration groups 
                            needed to run Kannel as a SMS gateway. For
                            more detailed information please read the section "SMS gateway
                            configuration" later in this same document.
                        </p>
                        <p>The documentation will be installed at 
                            /usr/share/doc/kannel/.
                        </p>
                        <p>In the Kannel documentation directory there is a html
                            file called control.html. It is an example file that shows
                            how to use the Kannel HTTP administration interface. It
                            also has a template for sending SMS messages.
                        </p>
                        <p>Additionally to kannel-VERSION.deb, there's now an optional
                            kannel-docs-VERSION.deb with documentation (userguide et al) and
                            a kannel-extras-VERSION.deb with contrib and test stuff.
                        </p>
                        <p>If you want to test development version, use the packages
                            called kannel-devel-*.deb.
                        </p>
                    </div>
                </div>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="AEN435"></a>Chapter 3. Using the gateway</h1>
                <p>This chapter explains how the gateway core, bearerbox,
                    is configured and used.
                    It covers the configuration file, keeping an eye on the gateway
                    while it is running, and using the HTTP interface to control
                    the gateway.
                </p>
                <p>After this chapter there is distinct chapter for each
                    kind of gateway use: WAP gateway, SMS gateway and WAP Push
                    proxy. These chapters explain the configuration and other
                    aspects of gateway of that type.
                </p>
                <p>You can configure your Kannel to be only a WAP or a SMS
                    gateway, or to be both at the same time. You just need to read
                    each chapter and combine all configurations.
                </p>
                <p>There is only one configuration file for all parts of
                    Kannel, although when Kannel is distributed to several hosts
                    some lines from the configuration file can be removed in some
                    hosts.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN441">Configuring the gateway</a></h2>
                    <p>The configuration file can be divided into three parts:
                        bearerbox configurations, smsbox configurations and
                        wapbox configurations. Bearerbox part has one 'core' group
                        and any used SMS center groups, while wapbox part has only
                        one wapbox group. In smsbox part there is one smsbox group and
                        then number of sms-service and sendsms-user groups.
                    </p>
                    <p>Details of each part are in an appropriate section of this
                        documentation. The 'core' group used by the bearerbox is
                        explained in this chapter, while 'wapbox' part is in the next
                        chapter and 'smsbox', 'smsc' (SMS center), 'sms-service' and
                        'sendsms-user' groups are in the SMS Kannel chapter.
                    </p>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN445">Configuration file syntax</a></h3>
                        <p>A configuration file consists of groups of configuration variables. Groups are
                            separated by empty lines, and each variable is defined on its
                            own line. Each group in Kannel configuration is distinguished
                            with a group variable. Comments are lines that begin with a number sign
                            (<tt class="literal">#</tt>) and are ignored (they don't, for example,
                        separate groups of variables).
                        </p>
                        <p>A variable definition line has the name of the variable,
                            and equals sign (<tt class="literal">=</tt>) and the value of the
                        variable. The name of the variable can contain any characters
                        except white space and equals. The value of the variable is a
                        string, with or without quotation marks (<tt class="literal"></tt>)
                        around it. Quotation marks are needed if the variable needs to
                        begin or end with white space or contain special
                        characters. Normal C 	escape character syntax works inside 
                        quotation marks.
                        </p>
                        <p>Perhaps an example will make things easier to comprehend:
                        </p>
                        <pre class="programlisting">
1    # A do-nothing service.
2    group = sms-service
3    keyword = nop
4    text = "You asked nothing and I did it!"
5
6    # Default service.
7    group = sms-service
8    keyword = default
9    text = "No services defined"
                        </pre>
                        The above snippet defines the keyword <tt class="literal">nop</tt>
                        for an SMS service, and a default action for situation when
                        the keyword in the SMS message does not match any defined
                        service.
                        <p></p>
                        <p>Lines 1 and 6 are comment lines. Line 5 separates the
                            two groups. The remaining lines define variables. The
                            group type is defined by the group variable value.
                        </p>
                        <p>The various variables that are understood in each type
                            of configuration group are explained below.
                        </p>
                        <p>Some variable values are marked as
                        <tt class="literal">'bool'</tt>. The value for variable can be like
                        true, false, yes, no, on, off, 0 or 1. Other values are
                        treated as 'true' while if the variable is not present at all,
                        it is treated as being 'false'.
                        </p>
                        <p>In order to make some configuration lines more readable
                            you may use the delimiter '\' at the end of a line to wrap
                            and concatenate the next line up to the current line. Here is 
                            an example:
                        </p>
                        <pre class="programlisting">
1    # A group with a wrapped alias line
2    group = sms-service
3    keyword = hello
4    aliases = hallo;haalloo;\
5      heelloo;haelloo;healloo
5    text = "Hello world!"
                        </pre>
                        The above example shows how a list for various alias keywords
                        is wrapped to two lines using the line wrap delimiter. In order
                        to use the delimiter '\' itself, you need to escape it via a
                        prefixed '\' itself. So this is '\\' to escape the wrapping
                        function and use the character in the string.
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="includes">Inclusion of configuration files</a></h3>
                        <p>A configuration file may contain a special directive 
                            called <tt class="literal">include</tt> to include other 
                        file or a directory with files to the configuration 
                        processing.
                        </p>
                        <p>This allows to segment the specific configuration groups
                            required for several services and boxes to different files and
                            hence to have more control in larger setups.
                        </p>
                        <p>Here is an example that illustrates the <tt class="literal">include
                        </tt> statement :
                        </p>
                        <pre class="programlisting">
group = core
admin-port = 13000
wapbox-port = 13002
admin-password = bar
wdp-interface-name = "*"
log-file = "/var/log/bearerbox.log"
log-level = 1
box-deny-ip = "*.*.*.*"
box-allow-ip = "127.0.0.1"

include = "wapbox.conf"

include = "configurations"
                        </pre>
                        Above is the main <tt class="literal">kannel.conf</tt> configuration
                        file that includes the following <tt class="literal">wapbox.conf</tt>
                        file with all required directives for the specific box, and a 
                        <tt class="literal">configurations</tt> directory which may include 
                        more files to include.
                        <pre class="programlisting">
group = wapbox
bearerbox-host = localhost
log-file = "/var/log/wapbox.log"
log-level = 0
syslog-level = none
                        </pre>
                        The above <tt class="literal">include</tt> statement may be defined
                        at any point in the configuration file and at any inclusion 
                        depth. Hence you can cascade numerous inclusions if necessary.
                        <p></p>
                        <p>At process start time inclusion of configuration files 
                            breaks if either the included file can not be opened and 
                            processed or the included file has been processed already in 
                            the stack and a recursive cycling has been detected.
                        </p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN475">Core configuration</a></h3>
                        <p>Configuration for Kannel <span class="emphasis"><i class="emphasis">MUST</i></span> always
                            include a group for general bearerbox configuration. This group is
                            named as 'core' in configuration file, and should be the first group
                            in the configuration file.
                        </p>
                        <p>As its simplest form, 'core' group looks like this:
                        </p>
                        <pre class="programlisting">
group = core
admin-port = 13000
admin-password = f00bar
                        </pre>
                        Naturally this is not sufficient for any real use, as you want to
                        use Kannel as an SMS gateway, or WAP gateway, or both. Thus, one or
                        more of the optional configuration variables are used. In following
                        list (as in any other similar lists), all mandatory variables are
                        marked with <tt class="literal">(m)</tt>, while conditionally mandatory
                        (variables which must be set in certain cases) are marked with
                        <tt class="literal">(c)</tt>.
                        <p></p>
                        <div class="table">
                            <a name="AEN483"></a>
                            <p><b>Table 3-1. Core Group Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group (m)</tt></td>
                                <td><tt class="literal">core</tt></td>
                                <td valign="bottom">
                                    This is a mandatory variable
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">admin-port (m)</tt></td>
                                <td>port-number</td>
                                <td valign="bottom">
                                    The port number in which the bearerbox listens to HTTP
                                    administration commands. It is NOT the same as the HTTP
                                    port of the local HTTP server, just invent any port, but
                                    it must be over 1023 unless you are running Kannel as a
                                    root process (not recommended)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">admin-port-ssl (o)</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    If set to true a SSL-enabled administration HTTP server
                                    will be used instead of the default insecure plain HTTP
                                    server. To access the administration pages you will have
                                    to use a HTTP client that is capable of talking to such
                                    a server. Use the "https://" scheme to access the
                                    secured HTTP server. Defaults to "no".
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">admin-password (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Password for HTTP administration commands (see below)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">status-password</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Password to request Kannel status. If not set, no password is
                                    required, and if set, either this or
                                <tt class="literal">admin-password</tt> can be used
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">admin-deny-ip</tt></td>
                                <td rowspan="2">IP-list</td>
                                <td rowspan="2" valign="bottom">
                                    These lists can be used to prevent connection from given IP 
                                    addresses. Each list can have several addresses, separated with    
                                    semicolons (';'). An asterisk ('*') can be used
                                    as a wild-card in a place of any ONE number, so *.*.*.*
                                    matches any IP.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">admin-allow-ip</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsbox-interface (o)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    If this is set, the smsbox listener will only bind
                                    to a specified address. For example: "127.0.0.1".
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsbox-port (c)</tt></td>
                                <td>port-number</td>
                                <td valign="bottom">
                                    This is the port number to which the smsboxes, if any, connect.
                                    As with admin-port, this can be anything you want. Must be set
                                    if you want to handle any SMS traffic.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsbox-port-ssl (o)</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    If set to true, the smsbox connection module will be SSL-enabled.
                                    Your smsboxes will have to connect using SSL to the bearerbox
                                    then. This is used to secure communication between bearerbox
                                    and smsboxes in case they are in separate networks operated and
                                    the TCP communication is not secured on a lower network layer.
                                    Defaults to "no".
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">wapbox-port (c)</tt></td>
                                <td>port-number</td>
                                <td valign="bottom">
                                    Like smsbox-port, but for wapbox-connections. If not set,
                                    Kannel cannot handle WAP traffic
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">wapbox-port-ssl (o)</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    If set to true, the wapbox connection module will be SSL-enabled.
                                    Your wapboxes will have to connect using SSL to the bearerbox
                                    then. This is used to secure communication between bearerbox
                                    and wapboxes in case they are in separate networks operated and
                                    the TCP communication is not secured on a lower network layer.
                                    Defaults to "no".
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">box-deny-ip</tt></td>
                                <td rowspan="2">IP-list</td>
                                <td rowspan="2" valign="bottom">
                                    These lists can be used to prevent box connections from given IP 
                                    addresses. Each list can have several addresses, 
                                    separated with semicolons (';'). An asterisk ('*') can be used
                                    as a wild-card in place of any ONE number, so *.*.*.*
                                    matches any IP.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">box-allow-ip</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">udp-deny-ip</tt></td>
                                <td rowspan="2">IP-list</td>
                                <td rowspan="2" valign="bottom">
                                    These lists can be used to prevent UDP packets from given IP 
                                    addresses, thus preventing unwanted use of the WAP gateway.
                                    Used the same way as <tt class="literal">box-deny-ip</tt> and
                                <tt class="literal">box-allow-ip</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">udp-allow-ip</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">wdp-interface-name (c)</tt></td>
                                <td>IP or '*'</td>
                                <td valign="bottom">
                                    If this is set, Kannel listens to WAP UDP packets incoming to
                                    ports 9200-9208, bound to given IP. If no specific IP is
                                    needed, use just an asterisk ('*'). If UDP messages are
                                    listened to, wapbox-port variable MUST be set.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">log-file</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    A file in which to write a log. This in addition to <tt class="literal">stdout</tt>
                                and any log file defined in command line. Log-file in 'core'
                                group is only used by the bearerbox.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">log-level</tt></td>
                                <td>number 0..5</td>
                                <td valign="bottom">
                                    Minimum level of log-file events logged. 0 is for 'debug', 1
                                    'info', 2 'warning, 3 'error' and 4 'panic' (see Command Line
                                    Options)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">access-log</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    A file in which information about received/sent SMS messages 
                                    is stored. Access-log in 'core' group is only used by the
                                    bearerbox.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">access-log-clean</tt></td>
                                <td>boolean</td>
                                <td valign="bottom">
                                    Indicates if <tt class="literal">access-log</tt> will contain standard 'markers', 
                                which means the 'Log begins', 'Log ends' markers and the prefixed
                                timestamp. This config directive should be set to 'true' if a custom 
                                logging format is desired without a prefixed default timestamp. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">access-log-format</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    String defining a custom log file line format. May use escape codes as defined
                                    later on to substitute values of the messages into the log entry. If no
                                    custom log format is used the standard format will be:
                                <tt class="literal">"%t %l [SMSC:%i] [SVC:%n] [ACT:%A] [BINF:%B] [FID:%F] [META:%D] [from:%p] [to:%P] 
                                    [flags:%m:%c:%M:%C:%d] [msg:%L:%b] [udh:%U:%u]"</tt>
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">syslog-level</tt></td>
                                <td>number</td>
                                <td valign="bottom">
                                    Messages of this log level or higher will also be
                                    sent to syslog, the UNIX system log daemon. If not explicitly
                                    set with <tt class="literal">syslog-facility</tt>, it logs under the
                                'daemon' category. The default is not to use syslog, and you can
                                set that explicitly by setting <tt class="literal">syslog-level</tt>
                                to 'none'.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">syslog-facility</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The syslog facility to send the syslog entries to. The
                                    default is 'daemon'.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">unified-prefix</tt></td>
                                <td>prefix-list</td>
                                <td valign="bottom">
                                    String to unify received phone numbers, for SMSC routing and
                                    to ensure that SMS centers can handle them properly. 
                                    This is applied to 'sender' number when receiving SMS
                                    messages from SMS Center and for 'receiver' number when
                                    receiving messages from smsbox (either sendsms message or
                                    reply to original message). Format is that first comes the
                                    unified prefix, then all prefixes which are replaced by the
                                    unified prefix, separated with comma (','). For example,
                                    for Finland an unified-prefix "+358,00358,0;+,00" should do the trick. 
                                    If there are several unified prefixes, separate their rules with
                                    semicolon (';'), like "+35850,050;+35840,040". <span class="emphasis"><i class="emphasis">Note
                                            that prefix routing is next to useless now that there are
                                            SMSC ID entries. To remove prefixes, use like 
                                            "-,+35850,050;-,+35840,040".
                                        </i></span>
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">white-list</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    Load a list of accepted senders of SMS messages. If a sender
                                    of an SMS message is not in this list, any message received
                                    from the SMS Center is discarded. See notes of phone number
                                    format from numhash.h header file. NOTE: the system has only
                                    a precision of last 9 or 18 digits of phone numbers, so
                                    beware!
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">black-list</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    As white-list, but SMS messages to these numbers are
                                    automatically discarded
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">store-type</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    Kannel can use store subsystem that means storing messages
                                    on hard disk until they are successfully handled. By using
                                    this subsystem, no SMS messages are lost in Kannel even by
                                    crash, but theoretically some messages can duplicate when
                                    system is taken down violently. 
                                    This variable defines a type of backend used for store
                                    subsystem. Now two types are supported:
                                    a) file: writes store into one single file
                                    b) spool: writes store into spool directory (one file for each message)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">store-location</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    Depends on <tt class="literal">store-type</tt> option used, it is ether file or spool directory.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">store-dump-freq</tt></td>
                                <td>seconds</td>
                                <td valign="bottom">
                                    Approximated frequency how often the memory dump of current
                                    pending messages are stored to store-file, providing something
                                    has happened. Defaults to 10 seconds if not set.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-proxy-host</tt></td>
                                <td>hostname</td>
                                <td rowspan="2" valign="bottom">
                                    Enable the use of an HTTP proxy for all HTTP requests.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-proxy-port</tt></td>
                                <td>port-number</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-proxy-exceptions</tt></td>
                                <td>URL-list</td>
                                <td valign="bottom">
                                    A list of excluded hosts from being used via a
                                    proxy. Separate each entry with space.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-proxy-exceptions-regex</tt></td>
                                <td>UNIX regular expression</td>
                                <td valign="bottom">
                                    Same as http-proxy-exceptions but match against UNIX regular expression.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-proxy-username</tt></td>
                                <td>username</td>
                                <td valign="bottom">
                                    Username for authenticating proxy use, for proxies that
                                    require this.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-proxy-password</tt></td>
                                <td>URL-list</td>
                                <td valign="bottom">
                                    Password for authenticating proxy use, for proxies that
                                    require this.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">ssl-client-certkey-file (c)</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    A PEM encoded SSL certificate and private key file to be used
                                    with SSL client connections. This certificate is used for
                                    the HTTPS client side only, i.e. for SMS service requests to 
                                    SSL-enabled HTTP servers. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">ssl-server-cert-file (c)</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    A PEM encoded SSL certificate file to be used with SSL server
                                    connections. This certificate is used for the HTTPS server
                                    side only, i.e. for the administration HTTP server and the
                                    HTTP interface to send SMS messages.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">ssl-server-key-file (c)</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    A PEM encoded SSL private key file to be used with SSL server
                                    connections. This key is associated to the specified 
                                    certificate and is used for the HTTPS server side only.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">ssl-trusted-ca-file</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    This file contains the certificates Kannel is willing to trust when
                                    working as a HTTPS client. If this option is not set, certificates
                                    are not validated and those the identity of the server is not proven.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dlr-storage</tt></td>
                                <td>type</td>
                                <td valign="bottom">
                                    Defines the way DLRs are stored. Natively in-memory storage is 
                                    supported, which is very fast, but has no persistancy. This means 
                                    you will loose all your temporary DLR information on bearebox 
                                    re-start. In addition a spool directory approach is natively 
                                    supported, which garantees persistancy with a reasonable 
                                    performance, depending on your disk IO performance.
                                    If you have build-in external DLR storage support, i.e. using 
                                    MySQL you may define here the alternative storage type like 
                                <tt class="literal">mysql</tt>. 
                                Supported types are:
                                <tt class="literal">internal</tt>, 
                                <tt class="literal">spool</tt>, 
                                <tt class="literal">mysql</tt>,
                                <tt class="literal">pgsql</tt>,
                                <tt class="literal">sdb</tt>,
                                <tt class="literal">mssql</tt>,
                                <tt class="literal">sqlite3</tt>,
                                <tt class="literal">oracle</tt> and
                                <tt class="literal">redis</tt>.
                                By default this is set to <tt class="literal">internal</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dlr-spool</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    Depends on <tt class="literal">dlr-storage = spool</tt> option used, it 
                                is the spool directory to use for DLR storage data.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">maximum-queue-length</tt></td>
                                <td>number of messages</td>
                                <td valign="bottom">
                                    (deprecated, see <tt class="literal">sms-incoming-queue-limit</tt>).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sms-incoming-queue-limit</tt></td>
                                <td>number of messages</td>
                                <td valign="bottom">
                                    Set maximum size of incoming message queue. After number of messages
                                    has hit this value, Kannel began to discard them.
                                    Value 0 means giving strict priority to outgoing messages. -1,
                                    default, means that the queue of infinite length is accepted. (This
                                    works with any normal input, use this variable only when Kannel message
                                    queues grow very long).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sms-outgoing-queue-limit</tt></td>
                                <td>number of messages</td>
                                <td valign="bottom">
                                    Set maximum size of outgoing message queue. After number of messages
                                    has hit this value, Kannel began to discard them.
                                    The default value, 1 million, works for most installations.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">white-list-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    A regular expression defining the set of accepted senders.
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">black-list-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    A regular expression defining the set of rejected senders.
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsbox-max-pending</tt></td>
                                <td>number of messages</td>
                                <td valign="bottom">
                                    Maximum number of pending messages on the line to smsbox compatible boxes.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sms-resend-freq</tt></td>
                                <td>seconds</td>
                                <td valign="bottom">
                                    Frequency for the SMS resend thread in which temporarily failed or queued messages will be resent.
                                    Defaults to 60 seconds.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sms-resend-retry</tt></td>
                                <td>number</td>
                                <td valign="bottom">
                                    Maximum retry attempts for the temporarily failed messages.
                                    Defaults to -1, means: unlimited.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sms-combine-concatenated-mo</tt></td>
                                <td>boolean</td>
                                <td valign="bottom">
                                    Whether Kannel should attempt to combine concatenated MO SMS
                                    prior to passing them over to smsbox. Default is true
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sms-combine-concatenated-mo-timeout</tt></td>
                                <td>seconds</td>
                                <td valign="bottom">
                                    How long to wait for all concatenated message parts to arrive before timeouting.
                                    Default 1800 seconds.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-timeout</tt></td>
                                <td>seconds</td>
                                <td valign="bottom">
                                    Sets socket timeout in seconds for outgoing client http
                                    connections. Optional. Defaults to 240 seconds.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <p>A sample more complex 'core' group could be something like
                            this:
                        </p>
                        <pre class="programlisting">
group = core
admin-port = 13000
admin-password = f00bar
status-password = sTat
admin-deny-ip = "*.*.*.*"
admin-allow-ip = "127.0.0.1;200.100.0.*"
smsbox-port = 13003
wapbox-port = 13004
box-deny-ip = "*.*.*.*"
box-allow-ip = "127.0.0.1;200.100.0.*"
wdp-interface-name = "*"
log-file = "kannel.log"
log-level = 1
access-log = "kannel.access"
unified-prefix = "+358,00358,0;+,00"
white-list = "http://localhost/whitelist.txt"
                        </pre>
                        <p></p>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN778">Running Kannel</a></h2>
                    <p>To start the gateway, you need to start each box you need.
                        You always need the bearer box, and depending on whether you want
                        WAP and SMS gateways you need to start the WAP and SMS boxes. If
                        you want, you can run several of them, but we'll explain the
                        simple case of only running one each.
                    </p>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN781">Starting the gateway</a></h3>
                        <p>After you have compiled Kannel and edited configuration file
                            for your taste, you can either run Kannel from command line or use
                            supplied <tt class="literal">start-stop-daemon</tt> and
                        <tt class="literal">run_kannel_box</tt> programs to use it as a daemon
                        service (more documentation about that later).
                        </p>
                        <p>If you cannot or do not know how to set up daemon systems or
                            just want to test Kannel, you probably want to start it from
                            command line. This means that you probably want to have one terminal
                            window for each box you want to start (xterm or screen will do
                            fine). To start the bearerbox, give the following command:
                        </p>
                        <pre class="screen"><kbd class="userinput">
	./bearerbox -v 1 [config-file]
	</kbd></pre>
                        The <code class="option">-v 1</code> sets the logging level to
                        <tt class="literal">INFO</tt>. This way, you won't see a large amount of
                        debugging output (the default is <tt class="literal">DEBUG</tt>). Full
                        explanation of Kannel command line arguments is below.
                        <p></p>
                        <p><span class="emphasis"><i class="emphasis">[config-file]</i></span> is the name of the
                            configuration file you are using with Kannel. The basic distribution
                            packet comes with two sample configuration files,
                        <tt class="literal">smskannel.conf</tt> and
                        <tt class="literal">wapkannel.conf</tt> (in <tt class="literal">gw</tt>
                        sub directory), of which the first one is for
                        testing out SMS Kannel and the second one for setting up a WAP
                        Kannel. Feel free to edit those configuration files to set up your
                        own specialized system.
                        </p>
                        <p>After the bearer box, you can start the WAP box:
                        </p>
                        <pre class="screen"><kbd class="userinput">
	./wapbox -v 1 [config-file]
	</kbd></pre>
                        or the SMS box:
                        <pre class="screen"><kbd class="userinput">
	./smsbox -v 1 [config-file]
	</kbd></pre>
                        or both, of course. The order does not matter, except that you need
                        to start the bearer box before the other boxes. Without the bearer
                        box, the other boxes won't even start.
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="arguments">Command line options</a></h3>
                        <p>Bearerbox, smsbox and wapbox each accept certain command line options
                            and arguments when they are launched. These arguments are:
                        </p>
                        <div class="table">
                            <a name="AEN805"></a>
                            <p><b>Table 3-2. Kannel Command Line Options</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                </colgroup>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal"></tt></td>
                                <td rowspan="2" valign="bottom">
                                    Print the version of the Kannel binary.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--version</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-v &lt;level&gt;</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Set verbosity level for stdout (screen) logging. Default is 0,
                                    which means 'debug'. 1 is 'info, 2 'warning', 3
                                    'error' and 4 'panic'
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--verbosity &lt;level&gt;</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-D &lt;places&gt;</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Set debug-places for 'debug' level output.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--debug &lt;places&gt;</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-F &lt;file-name&gt;</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Log to file named file-name, too. Does not overrun or
                                    affect any log-file defined in configuration file.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--logfile &lt;file-name&gt;</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-V &lt;level&gt;</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Set verbosity level for that extra log-file (default 0,
                                    which means 'debug'). Does not affect verbosity level of
                                    the log-file defined in configuration file, not verbosity
                                    level of the <tt class="literal">stdout</tt> output.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--fileverbosity &lt;level&gt;</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-S</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Start the system initially at SUSPENDED state (see below,
                                    bearerbox only)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--suspended</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-I</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Start the system initially at ISOLATED state (see below,
                                    bearerbox only)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--isolated</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-H</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Only try to open HTTP sendsms interface; if it
                                    fails, only warn about that, do not exit. (smsbox only)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--tryhttp</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-g</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Dump all known config groups and config keys to stdout
                                    and exit.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--generate</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-u &lt;username&gt;</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Change process user-id to the given.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--user &lt;username&gt;</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-p &lt;filename&gt;</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Write process PID to the given file.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--pid-file &lt;filename&gt;</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-d</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Start process as daemon (detached from a current shell session).
                                    Note: Process will change CWD (Current working directory) to <tt class="literal">/</tt>,
                                therefore you should ensure that all paths to binary/config/config-includes are
                                absolute instead of relative.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--daemonize</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-P</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Start watcher process. This process watch a child process and if child process
                                    crashed will restart them automatically.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--parachute</tt></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">-X &lt;scriptname&gt;</tt></td>
                                <td rowspan="2" valign="bottom">
                                    Execute a given shell script or binary when child process crash detected. This option
                                    is usable only with <tt class="literal">--parachute/-P</tt>.
                                Script will be executed with 2 arguments:
                                scriptname 'processname' 'respawn-count'.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">--panic-script &lt;scriptname&gt;</tt></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN910">Kannel statuses</a></h3>
                        <p>In Kannel, there are four states for the program (which
                            currently directly only apply to bearerbox):
                        </p>
                        <p></p>
                        <ol type="a">
                            <li>
                                <p>
                                    Running. The gateway accepts, proceeds and relies 
                                    messages normally. This is the default state for the bearerbox.
                                </p>
                            </li>
                            <li>
                                <p>
                                    Suspended. The gateway does not accept any new messages from SMS
                                    centers nor from UDP ports. Neither does it accept new sms and wapbox
                                    connections nor sends any messages already in the system
                                    onward.
                                </p>
                            </li>
                            <li>
                                <p>
                                    Isolated. In this state, the gateway does not accept any messages
                                    from external message providers, which means SMS Centers and UDP
                                    ports. It still processes any messages in the system and can
                                    accept new messages from sendsms interface in smsbox.
                                </p>
                            </li>
                            <li>
                                <p>
                                    Full. Gateway does not accept any messages from SMS centers, because 
                            <tt class="literal">maximum-queue-length</tt> is achieved.
                            </p>
                            </li>
                            <li>
                                <p>
                                    Shutdown. When the gateway is brought down, it does not accept any
                                    new messages from SMS centers and UDP ports, but processes all
                                    systems already in the system. As soon as any queues are emptied,
                                    the system exits
                                </p>
                            </li>
                        </ol>
                        <p>
                            The state can be changed via HTTP administration interface (see below),
                            and shutdown can also be initiated via TERM or INT signal from
                            terminal. In addition, the bearerbox can be started already in
                            suspended or isolated state with -S or -I command line option, see
                            above.
                        </p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN926">HTTP administration</a></h3>
                        <p>Kannel can be controlled via an HTTP administration interface. All
                            commands are done as normal HTTP queries, so they can be easily done
                            from command line like this:
                        </p>
                        <pre class="screen"><kbd class="userinput">
	lynx -dump "http://localhost:12345/shutdown?password=bar"
	</kbd></pre>
                        ...in which the '12345' is the configured admin-port in Kannel
                        configuration file (see above). For most commands, admin-password is required as a
                        argument as shown above. In addition, HTTP administration can
                        be denied from certain IP addresses, as explained in configuration
                        chapter.
                        <p></p>
                        <p>Note that you can use these commands with WAP terminal, too, but
                            if you use it through the same Kannel, replies to various suspend
                            commands never arrive nor can you restart it via WAP anymore.
                        </p>
                        <div class="table">
                            <a name="AEN932"></a>
                            <p><b>Table 3-3. Kannel HTTP Administration Commands</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                </colgroup>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">status or status.txt</tt></td>
                                <td valign="bottom">
                                    Get the current status of the gateway in a text version. Tells the current 
                                    state (see above) and total number of messages relied and queuing 
                                    in the system right now. Also lists the total number of smsbox
                                    and wapbox connections. No password required, unless
                                <tt class="literal">status-password</tt> set, in which case either
                                that or main admin password must be supplied.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">status.html</tt></td>
                                <td valign="bottom">
                                    HTML version of status
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">status.xml</tt></td>
                                <td valign="bottom">
                                    XML version of status
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">status.wml</tt></td>
                                <td valign="bottom">
                                    WML version of status
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">store-status or store-status.txt</tt></td>
                                <td valign="bottom">
                                    Get the current content of the store queue of the gateway 
                                    in a text version. No password required, unless
                                <tt class="literal">status-password</tt> set, in which case either
                                that or main admin password must be supplied.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">store-status.html</tt></td>
                                <td valign="bottom">
                                    HTML version of store-status
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">store-status.xml</tt></td>
                                <td valign="bottom">
                                    XML version of store-status
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">suspend</tt></td>
                                <td valign="bottom">
                                    Set Kannel state as 'suspended' (see above). Password
                                    required.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">isolate</tt></td>
                                <td valign="bottom">
                                    Set Kannel state as 'isolated' (see above). Password required.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">resume</tt></td>
                                <td valign="bottom">
                                    Set Kannel state as 'running' if it is suspended or isolated.
                                    Password required.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">shutdown</tt></td>
                                <td valign="bottom">
                                    Bring down the gateway, by setting state to 'shutdown'. After
                                    a shutdown is initiated, there is no other chance to resume
                                    normal operation. However, 'status' command still works.
                                    Password required. If shutdown is sent for a second time, the
                                    gateway is forced down, even if it has still messages in
                                    queue.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">flush-dlr</tt></td>
                                <td valign="bottom">
                                    If Kannel state is 'suspended' this will flush all queued DLR
                                    messages in the current storage space. Password required.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">start-smsc</tt></td>
                                <td valign="bottom">
                                    Re-start a single SMSC link. Password required. Additionally
                                    the <tt class="literal">smsc</tt> parameter must be given to identify
                                which <tt class="literal">smsc-admin-id</tt> should be re-started.
                                The configuration for the SMSC link is re-read from disk before
                                the action is performed.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">stop-smsc</tt></td>
                                <td valign="bottom">
                                    Shutdown a single SMSC link. Password required. Additionally
                                    the <tt class="literal">smsc</tt> parameter must be given (see above).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">add-smsc</tt></td>
                                <td valign="bottom">
                                    Adds an SMSC link previously removed or created after the service was
                                    started. Password required. Additionally the <tt class="literal">smsc</tt>
                                parameter must be given (see above).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">remove-smsc</tt></td>
                                <td valign="bottom">
                                    Removes an existing SMSC link. Password required. Additionally the
                                <tt class="literal">smsc</tt> parameter must be given (see above). If you
                                want a permanent removal, you should also remove the entry from the
                                configuration file or it will be recreated after a service restart.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">restart</tt></td>
                                <td valign="bottom">
                                    Re-start whole bearerbox, hence all SMSC links. Password required.
                                    Beware that you loose the smsbox connections in such a case.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">log-level</tt></td>
                                <td valign="bottom">
                                    Set Kannel log-level of log-files while running. This allows
                                    you to change the current log-level of the log-files on the fly.
                                    This includes the main event log and the SMSC specific logs, if
                                    any exist.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">reload-lists</tt></td>
                                <td valign="bottom">
                                    Re-loads the 'white-list' and 'black-list' URLs provided in the
                                    core group. This allows Kannel to keep running while the remote
                                    lists change and signal bearerbox to re-load them on the fly.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">remove-message</tt></td>
                                <td valign="bottom">
                                    Removes the message with the give <tt class="literal">id</tt> (an UUID)
                                from the local storage subsystem.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="wap-gateway"></a>Chapter 4. Setting up a WAP gateway</h1>
                <p>This chapter tells you how to set Kannel up as a WAP
                    gateway.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN1027">WAP gateway configuration</a></h2>
                    <p>To set up a WAP Kannel, you have to edit the 'core' group in the
                        configuration file, and define the 'wapbox' group.
                    </p>
                    <p>You must set following variables for the 'core' group:  
                    <tt class="literal">wapbox-port</tt> and
                    <tt class="literal">wdp-interface-name</tt>. See previous chapter about
                    details of these variables.
                    </p>
                    <p>With standard distribution, a sample configuration file
                    <tt class="literal">wapkannel.conf</tt> is supplied. You may want to take
                    a look at that when setting up a WAP Kannel.
                    </p>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN1035">Wapbox group</a></h3>
                        <p>If you have set <tt class="literal">wapbox-port</tt> variable in the
                        'core' configuration group, you <span class="emphasis"><i class="emphasis">MUST</i></span> supply
                        a 'wapbox' group.
                        </p>
                        <p>The simplest working 'wapbox' group looks like this:
                        </p>
                        <pre class="programlisting">
group = wapbox
bearerbox-host = localhost
                        </pre>
                        There is, however, multiple optional variables for the 'wapbox'
                        group.
                        <p></p>
                        <div class="table">
                            <a name="AEN1042"></a>
                            <p><b>Table 4-1. Wapbox Group Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group (m)</tt></td>
                                <td><tt class="literal">wapbox</tt></td>
                                <td valign="bottom">
                                    This is mandatory variable
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">bearerbox-host (m)</tt></td>
                                <td><tt class="literal">hostname</tt></td>
                                <td valign="bottom">
                                    The machine in which the bearerbox is. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">timer-freq</tt></td>
                                <td>value-in-seconds</td>
                                <td valign="bottom">
                                    The frequency of how often timers are checked out. Default is 1 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-interface-name</tt></td>
                                <td>IP address</td>
                                <td valign="bottom">
                                    If this is set then Kannel do outgoing HTTP requests
                                    using this interface.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">map-url</tt></td>
                                <td>URL-pair</td>
                                <td valign="bottom">
                                    The pair is separated with space.
                                    Adds a single mapping for the left side URL to the given destination.
                                    If you append an asterisk `*' to the left side URL, its prefix
                                    Is matched against the incoming URL. Whenever the prefix matches,
                                    the URL will be replaced completely by the right side. In addition, if 	  if you append an asterisk to the right side URL, the part
                                    of the incoming URL coming after the prefix, will be appended
                                    to the right side URL. Thus, for a line:
                                    map-url = "http://source/* http://destination/*"
                                    and an incoming URL of "http://source/some/path", the result
                                    will be "http://destination/some/path"
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">map-url-max</tt></td>
                                <td>number</td>
                                <td valign="bottom">
                                    If you need more than one mapping, set this to the highest number
                                    mapping you need. The default gives you 10 mappings, numbered
                                    from 0 to 9. Default: 9
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">map-url-0</tt></td>
                                <td>URL-pair</td>
                                <td valign="bottom">
                                    Adds a mapping for the left side URL to the given destination URL.
                                    Repeat these lines, with 0 replaced by a number up to map-url-max,
                                    if you need several mappings.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">device-home</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    Adds a mapping for the URL DEVICE:home (as sent by Phone.com browsers)
                                    to the given destination URL. There is no default mapping.
                                    NOTE: the mapping is added with both asterisks, as described above
                                    for the "map-url" setting. Thus, the above example line is
                                    equivalent to writing
                                    map-url = "DEVICE:home* http://some.where/*"
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">log-file</tt></td>
                                <td>filename</td>
                                <td rowspan="2" valign="bottom">
                                    As with bearerbox 'core' group. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">log-level</tt></td>
                                <td>number 0..5</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">access-log</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    A file containing all requested URLs from clients while wapbox operation,
                                    including client IP, HTTP server User-Agent string, HTTP response code, 
                                    size of reply.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">access-log-clean</tt></td>
                                <td>boolean</td>
                                <td valign="bottom">
                                    Indicates if <tt class="literal">access-log</tt> will contain standard 'markers', 
                                which means the 'Log begins', 'Log ends' markers and the prefixed
                                timestamp. This config directive should be set to 'true' if a custom 
                                logging format is desired without a prefixed default timestamp. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">access-log-time</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Determine which timezone we use for access logging. Use 'gmt' for GMT time, 
                                    anything else will use local time. Default is local time.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">syslog-level</tt></td>
                                <td>number</td>
                                <td valign="bottom">
                                    Messages of this log level or higher will also be
                                    sent to syslog, the UNIX system log daemon. If not explicitly
                                    set with <tt class="literal">syslog-facility</tt>, it logs under the
                                'daemon' category. The default is not to use syslog, and you can
                                set that explicitly by setting <tt class="literal">syslog-level</tt>
                                to 'none'.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">syslog-facility</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The syslog facility to send the syslog entries to. The
                                    default is 'daemon'.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smart-errors</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    If set wapbox will return a valid WML deck describing the 
                                    error that occurred while processing an WSP request. This may
                                    be used to have a smarter gateway and let the user know what
                                    happened actually.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">wml-strict</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    If set wapbox will use a strict policy in XML parsing the WML
                                    deck. If not set it will be more relaxing and let the XML parser
                                    recover from parsing errors. This has mainly impacts in how smart
                                    the WML deck and it's character set encoding can be adopted, even
                                    while you used an encoding that does not fit the XML preamble.
                                    BEWARE: This may be a vulnerability in your wapbox for large bogus 
                                    WML input. Therefore this defaults to 'yes', strict parsing.
                                    is assumed.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-timeout</tt></td>
                                <td>seconds</td>
                                <td valign="bottom">
                                    Sets socket timeout in seconds for outgoing client http
                                    connections. Optional. Defaults to 240 seconds.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <pre class="programlisting">
                        </pre>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN1146">Running WAP gateway</a></h2>
                    <p>WAP Gateway is ran as explained in previous chapter.</p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN1149">Checking whether the WAP gateway is alive</a></h2>
                    <p>You can check whether the WAP gateway (both the
                        bearerbox and the wapbox) is alive by fetching the URL
                    <tt class="literal">kannel:alive</tt>.
                    </p>
                </div>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="wtls"></a>Chapter 5. Setting up wtls security</h1>
                <p>This chapter tells you how to set Kannel up to handle wtls traffic.
                </p>
                <p><tt class="literal">wtls</tt> group is optional and single. The prerequisites for this group
                are to have defined a wapbox group, and a pair of SSL certificates
                available. Instructions on how to create self-signed 1024-bit RSA
                certificates are in <a href="#certificates">Appendix B</a>.
                </p>
                <p>Current imlementation provides for the following functionality:</p>
                <p></p>
                <p></p>
                <ol type="A">
                    <li>
                        <p>Supported MACs:</p>
                        <p></p>
                        <ul>
                            <li>
                                <p>SHA_0</p>
                            </li>
                            <li>
                                <p>SHA_40</p>
                            </li>
                            <li>
                                <p>SHA_80</p>
                            </li>
                            <li>
                                <p>SHA_NOLIMIT</p>
                            </li>
                            <li>
                                <p>MD5_40</p>
                            </li>
                            <li>
                                <p>MD5_80</p>
                            </li>
                            <li>
                                <p>MD5_NOLIMIT</p>
                            </li>
                        </ul>
                        <p>Missing:</p>
                        <p></p>
                        <ul>
                            <li>
                                <p>SHA_XOR_40</p>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>Supported Ciphers:</p>
                        <p></p>
                        <ul>
                            <li>
                                <p>RC5_CBC_40</p>
                            </li>
                            <li>
                                <p>RC5_CBC_56</p>
                            </li>
                            <li>
                                <p>RC5_CBC</p>
                            </li>
                            <li>
                                <p>DES_CBC</p>
                            </li>
                            <li>
                                <p>DES_CBC_40</p>
                            </li>
                        </ul>
                        <p>Missing:</p>
                        <p></p>
                        <ul>
                            <li>
                                <p>NULL_bulk</p>
                            </li>
                            <li>
                                <p>TRIPLE_DES_CBC_EDE</p>
                            </li>
                            <li>
                                <p>IDEA_CBC_40</p>
                            </li>
                            <li>
                                <p>IDEA_CBC_56</p>
                            </li>
                            <li>
                                <p>IDEA_CBC</p>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <p>Supported Keys:</p>
                        <p></p>
                        <ul>
                            <li>
                                <p>RSA_anon</p>
                            </li>
                        </ul>
                        <p>Missing:</p>
                        <p></p>
                        <ul>
                            <li>
                                <p>RSA_anon_512</p>
                            </li>
                            <li>
                                <p>RSA_anon_768</p>
                            </li>
                            <li>
                                <p>RSA_NOLIMIT</p>
                            </li>
                            <li>
                                <p>RSA_512</p>
                            </li>
                            <li>
                                <p>RSA_768</p>
                            </li>
                            <li>
                                <p>ECDH_anon</p>
                            </li>
                            <li>
                                <p>ECDH_anon_113</p>
                            </li>
                            <li>
                                <p>ECDH_anon_131</p>
                            </li>
                            <li>
                                <p>ECDH_ECDSA_NOLIMIT</p>
                            </li>
                        </ul>
                        <p>Keys might seem a shortcoming, but all mobiles support
                            RSA_anon. Some of the other RSA_anon keys (i.e. RSA_anon_512,
                            RSA_anon_768) are propably supported as well, just haven't been
                            tested yet.
                        </p>
                    </li>
                    <li>
                        <p>All wtls states except:</p>
                        <p></p>
                        <ul>
                            <li>
                                <p>Suspend/Resume wtls session</p>
                            </li>
                            <li>
                                <p>Cipher change when already connected. In practice
                                    this is handled through another client hello, while
                                    already connected to the same client
                                </p>
                            </li>
                        </ul>
                    </li>
                </ol>
                <p></p>
                <p>The simplest working <tt class="literal">wtls</tt> group looks like this:</p>
                <pre class="programlisting">
group = wtls
certificate-file = /etc/kannel/server.crt
privatekey-file = /etc/kannel/server.key
                </pre>
                Can also be the same single combined pem file with both certificate and
                privatekey parts. The complete variable list for the <tt class="literal">wtls</tt> group is:
                <p></p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN1245">Wtls configuration</a></h2>
                    <div class="table">
                        <a name="AEN1247"></a>
                        <p><b>Table 5-1. Wtls Group Variables</b></p>
                        <table frame="void" class="CALSTABLE" border="0">
                            <colgroup>
                                <col>
                                <col>
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Variable</th>
                                    <th>Value</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><tt class="literal">group (m)</tt></td>
                            <td><tt class="literal">wtls</tt></td>
                            <td valign="bottom">
                                This is mandatory variable
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">certificate-file (m)</tt></td>
                            <td><tt class="literal">filename</tt></td>
                            <td valign="bottom">
                                Public key SSL certificate.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">privatekey-file (m)</tt></td>
                            <td><tt class="literal">filename</tt></td>
                            <td valign="bottom">
                                Private key SSL certificate.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">privatekey-password (o)</tt></td>
                            <td><tt class="literal">Phrase</tt></td>
                            <td valign="bottom">
                                Optional. Needed only if private key was created with a passphrase.
                            </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="msisdn-provisioning"></a>Chapter 6. Setting up MSISDN provisioning for WAP gateway</h1>
                <p>This chapter tells you how to set Kannel up to deliver the MSISDN
                    number of the WAP device using the WAP gateway.
                </p>
                <p>Mostly this feature is interested because the WAP protocol stack
                    itself does not provide such a protocol layer bridging of information.
                    In case you want to know which unique MSISDN is used by the WAP device
                    your HTTP application is currently interacting, then you can pick this
                    information from a RADIUS server that is used by a NAS (network access
                    server) for authentication and accounting purposes.
                </p>
                <p>Kannel provides a RADIUS accounting proxy thread inside wapbox
                    which holds a mapping table for the dynamically assigned (DHCP) IP 
                    addresses of the WAP clients and their MSISDN numbers provided to the
                    NAS device.
                </p>
                <p>Beware that you <span class="emphasis"><i class="emphasis">HAVE TO</i></span> to be in control of 
                    the NAS to configure it to use Kannel's wapbox as RADIUS accounting 
                    server. You can not use
                    MSISDN provisioning via Kannel's RADIUS accounting proxy if you can
                    not forward the accounting packets to Kannel's accounting proxy thread.
                    So obviously this feature is for operators and people who have dedicated
                    dial-in servers (NAS).
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN1287">RADIUS accounting proxy configuration</a></h2>
                    <p>To set up the RADIUS accounting proxy thread inside Kannel you 
                        have to define a 'radius-acct' group.
                    </p>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN1290">RADIUS-Acct configuration</a></h3>
                        <p>The simplest working 'radius-acct' group looks like this:
                        </p>
                        <pre class="programlisting">
group = radius-acct
our-port = 1646
secret-nas = radius
                        </pre>
                        This example does not forward any accounting packets to a remote 
                        RADIUS server. There is, however, multiple optional variables for 
                        the 'radius-acct' group.
                        <p></p>
                        <div class="table">
                            <a name="AEN1294"></a>
                            <p><b>Table 6-1. RADIUS-Acct Group Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group (m)</tt></td>
                                <td><tt class="literal">radius-acct</tt></td>
                                <td valign="bottom">
                                    This is mandatory variable if you want to have Kannel's 
                                    RADIUS accounting proxy thread to be active inside wapbox.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">secret-nas (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Specifies the shared secret between NAS and our RADIUS accounting proxy.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">secret-radius</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Specifies the shared secret between our RADIUS accounting proxy and the
                                    remote RADIUS server itself in case we are forwarding packets.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">our-host</tt></td>
                                <td><tt class="literal">IP address</tt></td>
                                <td valign="bottom">
                                    Specifies the local interface where our-port value will bind
                                    to. (defaults to 0.0.0.0)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">remote-host</tt></td>
                                <td><tt class="literal">FQDN or IP address</tt></td>
                                <td valign="bottom">
                                    Specifies the remote RADIUS server to which we forward the 
                                    accounting packets. If none is given, then no forwarding of
                                    accounting packets is performed.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">our-port</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Specifies the port to which our RADIUS accounting proxy thread
                                    will listen to. (defaults according to RFC2866 to 1813)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">remote-port</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Specifies the port to which our RADIUS accounting proxy thread
                                    will forward any packets to the remote-host. 
                                    (defaults according to RFC2866 to 1813)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">remote-timeout</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Specifies the timeout value in milliseconds for waiting on a 
                                    response from the remote RADIUS server.
                                    (defaults to 40 msecs.)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">nas-ports</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Specifies how many possible clients can connect simultaneously 
                                    to the NAS. This value is used to initialize the mapping hash table.
                                    If does not require to be exact, because the table grows automatically
                                    if required. (defaults to 30)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">unified-prefix</tt></td>
                                <td>prefix-list</td>
                                <td valign="bottom">
                                    String to unify provided phone numbers from NAS.
                                    Format is that first comes the
                                    unified prefix, then all prefixes which are replaced by the
                                    unified prefix, separated with comma (','). For example,
                                    for Finland an unified-prefix "+358,00358,0;+,00" should do the trick. 
                                    If there are several unified prefixes, separate their rules with
                                    semicolon (';'), like "+35850,050;+35840,040".
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <pre class="programlisting">
                        </pre>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN1363">Using the MSISDN provisioning on HTTP server side</a></h3>
                        <p>Kannel's wapbox will include a specific HTTP header in the HTTP
                            request issued to the URL provided by the WAP client. That HTTP header 
                            is <tt class="literal">X-WAP-Network-Client-MSISDN</tt>. It will carry as value
                        the MSISDN of the WAP client if the RADIUS accounting proxy has received
                        a valid accounting packet from the NAS that provided the client IP.
                        </p>
                    </div>
                </div>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="sms-gateway"></a>Chapter 7. Setting up a SMS Gateway</h1>
                <p>This chapter is a more detailed guide on how to set up Kannel as an
                    SMS gateway.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN1370">Required components</a></h2>
                    <p>To set up an SMS gateway, you need, in addition to a machine
                        running Kannel, access to (an operator's) SMS center, or possibly
                        to multiple ones. The list of supported SMS centers and their
                        configuration variables is below.
                    </p>
                    <p>If you do not have such access, you can still
                        use Kannel as an SMS gateway via <span class="emphasis"><i class="emphasis">phone-as-SMSC</i></span> 
                        feature, by using a GSM phone as a virtual SMS center.
                    </p>
                    <p>In addition to an SMS center (real or virtual), you need some
                        server to handle any SMS requests received. This server then has
                        simple or more complex cgi-bins, programs or scripts to serve HTTP
                        requests generated by Kannel in response to received SMS
                        messages. These services can also initiate SMS push via Kannel
                        smsbox HTTP sendsms interface.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN1376">SMS gateway configuration</a></h2>
                    <p>To set up a SMS Kannel, you have to edit the 'core' group in the
                        configuration file, and define an 'smsbox' group plus one or more
                        'sms-service' groups, plus possibly one or more 'sendsms-user' groups.
                    </p>
                    <p>For the 'core' group, you must set the following variable:  
                    <tt class="literal">smsbox-port</tt>. In addition, you may be interested
                    to set <tt class="literal">unified-prefix</tt>,
                    <tt class="literal">white-list</tt> and/or <tt class="literal">black-list</tt>
                    variables. See above for details of these variables.
                    </p>
                    <p> A sample configuration file <tt class="literal">smskannel.conf</tt> 
                    is supplied with the standard distribution. You may want to take
                    a look at that when setting up an SMS Kannel.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN1386">SMS centers</a></h2>
                    <p>To set up the SMS center at Kannel, you have to add a 'smsc'
                        group into configuration file. 
                        This group must include all the data needed to connect
                        that SMS center. You may also want to define an ID
                        (identification) name for the SMSC, for logging and routing
                        purposes.
                    </p>
                    <p>SMSC ID is an abstract name for the connection. It can be
                        anything you like, but you should avoid any special
                        characters. You do not need to use ID, but rely on SMS center IP
                        address and other information. However, if you use the ID, you do
                        not need to re-define sms-services nor routing systems if the IP
                        of the SMS Center is changed, for example.
                    </p>
                    <p>Common 'smsc' group variables are defined in the following
                        table. The first two (<tt class="literal">group</tt> and
                    <tt class="literal">smsc</tt>) are mandatory, but rest can be used if
                    needed.
                    </p>
                    <div class="table">
                        <a name="AEN1393"></a>
                        <p><b>Table 7-1. SMSC Group Variables</b></p>
                        <table frame="void" class="CALSTABLE" border="0">
                            <colgroup>
                                <col>
                                <col>
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Variable</th>
                                    <th>Value</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><tt class="literal">group (m)</tt></td>
                            <td><tt class="literal">smsc</tt></td>
                            <td valign="bottom">
                                This is a mandatory variable
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">smsc (m)</tt></td>
                            <td><tt class="literal">string</tt></td>
                            <td valign="bottom">
                                Identifies the SMS center type. See below
                                for a complete list.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">smsc-id</tt></td>
                            <td><tt class="literal">string</tt></td>
                            <td valign="bottom">
                                An optional name or id for the smsc. Any string is
                                acceptable, but semicolon ';' may cause problems, so avoid
                                it and any other special non-alphabet characters. 
                                This 'id' is written into log files and can be used to
                                route SMS messages, and to specify the used SMS-service. 
                                Several SMSCs can have the same id. The name is
                                case-insensitive. Note that if SMS Center connection has an
                                assigned SMSC ID, it does NOT automatically mean that messages
                                with identical SMSC ID are routed to it; instead configuration
                                variables <tt class="literal">denied-smsc-id</tt>, 
                            <tt class="literal">allowed-smsc-id</tt> and
                            <tt class="literal">preferred-smsc-id</tt> is used for that.
                            If you want to use Delivery Reports, you must define this.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">smsc-admin-id</tt></td>
                            <td><tt class="literal">string</tt></td>
                            <td valign="bottom">
                                An optional id for the smsc to be used on administrative
                                commands. This allows commands targeted to individual binds
                                even if they share the same <tt class="literal">smsc-id</tt>
                            (for load balancing scenarios, for example). Any string is
                            acceptable, but semicolon ';' may cause problems, so avoid
                            it and any other special non-alphabet characters.
                            Several SMSCs can have the same admin-id, though it's not
                            recommended. The name is case-insensitive.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">throughput</tt></td>
                            <td><tt class="literal">float (messages/sec)</tt></td>
                            <td valign="bottom">
                                If SMSC requires that Kannel limits the number of messages per second, 
                                use this variable. This is considered as active throttling. (optional)
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">denied-smsc-id</tt></td>
                            <td><tt class="literal">id-list</tt></td>
                            <td valign="bottom">
                                SMS messages with SMSC ID equal to any of the IDs in this list
                                are never routed to this SMSC. Multiple entries are separated 
                                with semicolons (';')
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">allowed-smsc-id</tt></td>
                            <td><tt class="literal">id-list</tt></td>
                            <td valign="bottom">
                                This list is opposite to previous: only SMS messages with SMSC
                                ID in this list are ever routed to this SMSC.
                                Multiple entries are separated with semicolons (';')
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">preferred-smsc-id</tt></td>
                            <td><tt class="literal">id-list</tt></td>
                            <td valign="bottom">
                                SMS messages with SMSC ID from this list are sent to this SMSC
                                instead than to SMSC without that ID as preferred. Multiple
                                entries are separated with semicolons (';')
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">allowed-prefix</tt></td>
                            <td><tt class="literal">prefix-list</tt></td>
                            <td valign="bottom">
                                A list of phone number prefixes which are accepted to be
                                sent through this SMSC. Multiple entries are separated with 
                                semicolon (';'). For example, "040;050" prevents sending of
                                any SMS message with prefix of 040 or 050 through this SMSC.
                                If denied-prefix is unset, only these numbers are allowed. If
                                set, number are allowed if present in allowed or not in 
                                denied list.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">denied-prefix</tt></td>
                            <td><tt class="literal">prefix-list</tt></td>
                            <td valign="bottom">
                                A list of phone number prefixes which are NOT accepted to be
                                sent through this SMSC.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">preferred-prefix</tt></td>
                            <td><tt class="literal">prefix-list</tt></td>
                            <td valign="bottom">
                                As <tt class="literal">denied-prefix</tt>, but SMS messages with receiver starting
                            with any of these prefixes are preferably sent through this
                            SMSC. In a case of multiple preferences, one is selected at random
                            (also if there are preferences, SMSC is selected randomly)
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">unified-prefix</tt></td>
                            <td>prefix-list</td>
                            <td valign="bottom">
                                String to unify received phone numbers, for SMSC routing and
                                to ensure that SMS centers can handle them properly. 
                                This is applied to 'sender' number when receiving SMS
                                messages from SMS Center and for 'receiver' number when
                                receiving messages from smsbox (either sendsms message or
                                reply to original message). Format is that first comes the
                                unified prefix, then all prefixes which are replaced by the
                                unified prefix, separated with comma (','). For example,
                                for Finland an unified-prefix "+358,00358,0;+,00" should do the trick. 
                                If there are several unified prefixes, separate their rules with
                                semicolon (';'), like "+35850,050;+35840,040". <span class="emphasis"><i class="emphasis">Note
                                        that prefix routing is next to useless now that there are
                                        SMSC ID entries. To remove prefixes, use like 
                                        "-,+35850,050;-,+35840,040".
                                    </i></span>
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">alt-charset</tt></td>
                            <td><tt class="literal">number</tt></td>
                            <td valign="bottom">
                                As some SMS Centers do not follow the standards in character
                                coding, an <tt class="literal">alt-charset</tt> character conversion is
                            presented. This directive acts different for specific SMSC types.
                            Please see your SMSC module type you want to use for more details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">alt-dcs</tt></td>
                            <td><tt class="literal">boolean</tt></td>
                            <td valign="bottom">
                                Optional data coding scheme value usage. Sets the 'alt-dcs' value 
                                for the sendsms HTTP interface to a fixed value for each SMS sent 
                                via this SMSC connection. 
                                If equals to yes, uses FX. If equals to no (default), uses 0X.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">our-host</tt></td>
                            <td><tt class="literal">hostname</tt></td>
                            <td valign="bottom">
                                Optional hostname or IP address in which to bind the connection in our
                                end. TCP/IP connection only.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">log-file</tt></td>
                            <td>filename</td>
                            <td valign="bottom">
                                A file in which to write a log of the given smsc output. Hence
                                this allows to log smsc specific entries to a separate file.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">log-level</tt></td>
                            <td>number 0..5</td>
                            <td valign="bottom">
                                Minimum level of log-file events logged. 0 is for 'debug', 1
                                'info', 2 'warning, 3 'error' and 4 'panic' (see Command Line
                                Options)
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">reconnect-delay</tt></td>
                            <td><tt class="literal">number</tt></td>
                            <td valign="bottom">
                                Number of seconds to wait between single re-connection attempts.
                                Hence all SMSC modules should use this value for their 
                                re-connect behavior. (Defaults to '10' seconds).
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">reroute</tt></td>
                            <td><tt class="literal">boolean</tt></td>
                            <td valign="bottom">
                                If set for a smsc group, all inbound messages coming from this smsc
                                connection are passed internally	to the outbound routing functions. 
                                Hence this messages is not delivered to any connected box for 
                                processing. It is passed to the bearerbox routing as if it would
                                have originated from an externally connected smsbox.
                                (Defaults to 'no').
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">reroute-smsc-id</tt></td>
                            <td><tt class="literal">string</tt></td>
                            <td valign="bottom">
                                Similar to 'reroute'. Defines the explicit smsc-id 
                                the MO message should be passed to for MT traffic. Hence all 
                                messages coming from the the configuration group smsc are passed
                                to the outbound queue of the specified smsc-id. This allows 
                                direct proxying of messages between 2 smsc connections without 
                                injecting them to the general	routing procedure in bearerbox.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">reroute-receiver</tt></td>
                            <td><tt class="literal">string</tt></td>
                            <td valign="bottom">
                                Similar to 'reroute'. Defines the explicit smsc-id routes 
                                for specific receiver numbers of messages that are coming from this
                                smsc connection.
                                Format is that first comes the smsc-id to route the message to, then 
                                all receiver numbers that should be routed, separated with comma (','). 
                                For example, route receivers 111 and 222 to smsc-id A and 333 and 444
                                to smsc-id B would look like: "A,111,222; B,333,444".
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">reroute-dlr</tt></td>
                            <td><tt class="literal">boolean</tt></td>
                            <td valign="bottom">
                                Indicate whether DLR's should be re-routed too, if one of above reroute
                                rules are enabled. Please note, that SMSC-Module should support DLR sending.
                                At time of writing none of SMSC-Module supports DLR sending.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">allowed-smsc-id-regex</tt></td>
                            <td>POSIX regular expression</td>
                            <td valign="bottom">
                                SMS messages with SMSC ID equal to any of the IDs in this set of SMSC IDs
                                are always routed to this SMSC. 
                                See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">denied-smsc-id-regex</tt></td>
                            <td>POSIX regular expression</td>
                            <td valign="bottom">
                                SMS messages with SMSC ID equal to any of the IDs in this set of SMSC IDs
                                are never routed to this SMSC. 
                                See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">preferred-smsc-id-regex</tt></td>
                            <td>POSIX regular expression</td>
                            <td valign="bottom">
                                SMS messages with SMSC ID in this set of SMSC IDs are sent to this SMSC
                                as preferred.
                                See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">allowed-prefix-regex</tt></td>
                            <td>POSIX regular expression</td>
                            <td valign="bottom">
                                A set of phone number prefixes which are accepted to be
                                sent through this SMSC. 
                                See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">denied-prefix-regex</tt></td>
                            <td>POSIX regular expression</td>
                            <td valign="bottom">
                                A set of phone number prefixes which may not be
                                sent through this SMSC. 
                                See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">preferred-prefix-regex</tt></td>
                            <td>POSIX regular expression</td>
                            <td valign="bottom">
                                As <tt class="literal">denied-prefix-regex</tt>, but SMS messages with receiver matching 
                            any of these prefixes are preferably sent through this
                            SMSC. In a case of multiple preferences, one is selected at random.
                            See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">max-sms-octets</tt></td>
                            <td>number</td>
                            <td valign="bottom">
                                Maximum allowed octets for this SMSC. If this maximum exceeds Kannel will split
                                SMS into multiparts.
                                Default: 140
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">dead-start</tt></td>
                            <td><tt class="literal">boolean</tt></td>
                            <td valign="bottom">
                                Optional, defines if the SMSC connection type is started in disconnected mode (dead).
                                This allows SMSC to be connected at a later time with the add-smsc HTTP administration command. 
                                If set to 'true' the connection will start as 'dead' and will require a start-smsc command 
                                to activate it. Defaults to 'false' if not present.
                            </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                    <p>In addition to these common variables there are several
                        variables used by certain SMS center connections. Each currently
                        supported SMS center type is explained below, with configuration
                        group for each. Note that many of them use variables with same
                        name, but most also have some specific variables.
                    </p>
                    <p><span class="emphasis"><i class="emphasis">NOTE: SMS center configuration variables are a bit 
                                incomplete, and will be updated as soon as people responsible for
                                the protocols are contacted. Meanwhile, please have
                                patience.</i></span>
                    </p>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN1589">Nokia CIMD 1.37 and 2.0</a></h3>
                        <p>Support for CIMD 1.37 is quite old and will be removed in a
                            future version of Kannel.  Please let us know if you still need it.
                        </p>
                        <pre class="programlisting">
group = smsc
smsc = cimd
host = 100.101.102.103
port = 600
smsc-username = foo
smsc-password = bar
                        </pre>
                        <p>The driver for CIMD2 is a "receiving SME" and expects the SMSC
                            to be configured for that.  It also expects the SMSC to automatically
                            send stored messages as soon as Kannel logs in (this is the normal
                            configuration).
                        </p>
                        <pre class="programlisting">
group = smsc
smsc = cimd2
host = 100.101.102.103
port = 600
smsc-username = foo
smsc-password = bar
keepalive = 5 
my-number = "12345"
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN1595"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">host (m)</tt></td>
                                <td><tt class="literal">hostname</tt></td>
                                <td valign="bottom">
                                    Machine that runs the SMSC. As IP (100.100.100.100) 
                                    or hostname (their.machine.here)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">port (m)</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    Port number in the smsc host machine
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-username (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Username in the SMSC machine/connection account
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-password (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Password in the SMSC machine needed to contact SMSC
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">keepalive</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    SMSC connection will not be left idle for longer than this many
                                    seconds.  The right value to use depends on how eager the SMSC
                                    is to close idle connections. If you see many unexplained 
                                    reconnects, try lowering this value.
                                    Set it to 0 to disable this feature.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">no-dlr</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Optional. If defined, status delivery report requests (DLR) won't be
                                    requested at all. Some CIMD2 SMSC have prohibited these reports so
                                    if you are getting error like "Incorrect status report request parameter
                                    usage", this option is for you. Defaults to "false".
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">my-number</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    The number that the SMSC will add in front of the sender number
                                    of all messages sent from Kannel.  If Kannel is asked to send
                                    a message, it will remove this prefix from the sender number
                                    so that the SMSC will add it again.  If the prefix was not present,
                                    Kannel will log a warning and will not send the sender number.
                                    If <tt class="literal">my-number</tt> is not set, or is set
                                to <tt class="literal">"never"</tt>, then Kannel will not send the
                                sender number to the SMSC at all.
                                If you want Kannel to pass all sender numbers to the SMSC
                                unchanged, then just set <tt class="literal">sender-prefix</tt> to the
                                empty string <tt class="literal">""</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">our-port</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    Optional port number in which to bind the connection in our
                                    end.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN1655">CMG UCP/EMI 4.0 and 3.5</a></h3>
                        <div class="warning">
                            <p></p>
                            <table class="warning" border="1" width="100%">
                                <tbody>
                                    <tr>
                                        <td align="CENTER"><b>Warning</b></td>
                                    </tr>
                                    <tr>
                                        <td align="LEFT">
                                            <p>See <a href="#upgrading-notes">Appendix A</a> for changes.</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p>Kannel supports two types of connections with CMG SMS centers:
                            direct TCP/IP connections ( <tt class="literal">emi</tt>) and ISDN/modem 
                        (X.25) connection (<tt class="literal">emi_x25</tt>).
                        </p>
                        <div class="note">
                            <blockquote class="note">
                                <p><b>Note: </b><tt class="literal">emi_x25</tt> is an old implementation and supports less 
                                features than it's IP counterpart. If you still need this module, please tell
                                us to <tt class="literal">devel@kannel.org</tt> so we can fix it.
                                </p>
                            </blockquote>
                        </div>
                        <p>Sample configurations for these are:</p>
                        <pre class="programlisting">
group = smsc
smsc = emi
host = 103.102.101.100
port = 6000
smsc-username = foo
smsc-password = bar
keepalive = 55
our-port = 600 (optional bind in our end)
receive-port = 700 (the port in which the SMSC will contact)
idle-timeout = 30

group = smsc
smsc = emi_x25
phone = ...
device = /dev/tty0
smsc-username = foo
smsc-password = bar
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN1669"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">host (c)</tt></td>
                                <td><tt class="literal">hostname</tt></td>
                                <td valign="bottom">
                                    Machine that runs SMSC. As IP (100.100.100.100) 
                                    or hostname (their.machine.here)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">port (c)</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    Port number in the SMSC host machine
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">alt-host</tt></td>
                                <td><tt class="literal">hostname</tt></td>
                                <td valign="bottom">
                                    Optional alternate Machine that runs SMSC. 
                                    As IP (100.100.100.100) or hostname (their.machine.here)
                                    (If undef but exists alt-port, emi2 would try host:alt-port)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">alt-port</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    Optional alternate Port number in the SMSC host machine
                                    (If undef but exists alt-host, emi2 would try alt-host:port)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-username</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Username in the SMSC machine/connection account
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-password</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Password in the SMSC machine needed to contact SMSC
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">device (c)</tt></td>
                                <td><tt class="literal">device-name</tt></td>
                                <td valign="bottom">
                                    The device the modem is connected to, like <tt class="literal">/dev/ttyS0</tt>.
                                ISDN connection only.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">phone (c)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Phone number to dial to, when connecting over a modem to an
                                    SMS center.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">our-port</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    Optional port number in which to bind the connection in our
                                    end. TCP/IP connection only.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">our-receiver-port</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    Optional port number allowing to specify our port when connecting
                                    an SMSC. TCP/IP connection only.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">receive-port</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    Optional port number we listen to and to which the SMS center
                                    connects when it has messages to send. Required if SMS center
                                    needs one connection to send and other to receive.
                                    TCP/IP connection only.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">appname</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Name of a "Send only" service. Defaults to <tt class="literal">send</tt>.
                                All outgoing messages are routed through this service.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">connect-allow-ip</tt></td>
                                <td><tt class="literal">IP-list</tt></td>
                                <td valign="bottom">
                                    If set, only connections from these IP addresses are accepted
                                    to receive-port. TCP/IP connection only.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">idle-timeout</tt></td>
                                <td><tt class="literal">number (seconds)</tt></td>
                                <td valign="bottom">
                                    If this option is set to a value larger than 0, then the connection will
                                    be closed after the configured amount of seconds without activity. This 
                                    option interacts with the <tt class="literal">keepalive</tt> configuration option.
                                If <tt class="literal">keepalive</tt> is smaller than <tt class="literal">idle-timeout</tt>,
                                then the connection will never be idle and those this option has no effect.
                                If <tt class="literal">keepalive</tt> is larger than <tt class="literal">idle-timeout</tt>,
                                than <tt class="literal">keepalive</tt> reopens the connection. This allows one to poll
                                for pending mobile originated Short Messages at the SMSC.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">keepalive</tt></td>
                                <td><tt class="literal">number (seconds)</tt></td>
                                <td valign="bottom">
                                    A keepalive command will be
                                    sent to the SMSC connection this many seconds after the last
                                    message. The right value to use depends on how eager the SMSC is
                                    to close idle connections.  50 seconds is a good guess. If you
                                    see many unexplained reconnects, try lowering this value. Set it
                                    to 0 to disable this feature.
                                    Requires username or my-number to be set.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">wait-ack</tt></td>
                                <td><tt class="literal">number (seconds)</tt></td>
                                <td valign="bottom">
                                    A message is resent if the acknowledge from SMSC takes more than 
                                    this time.  Defaults to 60 seconds.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">wait-ack-expire</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Defines what kind of action should be taken if the the ack of 
                                    a message expires. The options for this value are:
                                    0x00 - disconnect/reconnect, (default) 0x01 - as is now, re-queue, 
                                    but this could potentially result in the msg arriving twice
                                    0x02 - just carry on waiting (given that the wait-ack should never 
                                    expire this is the must accurate)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">flow-control</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    This SMSC can support two types of flow control. The first type 
                                    of flow control is a <tt class="literal">stop-and-wait</tt> protocol, 
                                when this parameter equals to '1'. During the handling of commands, 
                                no other commands shall be sent before the a response is received. 
                                Any command that is sent before the reception of the response will 
                                be discarded.
                                The second type of flow control is <tt class="literal">windowing</tt>,
                                when this parameter is unset or equals '0'. In this case a maximum 
                                of n commands can be sent before a response is received. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">window</tt></td>
                                <td><tt class="literal">number (messages)</tt></td>
                                <td valign="bottom">
                                    When using <tt class="literal">flow-control=0</tt>, emi works in windowed
                                flow control mode. This variable defines the size of the window used
                                to send messages. (optional, defaults to the maximum - 100)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">my-number</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    If the large account number is different from the short number, assign
                                    it with this variable. For example, if short number is 12345 and large account
                                    is 0100100100101234 (IP+port), set my-number to 12345 and 
                                    every message received will have that receiver. In addition, if you are bound
                                    to the SMSC without an explicit login, use this configuration directive to 
                                    enable keep-alive (OP/31) operations. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">alt-charset</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Defines which character conversion kludge may be used for this 
                                    specific link. Currently implemented alternative charsets are 
                                    defined in "alt_charsets.h" and new ones can be added.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">notification-pid</tt></td>
                                <td><tt class="literal">4 num char.</tt></td>
                                <td valign="bottom">
                                    Notification PID value. See below for a complete list and other notes.
                                    Example: 0539
                                    <a name="notification-pid-note" href="#FTN.notification-pid-note"><span class="footnote">[a]</span></a>
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">notification-addr</tt></td>
                                <td><tt class="literal">string (max 16)</tt></td>
                                <td valign="bottom">
                                    Notification Address. Example: 0100110120131234.
                                    <a name="notification-addr-note" href="#FTN.notification-addr-note"><span class="footnote">[b]</span></a>
                                </td>
                                </tr>
                                </tbody>
                                <tbody>
                                    <tr>
                                        <td colspan="3">Notes:<br><a name="FTN.notification-pid-note">a. </a>If you set 
                                <tt class="literal">notification-pid</tt>, you should also set 
                                <tt class="literal">notification-addr</tt>.<br><a name="FTN.notification-addr-note">b. </a>If you set 
                                <tt class="literal">notification-addr</tt>, you should also set 
                                <tt class="literal">notification-pid</tt>.<br>
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                        <p>
                            You should use <tt class="literal">notification-pid</tt> and 
                        <tt class="literal">notification-addr</tt> if you need to inform
                        your exact "address" to your smsc. For example, if you have a
                        <tt class="literal">Multiple-Address (MA)</tt> account with several
                        connections to the same <tt class="literal">short number</tt>, you may 
                        need to tell your smsc to send delivery reports to the exact instance
                        that sent the message. This is required because if you send a message
                        with instance 1, your instance 2 wouldn't know about it, unless you
                        use a shared DB store for delivery reports.
                        </p>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN1839"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Notification PID Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>0100</td>
                                        <td>Mobile Station</td>
                                    </tr>
                                    <tr>
                                        <td>0122</td>
                                        <td>Fax Group 3</td>
                                    </tr>
                                    <tr>
                                        <td>0131</td>
                                        <td>X.400</td>
                                    </tr>
                                    <tr>
                                        <td>0138</td>
                                        <td>Menu over PSTN</td>
                                    </tr>
                                    <tr>
                                        <td>0139</td>
                                        <td>PC appl. over PSTN (E.164)</td>
                                    </tr>
                                    <tr>
                                        <td>0339</td>
                                        <td>PC appl. over X.25 (X.121)</td>
                                    </tr>
                                    <tr>
                                        <td>0439</td>
                                        <td>PC appl. over ISDN (E.164)</td>
                                    </tr>
                                    <tr>
                                        <td>0539</td>
                                        <td>PC appl. over TCP/IP</td>
                                    </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN1870">SMPP 3.3, 3.4 and 5.0</a></h3>
                        <p>This implements Short Message Peer to Peer (SMPP) Protocol
                            5.0, with most used support for 3.4 and full support for 3.3. Sample
                            configuration:
                        </p>
                        <pre class="programlisting">
group = smsc
smsc = smpp
host = 123.123.123.123
port = 600
smsc-username = "STT"
smsc-password = foo
system-type = "VMA"
address-range = ""
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN1874"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">host (m)</tt></td>
                                <td><tt class="literal">hostname</tt></td>
                                <td valign="bottom">
                                    Machine that runs SMSC. As IP (100.100.100.100) 
                                    or hostname (their.machine.here)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">port (m)</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    The port number for the TRANSMITTER connection to the SMSC. 
                                    If set, receive-port must be ommited or set to 0.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">use-ssl</tt></td>
                                <td><tt class="literal">bool</tt></td>
                                <td valign="bottom">
                                    Defines whether we should try to bind with SSL enabled connection.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">ssl-client-certkey-file (c)</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    A PEM encoded SSL certificate and private key file to be used
                                    for SSL connections. This option is used together with use-ssl
                                    for client certificate validation with SMPP SMSCs requiring it.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">transceiver-mode</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    Use a TRANSCEIVER mode connection to the SMSC. 
                                    It uses the standard transmit 'port' to define the port
                                    to connect to.
                                    This is a SMPP 3.4 and 5.0 feature and will not work
                                    on an earlier SMSC using SMPP 3.3.
                                    This will do a bind_transceiver only and will not attempt
                                    to fall back to doing transmit and receive on the same connection.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">receive-port</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    The port number for the RECEIVER connection to the SMSC. 
                                    If set, port must be ommited or set to 0.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-username (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    The 'username' of the Messaging Entity connecting to the
                                    SMSC. If the SMSC operator reports that the "TELEPATH
                                    SYSTEM MANAGER TERMINAL" view "Control.Apps.View" value 
                                    "Name:" is "SMPP_ZAPVMA_T" for the transmitter and 
                                    "SMPP_ZAPVMA_R" for the receiver the smsc-username value 
                                    is accordingly "SMPP_ZAP". Note that this used to be called
                                    system-id (the name in SMPP documentation) and has been
                                    changed to smsc-username to make all Kannel SMS center
                                    drivers use the same name.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-password (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    The password matching the "smsc-username" your teleoperator
                                    provided you with.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">system-type (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Optional; used to categorize the type of ESME that is binding 
                                    to the SMSC. Examples include "VMS" (voice mail system) and "OTA" 
                                    (over-the-air activation system). If not set, defaults to 
                                    "VMA" (voice mail alerting).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">service-type</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Optional; if specified, sets the service type for the SMSC. If
                                    unset, the default service type is used. This may be used to
                                    influence SMS routing (for example). The SMSC operator may
                                    also refer to this as the "profile ID". The maximum length of the
                                    service type is 6, according to the SMPP specification v3.4.
                                    Defined values are: "CMT" (cellular messaging), "CPT" (cellular
                                    paging), "VMN" (voice mail notification), "VMA" (voice mail
                                    alerting), "WAP" (wireless application protocol), "USSD"
                                    (unstructured supplementary services data), "CBS" (cell broadcast
                                    service) and "GUTS" (generic UDP transport service). Other values
                                    may be defined mutually between the SMSC and the ESME application.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">interface-version</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Change the "interface version" parameter sent from Kannel to
                                    a value other then 0x34 (for SMPP v3.4). The value entered here
                                    should be the hexadecimal representation of the interface version
                                    parameter. For example, the default (if not set) is "34" which stands
                                    for 0x34. For SMPP v3.3 set to "33". For SMPP v5.0 set to "50".
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">address-range (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    According to the SMPP 3.4 spec this is supposed to
                                    affect which MS's can send messages to this account.
                                    Doesn't seem to work, though.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">my-number</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional smsc short number. Should be set if smsc sends
                                    a different one.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">enquire-link-interval</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional the time lapse allowed between operations after which 
                                    an SMPP entity should interrogate whether it's peer still has an 
                                    active session. The default is 30 seconds.  
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">max-pending-submits</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional the maximum number of outstanding (i.e. acknowledged)
                                    SMPP operations between an ESME and SMSC. This number
                                    is not specified explicitly in the SMPP Protocol Specification
                                    and will be governed by the SMPP implementation on the SMSC.
                                    As a guideline it is recommended that no more than 10 (default)
                                    SMPP messages are outstanding at any time.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">reconnect-delay</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional the time between attempts to connect an ESME to an SMSC 
                                    having failed to connect initiating or during an SMPP session. 
                                    The default is 10 seconds.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">source-addr-ton</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, source address TON setting for the link.
                                    (Defaults to 2).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">source-addr-npi</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, source address NPI setting for the link.
                                    (Defaults to 1).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">source-addr-autodetect</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Optional, if defined tries to scan the source address and 
                                    set TON and NPI settings accordingly. If you don't want to autodetect
                                    the source address, turn this off, by setting it to no.
                                    (Defaults to yes).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dest-addr-ton</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, destination address TON setting for the link.
                                    (Defaults to 2).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dest-addr-npi</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, destination address NPI setting for the link.
                                    (Defaults to 1).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">bind-addr-ton</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, bind address TON setting for the link.
                                    (Defaults to 0).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">bind-addr-npi</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, bind address NPI setting for the link.
                                    (Defaults to 0).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">msg-id-type</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, specifies which number base the SMSC is using for the
                                    message ID numbers in the corresponding <tt class="literal">submit_sm_resp</tt> 
                                and <tt class="literal">deliver_sm</tt> PDUs. This is required to make
                                delivery reports (DLR) work on SMSC that behave differently. The number
                                is a combined set of bit 1 and bit 2 that indicate as follows:
                                bit 1: type for <tt class="literal">submit_sm_resp</tt>, bit 2: type for 
                                <tt class="literal">deliver_sm</tt>. If the bit is set then the  value is 
                                in hex otherwise in decimal number base. Which means the following
                                combinations are possible and valid: 
                                0x00 <tt class="literal">deliver_sm</tt> decimal, 
                                <tt class="literal">submit_sm_resp</tt> decimal;
                                0x01 <tt class="literal">deliver_sm</tt> decimal, 
                                <tt class="literal">submit_sm_resp</tt> hex;
                                0x02 <tt class="literal">deliver_sm</tt> hex, 
                                <tt class="literal">submit_sm_resp</tt> decimal;
                                0x03 <tt class="literal">deliver_sm</tt> hex, 
                                <tt class="literal">submit_sm_resp</tt> hex. 
                                In accordance to the SMPP v3.4 specs the default will be a C string 
                                literal if no of the above values is explicitly indicated using the 
                                config directive.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">alt-charset</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Defines which character encoding is used for this specific smsc link. 
                                    Uses <tt class="literal">iconv()</tt> routines to convert from and to that
                                specific character set encoding. See your local iconv_open(3) manual 
                                page for the supported character encodings and the type strings that
                                should be presented for this directive.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">alt-addr-charset</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Defines which character encoding is used for alphanumeric addresses.
                                    When set to <tt class="literal">GSM</tt>, addresses are converted into the
                                GSM 03.38 charset (Since @ is translated into 0x00 which will break
                                the SMPP PDU, @ replaced with ?). If set to another value,
                                <tt class="literal">iconv()</tt> is used.
                                (Defaults to windows-1252)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">connection-timeout</tt></td>
                                <td><tt class="literal">number (seconds)</tt></td>
                                <td valign="bottom">
                                    This timer specifies the maximum time lapse allowed 
                                    between transactions , after which period of inactivity, an SMPP driver may 
                                    assume that the session is no longer active and does reconnect.
                                    Defaults to 300 seconds, to disable set it to 0.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">wait-ack</tt></td>
                                <td><tt class="literal">number (seconds)</tt></td>
                                <td valign="bottom">
                                    A message is resent if the acknowledge from SMSC takes more than 
                                    this time.  Defaults to 60 seconds.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">wait-ack-expire</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Defines what kind of action should be taken if the ack of 
                                    a message expires. The options for this value are:
                                    0x00 - disconnect/reconnect, (default) 0x01 - as is now, re-queue, 
                                    but this could potentially result in the msg arriving twice
                                    0x02 - just carry on waiting (given that the wait-ack should never 
                                    expire this is the must accurate)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">validityperiod</tt></td>
                                <td><tt class="literal">integer</tt></td>
                                <td valign="bottom">
                                    How long the message will be valid, i.e., how long the SMSC will try
                                    try to send the message to the recipient. Defined in minutes.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">esm-class</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Change the "esm_class" parameter sent from Kannel. 
                                    Accepted values are 0 (Default SMSC Mode) and 3 (Store and Forward). 
                                    Defaults to 3.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN2081">Sema Group SMS2000 OIS 4.0, 5.0 and 5.8</a></h3>
                        <p>The 4.0 implementation is over Radio PAD (X.28). Following
                            configuration variables are needed, and if you find out the more
                            exact meaning, please send a report.
                        </p>
                        <p>The 5.0 implementation uses X.25 access gateway.</p>
                        <p>The 5.8 implementation uses direct TCP/IP access interface.</p>
                        <pre class="programlisting">
group = smsc
smsc = sema
device = /dev/tty0
smsc_nua = (X121 smsc address)
home_nua = (x121 radio pad address)
wait_report = 0/1 (0 means false, 1 means true)
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN2087"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">device (m)</tt></td>
                                <td><tt class="literal">device</tt></td>
                                <td valign="bottom">
                                    ex: /dev/tty0
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc_nua (m)</tt></td>
                                <td><tt class="literal">X121 smsc address</tt></td>
                                <td valign="bottom">
                                    The address of an SMSC for SEMA SMS2000 protocols using an
                                    X.28 connection.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">home_nua (m)</tt></td>
                                <td><tt class="literal">X121 radio pad address</tt></td>
                                <td valign="bottom">
                                    The address of a radio PAD implementing Sema SMS2000 using
                                    X.28 connection.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">wait_report</tt></td>
                                <td><tt class="literal">0 (false)/1 (true)</tt></td>
                                <td valign="bottom">
                                    Report indicator used by the Sema SMS2000 protocol. Optional.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                        <pre class="programlisting">
group = smsc
smsc = ois
host = 103.102.101.100
port = 10000
receive-port = 10000
ois-debug-level = 0
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN2120"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">host (m)</tt></td>
                                <td><tt class="literal">ip</tt></td>
                                <td valign="bottom">
                                    SMSC Host name or IP
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">port (m)</tt></td>
                                <td><tt class="literal">port number</tt></td>
                                <td valign="bottom">
                                    SMSC Port number
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">receive-port (m)</tt></td>
                                <td><tt class="literal">port number</tt></td>
                                <td valign="bottom">
                                    The port in which the SMSC will contact
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">ois-debug-level</tt></td>
                                <td><tt class="literal">number 0 to 8</tt></td>
                                <td valign="bottom">
                                    extra debug, optional, see smsc_ois.c
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                        <pre class="programlisting">
group = smsc
smsc = oisd
host = 103.102.101.100
port = 10000
keepalive = 25
my-number = 12345
validityperiod = 30
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN2153"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">host (m)</tt></td>
                                <td><tt class="literal">ip</tt></td>
                                <td valign="bottom">
                                    SMSC Host name or IP
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">port (m)</tt></td>
                                <td><tt class="literal">port number</tt></td>
                                <td valign="bottom">
                                    SMSC Port number
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">keepalive</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    SMSC connection will not be left idle for longer than this many
                                    seconds.  The right value to use depends on how eager the SMSC
                                    is to close idle connections. If you see many unexplained 
                                    reconnects, try lowering this value.
                                    Set it to 0 to disable this feature.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">my-number</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Any valid SME number acceptable by SMSC. This number is used only in keepalive request. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">validityperiod</tt></td>
                                <td><tt class="literal">integer</tt></td>
                                <td valign="bottom">
                                    How long the message will be valid, i.e., how long the SMS
                                    center (the real one, not the phone acting as one for Kannel)
                                    will try to send the message to the recipient. Defined in minutes.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN2191">SM/ASI (for CriticalPath InVoke SMS Center 4.x)</a></h3>
                        <p>This implements Short Message/Advanced Service Interface 
                            (SM/ASI) Protocol for the use of connecting to a CriticalPath
                            InVoke SMS Center. Sample
                            configuration:
                        </p>
                        <pre class="programlisting">
group = smsc
smsc = smasi
host = 10.11.12.13
port = 23456
smsc-username = foo
smsc-password = foo
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN2195"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">host (m)</tt></td>
                                <td><tt class="literal">hostname</tt></td>
                                <td valign="bottom">
                                    Machine that runs SMSC. As IP (10.11.12.13) 
                                    or hostname (host.foobar.com)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">port (m)</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    The port number for the connection to the SMSC. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-username (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    The 'username' of the Messaging Entity connecting to the
                                    SMSC. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-password (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    The password matching the "smsc-username" your teleoperator
                                    provided you with.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">reconnect-delay</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, the time between attempts to connect to an SMSC 
                                    having failed to connect initiating or during an session. 
                                    The default is 10 seconds.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">source-addr-ton</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, source address TON setting for the link.
                                    (Defaults to 1).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">source-addr-npi</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, source address NPI setting for the link.
                                    (Defaults to 1).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dest-addr-ton</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, destination address TON setting for the link.
                                    (Defaults to 1).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dest-addr-npi</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, destination address NPI setting for the link.
                                    (Defaults to 1).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">priority</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional, sets the default priority of messages transmitted
                                    over this smsc link.
                                    (Defaults to 0, which is the lowest priority).
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN2263">GSM modem</a></h3>
                        <div class="warning">
                            <p></p>
                            <table class="warning" border="1" width="100%">
                                <tbody>
                                    <tr>
                                        <td align="CENTER"><b>Warning</b></td>
                                    </tr>
                                    <tr>
                                        <td align="LEFT">
                                            <p>See <a href="#upgrading-notes">Appendix A</a> for changes.</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <p>This driver allows a GSM Modem or Phone to be connected to Kannel 
                            and work as a virtual SMSC
                        </p>
                        <pre class="programlisting">
group = smsc
smsc = at
modemtype = auto
device = /dev/ttyS0
speed = 9600
pin = 2345
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN2270"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">modemtype</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Modems from different manufacturers have slightly different
                                    behavior. We need to know what type of modem is used. Use "auto"
                                    or omit parameter to have Kannel detect the modem type automatically.
                                    (some types should not be auto-detected like the Nokia Premicell).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">device (m)</tt></td>
                                <td><tt class="literal">device-name</tt></td>
                                <td valign="bottom">
                                    The device the modem is connected to, like <tt class="literal">/dev/ttyS0</tt>.
                                When the device name is set to <tt class="literal">rawtcp</tt> or 
                                <tt class="literal">telnet</tt> two other
                                variables are required in the configuration: <tt class="literal">host</tt>
                                and <tt class="literal">port</tt>. See the note below.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">speed</tt></td>
                                <td><tt class="literal">serial speed in bps</tt></td>
                                <td valign="bottom">
                                    The speed in bits per second. Default value 0 means to try to use
                                    speed from modem definition, or if it fails, try to autodetect.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">pin</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    This is the PIN number of the SIM card in the GSM modem. You can specify
                                    this option if your SIM has never been used before and needs to have
                                    the PIN number entered. The PIN is usually a four digit number.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">validityperiod</tt></td>
                                <td><tt class="literal">integer</tt></td>
                                <td valign="bottom">
                                    How long the message will be valid, i.e., how long the SMS
                                    center (the real one, not the phone acting as one for Kannel)
                                    will try to send the message to the recipient. Encoded as per
                                    the GSM 03.40 standard, section 9.2.3.12. Default is
                                    167, meaning 24 hours.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">keepalive</tt></td>
                                <td><tt class="literal">seconds</tt></td>
                                <td valign="bottom">
                                    Kannel would "ping" the modem for this many seconds. If the probe fails, 
                                    try to reconnect to it.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">my-number</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional phone number.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sms-center</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    SMS Center to send messages.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sim-buffering</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Whether to enable the so-called "SIM buffering behavior" of the GSM module.
                                    if assigned a true value, the module will query the message storage memory
                                    of the modem and will process and delete any messages found there. this does
                                    not alter normal behavior, but only add the capability of reading messages that
                                    were stored in the memory for some reason. The type of memory to use can be
                                    selected using the 'message-storage' parameter of the modem configuration.
                                    Polling the memory is done at the same interval as keepalive (if set) or 60 seconds
                                    (if not set).
                                    NOTE: This behavior is known to cause minor or major hiccups for a few buggy modems.
                                    Modems known to work with this setting are Wavecom WM02/M1200 and the Siemens M20.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">max-error-count</tt></td>
                                <td><tt class="literal">integer</tt></td>
                                <td valign="bottom">
                                    Maximal error count for opening modem device or initializing of the modem before
                                <tt class="literal">reset-string</tt> will be executed. This is useful when modem crashed and needs
                                hard reset. Default disabled.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">host</tt></td>
                                <td><tt class="literal">IP address</tt></td>
                                <td valign="bottom">
                                    Hostname or IP address to connect in <tt class="literal">rawtcp</tt> mode. 
                                Required if <tt class="literal">device</tt> is set to <tt class="literal">rawtcp</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">port</tt></td>
                                <td><tt class="literal">integer</tt></td>
                                <td valign="bottom">
                                    TCP port to connect to on <tt class="literal">rawtcp-host</tt>.
                                Required if <tt class="literal">device</tt> is set to <tt class="literal">rawtcp</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-username</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Username to use on a Login: or User: prompt prior to be connected
                                    to the modem. Useful if modem is connected to a terminal server
                                    and <tt class="literal">rawtcp</tt> mode or <tt class="literal">telnet</tt> mode
                                are used.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-password</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Username to use on a Password prompt prior to be connected
                                    to the modem. Useful if modem is connected to a terminal server
                                    and <tt class="literal">rawtcp</tt> mode or <tt class="literal">telnet</tt> mode
                                are used. <tt class="literal">smsc-password</tt> can be used alone
                                without <tt class="literal">smsc-username</tt> for devices only asking for
                                a password.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">login-prompt</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    An alternative string to be used instead of Login: or Username:
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">password-prompt</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    An alternative string to be used instead of Password:
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                        <p>Modem definitions are now multiple groups present in kannel.conf,
                            either directly or, for example, by including the example
                            modems.conf. (See <a href="#includes"><i>Inclusion of configuration files</i></a>)
                        </p>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN2394"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group</tt></td>
                                <td><tt class="literal">modems</tt></td>
                                <td valign="bottom">
                                    This is a mandatory variable
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">id</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    This is the the id that should be used in
                                <tt class="literal">modemtype</tt> variable from AT2
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">name</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    The name of this modem configuration. Used in
                                    logs
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">detect-string</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    String to use when trying to detect the modem.
                                    See <tt class="literal">detect-string2</tt>
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">detect-string2</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Second string to use to detect the modem. For example,
                                    if the modem replies with "SIEMENS MODEM M20", 
                                <tt class="literal">detect-string</tt> could be "SIEMENS" 
                                and <tt class="literal">detect-string2</tt> "M20"
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">init-string</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Optional initialization string. Defaults to
                                    "AT+CNMI=1,2,0,1,0"
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">speed</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Serial port hint speed to use. Optional. 
                                    Defaults to smsc group speed or autodetect
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">enable-hwhs</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Optional AT command to enable hardware handshake.
                                    Defaults to "AT+IFC=2,2"
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">hardware-flow-control</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Optionally disable hardware handshake on the computer side by setting it to false.
                                    Defaults to true.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">need-sleep</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Optional. Defaults to false. Some modems needs
                                    to sleep after opening the serial port and before
                                    first command
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">no-pin</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Optional. Defaults to false. If the modem doesn't
                                    support the PIN command, enable this
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">no-smsc</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Optional. Defaults to false. If the modem doesn't
                                    support setting the SMSC directly on the PDU, enable
                                    this. (Default is to include a "00" at the beginning
                                    of the PDU to say it's the default smsc, and remove
                                    the "00" when receiving)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sendline-sleep</tt></td>
                                <td><tt class="literal">number (milliseconds)</tt></td>
                                <td valign="bottom">
                                    Optional, defaults to 100 milliseconds. The sleep time
                                    after sending a AT command.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">keepalive-cmd</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Optional, defaults to "AT". If keepalive is activated
                                    in AT2 group, this is the command to be sent. If your
                                    modem supports it, for example, use "AT+CBC;+CSQ", and
                                    see in logs the reply "+CBC: 0,64" (0=On battery, 64% 
                                    full) and "+CSQ: 14,99" (0-31, 0-7: signal strength and
                                    channel bit error rate; 99 for unknown). See 3GPP 27007.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">message-storage</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Message storage memory type to enable for "SIM buffering".
                                    Possible values are: "SM" - SIM card memory or "ME" -
                                    Mobile equipment memory (may not be supported by your
                                    modem). check your modem's manual for more types.
                                    By default, if the option is not set, no message storage command
                                    will be sent to the modem and the modem's default message
                                    storage will be used (usually "SM").
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">message-start</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Optional integer, defaults to 1. Specifies starting index in
                                    SIM buffer for new SMS. Most modems start numbering from 1,
                                    however a few like the UMG181 start numbering from 0. This
                                    parameter ensures that all SMS are fetched when using
                                    "SIM buffering".
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">enable-mms</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Optional, defaults to false. If enabled, Kannel
                                    would send an AT+CMMS=2 if it have more than one
                                    message on queue and hopefully will be quicker
                                    sending the messages.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">reset-string</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Which reset string to execute when <tt class="literal">max-error-count</tt> reached.
                                Example for Falcom: AT+CFUN=1
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                        <p><span class="emphasis"><i class="emphasis">A note about delivery reports and GSM modems:</i></span>
                            while it is possible (and supported) to receive delivery reports on GSM 
                            modems, it may not work for you. if you encounter problems, check that your 
                            modem's init string (if not the default) is set to correctly allow the modem 
                            to send delivery reports using unsolicited notification (check your modem's 
                            manual). If the init-string is not set as si, some modems will store delivery 
                            reports to SIM memory, to get at which you will need to enable sim-buffering. 
                            finally your GSM network provider may not support delivery reports to mobile 
                            units.
                        </p>
                        <p><span class="emphasis"><i class="emphasis">About <tt class="literal">rawtcp</tt> mode:</i></span>
                            This mode allows you to use a GSM modem connected to a remote terminal server,
                            such as Perle IOLAN DS1 or a Cisco router with reverse telnet. The teminal
                            server should support raw TCP mode. The driver is not tested in telnet mode.
                            It is recommended to use <tt class="literal">keepalive</tt> variable, in order to 
                        automatically reconnect in case of network connectivity problems.
                        </p>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN2521">Modem initialization</a></h4>
                            <p>This question has been asked frequently in the users mailing list. 
                                It usually comes in two forms:
                            </p>
                            <p></p>
                            <ol type="1">
                                <li>
                                    <p>Modem doesn't receive or transmit SMS.</p>
                                    <p>In its current implementation, the at driver will panic if it
                                        cannot find the modem device and bearerbox won't start. This
                                        can happen either because the wrong modem device is configured
                                        or the device has no write access for kannel's user.
                                    </p>
                                    <p> In the first case use system logs to discover where is your
                                        modem assigned to:
                                    </p>
                                    <p>grep tty /var/log/messages</p>
                                    <p>Then verify that this is indeed your GSM modem device by
                                        connecting to it with minicom or wvdial and issuing a few AT
                                        commands. Wvdial is preferrable, since it can also give you a
                                        working <tt class="literal">init-string</tt>
                                </p>
                                <p>In the second case you need to give write access to kannel
                                    user. This is no problem if you run kannel as root, but it is
                                    not recommended to do so. In Ubuntu linux you just need to
                                    assign kannel user to group "dial". In other systems you can
                                    either:
                                </p>
                                <pre class="programlisting">chmod 666 /dev/modem</pre>
                                <p>or preferably:</p>
                                <pre class="programlisting">
chmod 664 /dev/modem
chgrp <span class="emphasis"><i class="emphasis">group</i></span> /dev/modem
usermod -G <span class="emphasis"><i class="emphasis">group</i></span> <span class="emphasis"><i class="emphasis">kannel-user</i></span>
                                </pre>
                                </li>
                                <li>
                                    <p>Modem doesn't receive DLRs or SMS.</p>
                                    <p>By default the modem doesn't know how to treat incoming
                                        messages. To tell it to send it to kannel you have to
                                        configure <tt class="literal">init-string</tt> with the <span class="emphasis"><i class="emphasis">
                                        +CNMI=x,x,x,x,x</i></span> command. X's are decimal numbers
                                and CNMI stands for Command New Message Indication. There is
                                no hard rule about its values. They are model and manufacturer
                                specific. Best to consult modem manual or manufacturer's web
                                site. Failing that, wvdialconf might give a working CNMI.
                                Finally see modems.conf for examples and try out different
                                values. Some Nokia phones do not support this command, but
                                are ready to transmit incoming messages from the start.
                                </p>
                                <p>Since this setting is modem specific, kannel cannot understand
                                    what it means from its value, and if using unconventional
                                    values you should tell kannel through <tt class="literal">sim-buffering
                                </tt> and <tt class="literal"> message-storage</tt>. In any
                                case it is useful to add +CMEE = 1 or 2 in the <tt class="literal">
                                    init-string</tt> in order to make the modem more verbose
                                in its responses.
                                </p>
                                <pre class="programlisting">
group = modems
init-string = "AT+CNMI=2,3,0,1,0;+CMEE=1"
message-storage = ME or SM    Depending on your modem, you may need to adjust it
...

group = smsc
smsc = at
sim-buffering = true          This will tell kannel to search for messages in
...                           the modem (either memory or its SIM)
                                </pre>
                                </li>
                            </ol>
                            <p></p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN2549">GSMA OneAPI v1.0 ParlayX SMS SOAP</a></h3>
                        <p>This implements the GSMA OneAPI v1.0 ParlayX SMS SOAP/XML interface
                            in two flavors, the Ericsson SDP (service delivery platform) ParlayX and
                            the GSMA OneAPI v1.0 SOAP interfaces.
                        </p>
                        <p>Example configuration for the Ericsson SDP variant:</p>
                        <pre class="programlisting">
group = smsc
smsc = parlayx
system-type = ericsson-sdp
port = 10000
connect-allow-ip = 10.11.12.13
send-url = http://host/location
dlr-url = http://our-host:10000/dlr-location
smsc-username = tester
smsc-password = foobar
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN2554"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">system-type (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Type of ParlayX connection. Currently supported are: 
                                    'oneapi-v1', 'ericsson-sdp'. 
                                    The variants have the same ParlayX SOAP XML PDUs, but differ in the
                                    authentication scheme they use, where 'ericsson-sdp' uses WS-Security 
                                    via wsse and 'oneapi-v1' uses plain HTTP basic authentication.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">port (m)</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    Port number in which Kannel listens to (MO and DLR) messages 
                                    from other SOAP service side.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">send-url (m)</tt></td>
                                <td><tt class="literal">url</tt></td>
                                <td valign="bottom">
                                    Location of the SOAP service to send MT messages.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dlr-url (m)</tt></td>
                                <td><tt class="literal">url</tt></td>
                                <td valign="bottom">
                                    Location of our side SOAP service for DLR notifications.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-username (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Username associated for the SOAP service connection.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-password (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Password associated for the SOAP service username.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">use-ssl</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Defines whether listen port should use SSL.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">connect-allow-ip</tt></td>
                                <td><tt class="literal">IP-list</tt></td>
                                <td valign="bottom">
                                    IPs allowed to use this SOAP service interface. If not set, 
                                    "127.0.0.1" (localhost) is the only host allowed to connect.
                                    Typically you will allow the IP of the other side SOAP service
                                    here.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">window</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Number of concurrent sending threads. If not set,
                                    one thread is used.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN2616">Fake SMSC</a></h3>
                        <p>Fake SMSC is a simple protocol to test out Kannel. It is not
                            a real SMS center, and cannot be used to send or receive SMS
                            messages from real phones. So, it is ONLY used for testing purposes.
                        </p>
                        <pre class="programlisting">
group = smsc
smsc = fake
port = 10000
connect-allow-ip = 127.0.0.1
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN2620"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">host (m)</tt></td>
                                <td><tt class="literal">hostname</tt></td>
                                <td valign="bottom">
                                    Machine that runs the SMSC. As IP (100.100.100.100) 
                                    or hostname (their.machine.here)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">port (m)</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    Port number in smsc host machine
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">connect-allow-ip</tt></td>
                                <td><tt class="literal">IP-list</tt></td>
                                <td valign="bottom">
                                    If set, only connections from these IP addresses are accepted.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN2646">HTTP-based relay and content gateways</a></h3>
                        <p>This special "SMSC" is used for HTTP based connections with
                            other gateways and various other relay services, when direct SMSC
                            is not available.
                        </p>
                        <pre class="programlisting">
group = smsc
smsc = http
system-type = kannel
smsc-username = nork
smsc-password = z0rK
port = 13015
send-url = "http://localhost:20022"
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN2650"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">system-type (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Type of HTTP connection. Currently supported are: 'kannel', 
                                    'brunet', 'xidris', 'wapme', 'clickatell' and 'generic'.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">send-url (m)</tt></td>
                                <td><tt class="literal">url</tt></td>
                                <td valign="bottom">
                                    Location to send MT messages. This URL is expanded by used
                                    system, if need to.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">no-sender</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Do not add variable sender to the send-url.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">no-coding</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Do not add variable coding to the send-url.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">no-sep</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Represent udh and text as a numeric string containing the hex-dump. For
                                    instance, text=%2b123 is represented as text=2b313233. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">port (m)</tt></td>
                                <td><tt class="literal">port-number</tt></td>
                                <td valign="bottom">
                                    Port number in which Kannel listens to (MO) messages from other
                                    gateway
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">use-ssl</tt></td>
                                <td><tt class="literal">boolean</tt></td>
                                <td valign="bottom">
                                    Defines whether listen port should use SSL.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">connect-allow-ip</tt></td>
                                <td><tt class="literal">IP-list</tt></td>
                                <td valign="bottom">
                                    IPs allowed to use this interface. If not set, "127.0.0.1"
                                    (localhost) is the only host allowed to connect.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-username</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Username associated to connection, if needed. Kannel requires
                                    this, and it is the same as send-sms username at other end.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-password</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Password for username, if needed.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">max-pending-submits</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional the maximum number of outstanding (i.e. acknowledged)
                                    requests. As a guideline it is recommended that no more than
                                    10 (default) requests are outstanding at any time.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN2724">The "generic" system-type</a></h4>
                            <p>For a generic HTTP-based relay, the system-type 'generic' can be used.
                                It can use the escape codes known from sms-service's get-url config
                                directives in the send-url string to indicate the HTTP API calling style of
                                the remote HTTP server, and the 3 HTTP body response parsing regular
                                expressions 'status-success-regex' for successfull acknowledge,
                                'status-permfail-regex' for permanent failure and 'status-tempfail-regex'
                                for temporary failure. It can also accomodate the incoming parameters and response
                                codes and text. This system-type has a lot of extra parameters that gives it a lot
                                of flexibility:
                            </p>
                            <div class="informaltable">
                                <p></p>
                                <a name="AEN2727"></a>
                                <table frame="void" class="CALSTABLE" border="0">
                                    <colgroup>
                                        <col>
                                        <col>
                                        <col>
                                    </colgroup>
                                    <thead>
                                        <tr>
                                            <th>Variable</th>
                                            <th>Value</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><tt class="literal">status-success-regex (o)</tt></td>
                                    <td><tt class="literal">POSIX regular expression</tt></td>
                                    <td valign="bottom">
                                        Regular expression to match against HTTP
                                        response body content, indicating a successful submission.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">status-permfail-regex (o)</tt></td>
                                    <td><tt class="literal">POSIX regular expression</tt></td>
                                    <td valign="bottom">
                                        Regular expression to match against HTTP
                                        response body content, indicating a permanent failure.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">status-tempfail-regex (o)</tt></td>
                                    <td><tt class="literal">POSIX regular expression</tt></td>
                                    <td valign="bottom">
                                        Regular expression to match against HTTP
                                        response body content, indicating a temporary failure.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-foreign-id-regex (o)</tt></td>
                                    <td><tt class="literal">POSIX regular expression</tt></td>
                                    <td valign="bottom">
                                        Regular expression to match against HTTP
                                        response body content to get the foreign message id
                                        in case of successful submission.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-username (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'username'
                                        field used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-password (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'password'
                                        field used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-from (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'from' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-to (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'to' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-text (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'text' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-udh (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'udh' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-service (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'service' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-account (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'account' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-binfo (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'binfo' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-dlr-mask (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'dlr-mask' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-dlr-err (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'dlr-err' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-dlr-url (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'dlr-url' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-dlr-mid (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'dlr-mid' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-flash (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'flash' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-mclass (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'mclass' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-mwi (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'mwi' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-coding (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'coding' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-validity (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'validity' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-deferred (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'deferred' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-foreign-id (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'foreign-id' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-param-meta-data (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the default parameter for the 'meta-data' field
                                        used on incoming requests.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-message-sent (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        It allows you to set the text returned when a succesful request is made.
                                        If not set, defaults to 'Sent.'. Note that you can use all sms service escapes
                                        here, see <a href="#escapecodes"><i>Parameters (Escape Codes)</i></a> for details.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-status-sent (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the HTTP status code returned when a successful
                                        request is made. If not set, defaults to 202 (HTTP_ACCEPTED).
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">generic-status-error (o)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Overrides the HTTP status code returned when a request is
                                        rejected for any reason. If not set, defaults to 202 (HTTP_ACCEPTED).
                                    </td>
                                    </tr>
                                    </tbody>
                                </table>
                                <p></p>
                            </div>
                            <p>An example for a 'generic' group looks like this:</p>
                            <pre class="programlisting">
group = smsc
smsc = http
system-type = generic
port = 13015
send-url = "http://www.foobar.com/mt.php?from=%P&amp;to=%p&amp;text=%b"
status-success-regex = "ok"
status-permfail-regex = "failure"
status-tempfail-regex = "retry later"
generic-foreign-id-regex = "&lt;id&gt;(.+)&lt;/id&gt;"
generic-param-from = "phoneNumber"
generic-param-to = "shortCode"
generic-message-sent = "Message sent with ID: %I"
generic-status-sent = 200
generic-status-error = 404
                            </pre>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN2906">Loopback SMSC (MT to MO direction switching)</a></h3>
                        <p>This special "SMSC" type can be used to route MT messages in
                            bearerbox internally as MO input messages again. Therefore this
                            tyoe is the MT wise counterpart of the 'reroute' functionality
                            of the smsc group when MOs are re-routed as MTs.
                        </p>
                        <pre class="programlisting">
group = smsc
smsc = loopback
smsc-id = loop1
reroute-smsc-id = my_id
                        </pre>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN2910"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">reroute-smsc-id (o)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Tag the rerouted MO with the given value for smsc-id 
                                    instead of the canonical smsc-id value of the smsc group 
                                    itself.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN2924">Using multiple SMS centers</a></h3>
                        <p>If you have several SMS center connections (multiple
                            operators or a number of GSM modems) you need to configure one smsc
                            group per SMS center (or GSM modem). When doing this, you might
                            want to use routing systems to rout messages to specific centers -
                            for example, you have 2 operator SMS centers, and the other is
                            much faster and cheaper to use.
                        </p>
                        <p>To set up routing systems, first give an unique ID for each
                            SMS center - or if you want to treat multiple ones completely
                            identical, give them identical ID. Then use 
                        <tt class="literal">preferred-smsc-id</tt> and
                        <tt class="literal">denied-smsc-id</tt> to set up the routing to your
                        taste. See also SMS PUSH settings ('sendsms-user' groups), below.
                        </p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN2930">Feature checklist</a></h3>
                        <p>Not all of Kannel's SMSC drivers support the same set of features.
                            This is because they were written at different times, and new features
                            are often only added to drivers that the feature author can test.
                        </p>
                        <p>The table in this section is an attempt to show exactly what
                            features to expect from a driver, and to help identify areas where
                            drivers need to be updated.  Currently most of the entries are
                            marked as "not tested" because the table is still new.
                        </p>
                        <div class="table">
                            <a name="AEN2934"></a>
                            <p><b>Table 7-2. SMSC driver features</b></p>
                            <table class="CALSTABLE" border="1">
                                <colgroup>
                                    <col title="first" align="center" width="1*">
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col title="last" width="1*">
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Feature</th>
                                        <th>cimd</th>
                                        <th>cimd2</th>
                                        <th>emi</th>
                                        <th>emi_x25</th>
                                        <th>smpp</th>
                                        <th>sema</th>
                                        <th>ois</th>
                                        <th>oisd</th>
                                        <th>at</th>
                                        <th>http</th>
                                        <th>fake</th>
                                        <th>smasi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="13">Can use DLR</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>y</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can set DCS<a name="fields-to-dcs" href="#FTN.fields-to-dcs"><span class="footnote">[a]</span></a></td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can set Alt-DCS</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can set Validity</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can set Deferred</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can set PID</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can set RPI</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can send Unicode</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can send 8 bits</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Correctly send GSM alphabet</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can set binfo / tariff class</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>n</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can use throttling</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>y</td>
                                    </tr>
                                </tbody>
                                <tbody>
                                    <tr>
                                        <td colspan="13">Notes:<br><a name="FTN.fields-to-dcs">a. </a>To use 
                                <tt class="literal">mclass</tt>, <tt class="literal">mwi</tt>, <tt class="literal">coding</tt>
                                and <tt class="literal">compress</tt> fields.<br>
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="table">
                            <a name="AEN3154"></a>
                            <p><b>Table 7-3. SMSC driver internal features</b></p>
                            <table class="CALSTABLE" border="1">
                                <colgroup>
                                    <col title="first" align="center" width="1*">
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col>
                                    <col title="last" width="1*">
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Feature</th>
                                        <th>cimd</th>
                                        <th>cimd2</th>
                                        <th>emi2</th>
                                        <th>emi_x25</th>
                                        <th>smpp</th>
                                        <th>sema</th>
                                        <th>ois</th>
                                        <th>oisd</th>
                                        <th>at</th>
                                        <th>http</th>
                                        <th>fake</th>
                                        <th>smasi</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="13">Can keep idle connections alive</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>?</td>
                                        <td>?</td>
                                        <td>y</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can send octet data without UDH</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>y</td>
                                        <td>y?</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>y?<a name="nomarkod" href="#FTN.nomarkod"><span class="footnote">[a]</span></a></td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can send octet data with UDH</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>N</td>
                                        <td>y?</td>
                                        <td>y</td>
                                        <td>y?</td>
                                        <td>y?</td>
                                        <td>n</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>y?</td>
                                        <td>y?<a href="#FTN.nomarkod"><span class="footnote">[a]</span></a></td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can send text messages with UDH</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>y</td>
                                        <td>y?</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>?</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can receive octet data without UDH</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y?<a name="AEN3253" href="#FTN.AEN3253"><span class="footnote">[b]</span></a></td>
                                        <td>y?</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can receive Unicode messages</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can receive octet data with UDH</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>N</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>y?</td>
                                        <td>y?</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Can receive text messages with UDH</td>
                                    </tr>
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>n</td>
                                        <td>y?</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>N</td>
                                        <td>y</td>
                                        <td>y</td>
                                        <td>n</td>
                                        <td>n</td>
                                        <td>?</td>
                                    </tr>
                                    <tr>
                                        <td colspan="13">Correctly encodes <tt class="literal">@</tt> when sending</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>y</td>
                                    <td>?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                    <td>y?</td>
                                    <td>y</td>
                                    <td>y</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                </tr>
                                <tr>
                                    <td colspan="13">Correctly encodes <tt class="literal">ï¿½</tt> when sending</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>y</td>
                                    <td>?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                    <td>y?</td>
                                    <td>y</td>
                                    <td>y</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                </tr>
                                <tr>
                                    <td colspan="13">Correctly encodes <tt class="literal">{</tt> when sending</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>n</td>
                                    <td>y?</td>
                                    <td>y</td>
                                    <td>?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                    <td>n</td>
                                    <td>y</td>
                                    <td>N<a name="AEN3359" href="#FTN.AEN3359"><span class="footnote">[c]</span></a></td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                </tr>
                                <tr>
                                    <td colspan="13">Can receive <tt class="literal">@</tt> in text messages</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>y</td>
                                    <td>?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                    <td>y?</td>
                                    <td>y</td>
                                    <td>y</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                </tr>
                                <tr>
                                    <td colspan="13">Can receive <tt class="literal">ï¿½</tt> in text messages</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>y</td>
                                    <td>?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                    <td>y?</td>
                                    <td>y</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                </tr>
                                <tr>
                                    <td colspan="13">Can receive <tt class="literal">{</tt> in text messages</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>n</td>
                                    <td>y?</td>
                                    <td>y</td>
                                    <td>?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                    <td>n</td>
                                    <td>y</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>y?</td>
                                    <td>?</td>
                                </tr>
                                <tr>
                                    <td colspan="13">Can shut down idle connections</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>n</td>
                                    <td>n</td>
                                    <td>y</td>
                                    <td>n</td>
                                    <td>n</td>
                                    <td>?</td>
                                    <td>?</td>
                                    <td>n</td>
                                    <td>?</td>
                                    <td>?</td>
                                    <td>?</td>
                                    <td>?</td>
                                </tr>
                                </tbody>
                                <tbody>
                                    <tr>
                                        <td colspan="13">Notes:<br><a name="FTN.nomarkod">a. </a>Does not mark it as octet data<br><a name="FTN.AEN3253">b. </a>However, it looks like the <tt class="literal">sema</tt> driver can't receive <span class="emphasis"><i class="emphasis">text</i></span> data.<br><a name="FTN.AEN3359">c. </a>Miscalculates message length<br></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN3431"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col align="left" width="1*">
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Symbol</th>
                                        <th>Meaning</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>?</td>
                                        <td>not yet investigated</td>
                                    </tr>
                                    <tr>
                                        <td>y</td>
                                        <td>driver has this feature, and it has been tested</td>
                                    </tr>
                                    <tr>
                                        <td>y?</td>
                                        <td>driver probably has this feature, has not been tested</td>
                                    </tr>
                                    <tr>
                                        <td>n</td>
                                        <td>driver does not have this feature</td>
                                    </tr>
                                    <tr>
                                        <td>N</td>
                                        <td>driver claims to have this feature but it doesn't work</td>
                                    </tr>
                                    <tr>
                                        <td>-</td>
                                        <td>feature is not applicable for this driver</td>
                                    </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN3457">External delivery report (DLR) storage</a></h2>
                    <p>Delivery reports are supported by default internally, which
                        means all DLRs are stored in the memory of the bearerbox process.
                        This is problematic if bearerbox crashes or you take the process
                        down in a controlled way, but there are still DLRs open. Therefore
                        you may use external DLR storage places, i.e. a MySQL database.
                    </p>
                    <p>Following are the supported DLR storage types and how to use
                        them:
                    </p>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3461">Internal DLR storage</a></h3>
                        <p>This is the default way in handling DLRs and does not
                            require any special configuration. In order to configure bearerbox
                            to use internal DLR storage use <tt class="literal">dlr-storage = internal</tt>
                        in the <tt class="literal">core</tt> group.
                        </p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3466">MySQL DLR storage</a></h3>
                        <p>To store DLR information into a MySQL database you may use the
                        <tt class="literal">dlr-storage = mysql</tt> configuration directive in the
                        <tt class="literal">core</tt> group.
                        </p>
                        <p>In addition to that you must have a <tt class="literal">dlr-db</tt>
                        group defined that specifies the table field names that are used to the
                        DLR attributes and a <tt class="literal">mysql-connection</tt> group that
                        defines the connection to the MySQL server itself.
                        </p>
                        <p>Here is the example configuration from
                        <tt class="literal">doc/examples/dlr-mysql.conf</tt>:
                        </p>
                        <pre class="programlisting">
group = mysql-connection
id = mydlr
host = localhost
username = foo
password = bar
database = dlr
max-connections = 1

group = dlr-db
id = mydlr
table = dlr
field-smsc = smsc
field-timestamp = ts
field-destination = destination
field-source = source
field-service = service
field-url = url
field-mask = mask
field-status = status
field-boxc-id = boxc
                        </pre>
                        <p></p>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN3477">MySQL connection configuration</a></h4>
                            <p>For several reasons external storage may be required to 
                                handle dynamical issues, i.e. DLRs, sms-service, sendsms-user, 
                                ota-setting, ota-bookmark definitions and so on. To define a 
                                MySQL database connection you simple need to specify a
                            <tt class="literal">mysql-connection</tt> group as follows:
                            </p>
                            <div class="table">
                                <a name="AEN3481"></a>
                                <p><b>Table 7-4. MySQL Connection Group Variables</b></p>
                                <table frame="void" class="CALSTABLE" border="0">
                                    <colgroup>
                                        <col>
                                        <col>
                                        <col>
                                    </colgroup>
                                    <thead>
                                        <tr>
                                            <th>Variable</th>
                                            <th>Value</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><tt class="literal">group</tt></td>
                                    <td><tt class="literal">mysql-connection</tt></td>
                                    <td valign="bottom">
                                        This is a mandatory variable
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">id (m)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        An optional name or id to identify this MySQL connection
                                        for internal reference with other MySQL related configuration
                                        groups. Any string is acceptable, but semicolon ';' may cause
                                        problems, so avoid it and any other special non-alphabet characters.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">host (m)</tt></td>
                                    <td>hostname or IP</td>
                                    <td valign="bottom">
                                        Hostname or IP of a server running a MySQL database to connect to.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">username (m)</tt></td>
                                    <td>username</td>
                                    <td valign="bottom">
                                        User name for connecting to MySQL database.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">password (m)</tt></td>
                                    <td>password</td>
                                    <td valign="bottom">
                                        Password for connecting to MySQL database.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">database (m)</tt></td>
                                    <td>string</td>
                                    <td valign="bottom">
                                        Name of database in MySQL database server to connect to.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">max-connections</tt></td>
                                    <td>integer</td>
                                    <td valign="bottom">
                                        How many connections should be opened to the given database.
                                        This is used for database pool.
                                    </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <p>A sample 'mysql-connection' group:
                            </p>
                            <pre class="programlisting">
group = mysql-connection
id = dlr-db
host = localhost
username = foo
password = bar
database = dlr
max-connections = 1
                            </pre>
                            <p></p>
                            <p>In case you use different MySQL connections for several storage
                                issues, i.e. one for DLR and another different one for sms-service you
                                may use the <tt class="literal">include</tt> configuration statement to extract
                            the MySQL related configuration groups to a separate <tt class="literal">mysql.conf
                            </tt> file.
                            </p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3532">LibSDB DLR storage</a></h3>
                        <p>To store DLR information into a LibSDB resource (which is an
                            abstraction	of a real database) you may use the
                        <tt class="literal">dlr-storage = sdb</tt> configuration directive in the
                        <tt class="literal">core</tt> group.
                        </p>
                        <p>In addition to that you must have a <tt class="literal">dlr-db</tt>
                        group defined that specifies the table field names that are used to the
                        DLR attributes and a <tt class="literal">sdb-connection</tt> group that
                        defines the LibSDB resource itself.
                        </p>
                        <p>Here is the example configuration from
                        <tt class="literal">doc/examples/dlr-sdb.conf</tt> using a PostgreSQL resource:
                        </p>
                        <pre class="programlisting">
group = sdb-connection
id = pgdlr
url = "postgres:host=localhost:db=myapp:port=1234"
max-connections = 1

group = dlr-db
id = pgdlr
table = dlr
field-smsc = smsc
field-timestamp = ts
field-destination = destination
field-source = source
field-service = service
field-url = url
field-mask = mask
field-status = status
field-boxc-id = boxc
                        </pre>
                        <p></p>
                        <p>Beware that you have the DB support build in your LibSDB
                            installation when trying to use a specific DB type within the URL.
                        </p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3544">Oracle 8i/9i DLR storage</a></h3>
                        <p>To store DLR information into a Oracle database you may use the
                        <tt class="literal">dlr-storage = oracle</tt> configuration directive in the
                        <tt class="literal">core</tt> group.
                        </p>
                        <p>In addition to that you must have a <tt class="literal">dlr-db</tt>
                        group defined that specifies the table field names that are used to the
                        DLR attributes and a <tt class="literal">oracle-connection</tt> group that
                        defines the connection to the Oracle server itself.
                        </p>
                        <p>Here is the example configuration from
                        <tt class="literal">doc/examples/dlr-oracle.conf</tt>:
                        </p>
                        <pre class="programlisting">
group = oracle-connection
id = mydlr
username = foo
password = bar
tnsname = dlr
max-connections = 1

group = dlr-db
id = mydlr
table = dlr
field-smsc = smsc
field-timestamp = ts
field-destination = destination
field-source = source
field-service = service
field-url = url
field-mask = mask
field-status = status
field-boxc-id = boxc
                        </pre>
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3555">PostgreSQL DLR storage</a></h3>
                        <p>To store DLR information into a PostgreSQL database you may use the
                        <tt class="literal">dlr-storage = pgsql</tt> configuration directive in the
                        <tt class="literal">core</tt> group.
                        </p>
                        <p>In addition to that you must have a <tt class="literal">dlr-db</tt>
                        group defined that specifies the table field names that are used to the
                        DLR attributes and a <tt class="literal">pgsql-connection</tt> group that
                        defines the connection to the PostgreSQL server itself.
                        </p>
                        <p>Here is the example configuration:
                        </p>
                        <pre class="programlisting">
group = pgsql-connection
id = mydlr
host = myhost.com
username = foo
password = bar
database = dlr
max-connections = 1

group = dlr-db
id = mydlr
table = dlr
field-smsc = smsc
field-timestamp = ts
field-destination = destination
field-source = source
field-service = service
field-url = url
field-mask = mask
field-status = status
field-boxc-id = boxc
                        </pre>
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3565">MS-SQL/Sybase DLR storage</a></h3>
                        <p>To store DLR information into a MS-SQL or Sybase (via FreeTDS)
                            database you may use the <tt class="literal">dlr-storage = mssql</tt>
                        configuration directive in the <tt class="literal">core</tt> group.
                        </p>
                        <p>In addition to that you must have a <tt class="literal">dlr-db</tt>
                        group defined that specifies the table field names that are used to the
                        DLR attributes and a <tt class="literal">mssql-connection</tt> group that
                        defines the connection to the MS-SQL or Sybase server itself.
                        </p>
                        <p>Please note that the <tt class="literal">server</tt> configuration directive
                        must match the corresponding <tt class="literal">[section]</tt> on
                        <tt class="literal">freetds.conf</tt>
                        </p>
                        <p>Here is the example configuration:
                        </p>
                        <pre class="programlisting">
group = mssql-connection
id = msdlr
server = myservername
username = foo
password = bar
database = dlr
max-connections = 1

group = dlr-db
id = msdlr
table = dlr
field-smsc = smsc
field-timestamp = ts
field-destination = destination
field-source = source
field-service = service
field-url = url
field-mask = mask
field-status = status
field-boxc-id = boxc
                        </pre>
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3579">SQLite3 DLR storage</a></h3>
                        <p>To store DLR information into a SQLite3 database you may use the
                        <tt class="literal">dlr-storage = sqlite3</tt> configuration directive in the
                        <tt class="literal">core</tt> group.
                        </p>
                        <p>In addition to that you must have a <tt class="literal">dlr-db</tt>
                        group defined that specifies the table field names that are used to the
                        DLR attributes and a <tt class="literal">sqlite3-connection</tt> group that
                        defines the connection to the SQLite3 database itself.
                        </p>
                        <p>Here is the example configuration:
                        </p>
                        <pre class="programlisting">
group = sqlite3-connection
id = mydlr
database = /path/to/file
max-connections = 1

group = dlr-db
id = mydlr
table = dlr
field-smsc = smsc
field-timestamp = ts
field-destination = destination
field-source = source
field-service = service
field-url = url
field-mask = mask
field-status = status
field-boxc-id = boxc
                        </pre>
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3589">Redis DLR storage</a></h3>
                        <p>To store DLR information using the Redis (http://www.redis.io) keystore, you should set the
                        <tt class="literal">dlr-storage = redis</tt> configuration directive in the
                        <tt class="literal">core</tt> group.
                        </p>
                        <p>In addition, you must have a <tt class="literal">dlr-db</tt> group defined that specifies 
                        the key and hash field names that are used to store the DLR attributes and a 
                        <tt class="literal">redis-connection</tt> group that defines the connection to the Redis server.
                        </p>
                        <p>
                            Since Redis is a keystore and not a SQL database, keys and not tables are used to store 
                            DLR attributes. For ease of configuration, the same configuration parameters in the <tt class="literal">dlr-db</tt> 
                        group that are used to define SQL tables in other DLR storage engines are used to configure
                        key names in Redis. DLRs are stored as Redis hash keys with a separate key 
                        for each DLR. Key names are in the format 
                        <tt class="literal">&lt;table&gt;:&lt;smsc&gt;:&lt;timestamp&gt;</tt>. Some SMSCs also append the 
                        destination to the DLR keyname resulting DLR keynames in the format 
                        <tt class="literal">&lt;table&gt;:&lt;smsc&gt;:&lt;timestamp&gt;:&lt;destination&gt;</tt>. You can
                        specify the <tt class="literal">&lt;table&gt;</tt> portion of the keyname by specifying the
                        <tt class="literal">table</tt> value in the <tt class="literal">dlr-db</tt> group.
                        </p>
                        <p>
                            In addition to one key per DLR, an additional key with a name in the format
                        <tt class="literal">&lt;table&gt;:Count</tt> is created to maintain a count of the total
                        number of outstanding DLRs.
                        </p>
                        <p>Here is the example configuration from
                        <tt class="literal">doc/examples/dlr-redis.conf</tt>:
                        </p>
                        <pre class="programlisting">
                group = redis-connection
                id = mydlr
                host = localhost
                port = 6379
                #password = foo
                database = 2
                idle-timeout = 3600
                max-connections = 1
                
                group = dlr-db
                id = mydlr
                ttl = 604800
                table = dlr
                field-smsc = smsc
                field-timestamp = ts
                field-destination = destination
                field-source = source
                field-service = service
                field-url = url
                field-mask = mask
                field-status = status
                field-boxc-id = boxc
                        </pre>
                        <p></p>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN3609">Redis connection configuration</a></h4>
                            <p>To define a Redis connection you need to specify a
                            <tt class="literal">redis-connection</tt> group as follows:
                            </p>
                            <div class="table">
                                <a name="AEN3613"></a>
                                <p><b>Table 7-5. Redis Connection Group Variables</b></p>
                                <table frame="void" class="CALSTABLE" border="0">
                                    <colgroup>
                                        <col>
                                        <col>
                                        <col>
                                    </colgroup>
                                    <thead>
                                        <tr>
                                            <th>Variable</th>
                                            <th>Value</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><tt class="literal">group</tt></td>
                                    <td><tt class="literal">redis-connection</tt></td>
                                    <td valign="bottom">
                                        This is a mandatory variable
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">id (m)</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        An optional name or id to identify this Redis connection
                                        for internal reference with other Redis related configuration
                                        groups. Any string is acceptable, but semicolon ';' may cause
                                        problems, so avoid it and any other special non-alphabet characters.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">host (m)</tt></td>
                                    <td>hostname or IP</td>
                                    <td valign="bottom">
                                        Hostname or IP of a server running Redis to connect to.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">password</tt></td>
                                    <td>password</td>
                                    <td valign="bottom">
                                        If the Redis server is secured with a password in redis.conf, it must be 
                                        specified here. By default, Redis servers are unsecured and in that case,
                                        this parameter may be ommitted.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">database</tt></td>
                                    <td>integer</td>
                                    <td valign="bottom">
                                        The numeric ID (0-15) of the Redis database to use. Ideally this database
                                        should be dedicated to storing Redis DLRs since a separate key wil be created
                                        for each DLR. If this variable is ommitted, the default database (0) will be used.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">idle-timeout</tt></td>
                                    <td>integer</td>
                                    <td valign="bottom">
                                        The number of seconds that Redis should hold the connection open without any
                                        traffic. Some Redis servers are configured to disconnect idle clients very
                                        quickly, and if this is the case you should set this value to something more
                                        reasonable. If ommitted, the Redis server-wide timeout from redis.conf will 
                                        apply.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">max-connections</tt></td>
                                    <td>integer</td>
                                    <td valign="bottom">
                                        How many connections should be opened to the Redis server.
                                    </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3659">DLR database field configuration</a></h3>
                        <p>For external database storage of DLR information in relational
                            database management systems (RDBMS) you will have to specify which table
                            field are used to represent the stored data. This is done via the
                        <tt class="literal">dlr-db</tt> group as follows:
                        </p>
                        <div class="table">
                            <a name="AEN3663"></a>
                            <p><b>Table 7-6. DLR Database Field Configuration Group Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group</tt></td>
                                <td><tt class="literal">dlr-db</tt></td>
                                <td valign="bottom">
                                    This is a mandatory variable
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">id (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    An id to identify which external connection should be used for
                                    DLR storage. Any string is acceptable, but semicolon ';' may cause
                                    problems, so avoid it and any other special non-alphabet characters.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">table (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The name of the table that is used to store the DLR information.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">field-smsc (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The table field that is used for the smsc data.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">field-timestamp (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The table field that is used for the timestamp data.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">field-destination (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The table field that is used for the destination number data.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">field-source (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The table field that is used for the source number data.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">field-service (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The table field that is used for the service username data.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">field-url (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The table field that is used for the DLR URL which is triggered
                                    when the DLR for this message arrives from the SMSC.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">field-mask (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The table field that is used for the DLR mask that has been set
                                    for a message.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">field-status (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The table field that is used to reflect the status of the DLR
                                    for a specific message.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">field-boxc-id (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The table field that is used to store the smsbox connection id
                                    that has passed the message for delivery. This is required in 
                                    cases you want to guarantee that DLR messages are routed back to
                                    the same smsbox conn instance. This is done via the smsbox routing.
                                    If you don't use smsbox routing simply add this field to your
                                    database table and keep it empty.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <p>A sample 'dlr-db' group:
                        </p>
                        <pre class="programlisting">
group = dlr-db
id = dlr-db
table = dlr
field-smsc = smsc
field-timestamp = ts
field-source = source
field-destination = destination
field-service = service
field-url = url
field-mask = mask
field-status = status
field-boxc-id = boxc
                        </pre>
                        <p></p>
                        <p>Beware that all variables in this group are mandatory, so you
                            have to specify all fields to enable bearerbox to know how to store
                            and retrieve the DLR information from the external storage spaces.
                        </p>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN3737">SMSBox configuration</a></h2>
                    <div class="sect2">
                        <h3 class="sect2"><a name="AEN3739">Smsbox group</a></h3>
                        <p>You must define an 'smsbox' group into the configuration file to be
                            able to use SMS Kannel. The simplest working 'smsbox' group looks 
                            like this:
                        </p>
                        <pre class="programlisting">
group = smsbox
bearerbox-host = localhost
                        </pre>
                        ...but you would most probably want to define 'sendsms-port' to be
                        able to use SMS push.
                        <p></p>
                        <p>SMSBox inherits from core the following fields:
                        </p>
                        <pre class="programlisting">
smsbox-port
http-proxy-port
http-proxy-host
http-proxy-username
http-proxy-password
http-proxy-exceptions
http-proxy-exceptions-regex
ssl-certkey-file
                        </pre>
                        <p></p>
                        <div class="table">
                            <a name="AEN3745"></a>
                            <p><b>Table 7-7. Smsbox Group Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group (m)</tt></td>
                                <td><tt class="literal">smsbox</tt></td>
                                <td valign="bottom">
                                    This is a mandatory variable
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">bearerbox-host (m)</tt></td>
                                <td><tt class="literal">hostname</tt></td>
                                <td valign="bottom">
                                    The machine in which the bearerbox is. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">bearerbox-port (o)</tt></td>
                                <td>port-number</td>
                                <td valign="bottom">
                                    This is the port number to which smsbox will connect bearerbox.
                                    If not given <tt class="literal">smsbox-port</tt> from core group used.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">bearerbox-port-ssl (o)</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    If set to true, the smsbox connection will be SSL-enabled.
                                    Your smsbox will connect using SSL to the bearerbox
                                    then. This is used to secure communication between bearerbox
                                    and smsboxes in case they are in separate networks operated and
                                    the TCP communication is not secured on a lower network layer.
                                    If not given <tt class="literal">smsbox-port-ssl</tt> from core group used.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsbox-id (o)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Optional smsbox instance identifier. This is used to 
                                    identify an smsbox connected to an bearerbox for the purpose
                                    of having smsbox specific routing inside bearerbox. So if you
                                    you own boxes that do pass messages into bearerbox for delivery
                                    you may want that answers to those are routed back to your 
                                    specific smsbox instance, i.e. SMPP or EMI proxying boxes.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sendsms-interface (o)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    If this is set, the sendsms HTTP interface will only bind
                                    to a specified address. For example: "127.0.0.1".
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sendsms-port (c)</tt></td>
                                <td>port-number</td>
                                <td valign="bottom">
                                    The port in which any sendsms HTTP requests are done. As with
                                    other ports in Kannel, can be set as anything desired.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sendsms-port-ssl (o)</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    If set to true, the sendsms HTTP interface will use a
                                    SSL-enabled HTTP server with the specified 
                                    ssl-server-cert-file and ssl-server-key-file from the 
                                    core group. Defaults to "no".
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sendsms-url (o)</tt></td>
                                <td>url</td>
                                <td valign="bottom">
                                    URL locating the sendsms service. Defaults to <tt class="literal">
                                    /cgi-bin/sendsms</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sendota-url (o)</tt></td>
                                <td>url</td>
                                <td valign="bottom">
                                    URL locating the sendota service. Defaults to <tt class="literal">
                                    /cgi-bin/sendota</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">immediate-sendsms-reply (o)</tt></td>
                                <td>boolean</td>
                                <td valign="bottom">
                                    This is a backward compatibility flag: when set, Kannel will 
                                    immediately answer to any sendsms requests, without knowing if
                                    the bearerbox will ever accept the message. If set to false
                                    (default), smsbox will not reply to HTTP request until the bearerbox
                                    has received the message.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sendsms-chars</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Only these characters are allowed in 'to' field when send-SMS
                                    service is requested via HTTP. Naturally, you should allow 
                                    at least <tt class="literal">0123456789</tt>. The
                                <span class="emphasis"><i class="emphasis">space</i></span> character (' ') has special
                                meaning: it is used to separate multiple phone numbers from
                                each other in multi-send. To disable this feature, do not have
                                it as an accepted character. If this variable is
                                not set, the default set <tt class="literal">"0123456789ï¿½+-"</tt> is used.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">global-sender</tt></td>
                                <td>phone-number</td>
                                <td valign="bottom">
                                    If set, all sendsms originators are set as these before
                                    proceeding. Note that in a case of most SMS centers you
                                    cannot set the sender number, but it is automatically set
                                    as the number of SMSC
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">log-file</tt></td>
                                <td>filename</td>
                                <td rowspan="3" valign="bottom">
                                    As with the bearerbox 'core' group. Access-log is used to store
                                    information about MO and send-sms requests. Can be named same as the 
                                    'main' access-log (in 'core' group).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">log-level</tt></td>
                                <td>number 0..5</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">access-log</tt></td>
                                <td>filename</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">syslog-level</tt></td>
                                <td>number</td>
                                <td valign="bottom">
                                    Messages of this log level or higher will also be
                                    sent to syslog, the UNIX system log daemon. If not explicitly
                                    set with <tt class="literal">syslog-facility</tt>, it logs under the
                                'daemon' category. The default is not to use syslog, and you can
                                set that explicitly by setting <tt class="literal">syslog-level</tt>
                                to 'none'.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">syslog-facility</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    The syslog facility to send the syslog entries to. The
                                    default is 'daemon'.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">white-list</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    Load a list of accepted destinations of SMS messages. If a 
                                    destination of an SMS message is not in this list, any message 
                                    received from the HTTP interface is rejected. See notes of phone 
                                    number format from numhash.h header file. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">black-list</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    As white-list, but SMS messages to these numbers are
                                    automatically discarded
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">reply-couldnotfetch</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    If set, replaces the SMS message sent back to user when Kannel
                                    could not fetch content. 
                                    Defaults to <tt class="literal">Could not fetch content, sorry.</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">reply-couldnotrepresent</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    If set, replaces the SMS message sent back when Kannel could not 
                                    represent the result as a SMS message. 
                                    Defaults to <tt class="literal">Result could not be represented as an 
                                    SMS message.</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">reply-requestfailed</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    If set, replaces the SMS message sent back when Kannel could not 
                                    contact http service.
                                    Defaults to <tt class="literal">Request Failed</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">reply-emptymessage</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    If set, replaces the SMS message sent back when message is
                                    empty. Set to "" to enable empty messages.
                                    Defaults to <tt class="literal">&lt;Empty reply from service provider&gt;</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">mo-recode</tt></td>
                                <td>boolean</td>
                                <td valign="bottom">
                                    If enabled, Kannel will try to convert received messages with UCS-2 charset
                                    to WINDOWS-1252 or to UTF-8, simplifying external servers jobs. If Kannel is 
                                    able to recode message, it will also change <tt class="literal">coding</tt> to 
                                <tt class="literal">7 bits</tt> and <tt class="literal">charset</tt> to 
                                <tt class="literal">windows-1252</tt> or to <tt class="literal">utf-8</tt>. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-request-retry</tt></td>
                                <td>integer</td>
                                <td valign="bottom">
                                    If set, specifies how many retries should be performed for failing
                                    HTTP requests of sms-services. Defaults to 0, which means no retries
                                    should be performed and hence no HTTP request queuing is done.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-queue-delay</tt></td>
                                <td>integer</td>
                                <td valign="bottom">
                                    If set, specifies how many seconds should pass within the HTTP queuing
                                    thread for retrying a failed HTTP request. Defaults to 10 sec. and is
                                    only obeyed if <tt class="literal">http-request-retry</tt> is set to a 
                                non-zero value.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">white-list-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    Defines the set of accepted destinations of SMS messages. If a 
                                    destination of an SMS message is not in this set, any message 
                                    received from the HTTP interface is rejected. 
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">black-list-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    As white-list-regex, but SMS messages to numbers within in this set are
                                    automatically discarded.
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">max-pending-requests</tt></td>
                                <td>number of messages</td>
                                <td valign="bottom">
                                    Maximum number of pending MO or DLR messages that are handled in parallel.
                                    (Default: 512)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">http-timeout</tt></td>
                                <td>seconds</td>
                                <td valign="bottom">
                                    Sets socket timeout in seconds for outgoing client http
                                    connections. Optional. Defaults to 240 seconds.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">sms-length</tt></td>
                                <td>number</td>
                                <td valign="bottom">
                                    Maximum allowed number of characters for a single SMS in smsbox.
                                    If this maximum exceeds Kannel will split SMS into multiparts.
                                    Default: 140
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <p>A typical 'smsbox' group could be something like this:
                        </p>
                        <pre class="programlisting">
group = smsbox
bearerbox-host = localhost
sendsms-port = 13131
sendsms-chars = "0123456789 "
global-sender = 123456
access-log = "kannel.access"
log-file = "smsbox.log"
log-level = 0
                        </pre>
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3937">Smsbox routing inside bearerbox</a></h3>
                        <p>The communication link between bearerbox and smsbox has been
                            designed for the purpose of load-balancing via random assignment. 
                            Which means, bearerbox holds all smsc connections and passes inbound
                            message to one of the connected smsboxes. So you have a determined route
                            for outbound messages, but no determined route for inbound messages.
                        </p>
                        <p>The smsbox routing solves this for the inbound direction. In
                            certain scenarios you want that bearerbox to know to which smsbox
                            instance it should pass messages. I.e. if you implement own boxes
                            that pass messages to bearerbox and expect to receive messages defined
                            on certain rules, like receiver number or smsc-id. This is the case
                            for EMI/UCP and SMPP proxies that can be written easily using smsbox
                            routing facility.
                        </p>
                        <p>If you box handles the SMPP server specific communication to your
                            EMSEs, and if an client send a submit_sm PDU, the box would transform
                            the message into Kannel message representation and inject the message to
                            bearerbox as if it would be an smsbox. As you want to assign your clients
                            shortcodes for certain networks or route any inbound traffic from a certain
                            smsc link connected to bearerbox, you need to separate in the scope of 
                            bearerbox where the inbound message will be going to. An example may
                            look like this:
                        </p>
                        <pre class="programlisting">
group = smsbox
...
smsbox-id = mysmsc
...

group = smsbox-route
smsbox-id = mysmsc
shortcode = "1111;2222;3333"
                        </pre>
                        Which means any inbound message with receiver number 1111, 2222 or 3333
                        will be delivered to the smsbox instance that has identified itself
                        via the id "mysmsc" to bearerbox. Using this routing the smsbox instance
                        (which may be an EMI/UCP or SMPP proxy) is able to send a deliver_sm PDU. 
                        Another example showing the combination use of criteria smsc-id and 
                        shortcode looks like this:
                        <pre class="programlisting">
group = smsbox
...
smsbox-id = mysmsc
...

group = smsbox-route
smsbox-id = mysmsc
smsc-id = "A;B;C"
shortcode = "1111;2222"
                        </pre>
                        Which means any inbound message with receiver number 1111 or 2222 that have
                        been originating from the smsc-id connections A, B or C will be delivered
                        to the via the id "mysmsc" to bearerbox.
                        <p></p>
                        <p>smsbox-route inherits from core the following fields:
                        </p>
                        <div class="table">
                            <a name="AEN3945"></a>
                            <p><b>Table 7-8. Smsbox-route Group Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group (m)</tt></td>
                                <td><tt class="literal">smsbox-route</tt></td>
                                <td valign="bottom">
                                    This is a mandatory variable
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsbox-id (m)</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Defines for which smsbox instance the routing rules do apply.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc-id</tt></td>
                                <td>word-list</td>
                                <td valign="bottom">
                                    If set, specifies from which smsc-ids all inbound messages should
                                    be routed to this smsbox instance. List contains smsc-ids separated
                                    by semicolon (";"). This rule may be used to pull any smsc specific
                                    message stream to an smsbox instance. If used in combination with 
                                    config directive shortcode, then this is another matching criteria
                                    for the routing decission.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">shortcode</tt></td>
                                <td>number-list</td>
                                <td valign="bottom">
                                    If set, specifies which receiver numbers for inbound messages should
                                    be routed to this smsbox instance. List contains numbers separated
                                    by semicolon (";"). This rule may be used to pull receiver number
                                    specific message streams to an smsbox instance. If used in combination
                                    with config directive smsc-id, then only messages originating from
                                    the connections in the smsc-id are matched against the shortcode list.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN3976">SMS-service configurations</a></h3>
                        <p>Now that you have an SMS center connection to send and
                            receive SMS messages you need to define services for incoming
                            messages. This is done via 'sms-service' configuration
                            groups.
                        </p>
                        <p>These groups define SMS services in the smsbox, so they are only
                            used by the smsbox. Each service is recognized from the first word
                            in an SMS message and by the number of arguments accepted by the
                            service configuration (unless <tt class="literal">catch-all</tt>
                        configuration variable is used).  By adding a username and password in the URL
                        in the following manner
                        "http://luser:password@host.domain:port/path?query" we can perform
                        HTTP Basic authentication.
                        </p>
                        <p>The simplest service group looks like this:
                        </p>
                        <pre class="programlisting">
group = sms-service
keyword = www
get-url = "http://%S"
                        </pre>
                        This service grabs any SMS with two words and 'www' as the first
                        word, and then does an HTTP request to an URL which is taken from
                        the rest of the message. Any result is sent back to the phone
                        (or requester), but is truncated to the 160 characters that will
                        fit into an SMS message, naturally.
                        <p></p>
                        <p>Service group <tt class="literal">default</tt> has a special
                        meaning: if the incoming message is not routed to any other
                        service, <tt class="literal">default</tt> 'sms-service' group is used.
                        You should always define <tt class="literal">default</tt> service.
                        </p>
                        <p>Service group <tt class="literal">black-list</tt> has a special
                        meaning: if the incoming message is in service's black-list, this
                        service is used to reply to user. If unset, message will be 
                        discarded.
                        </p>
                        <div class="table">
                            <a name="AEN3989"></a>
                            <p><b>Table 7-9. SMS-Service Group Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group (m)</tt></td>
                                <td><tt class="literal">sms-service</tt></td>
                                <td valign="bottom">
                                    This is a mandatory variable
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">keyword (m)</tt></td>
                                <td>word</td>
                                <td valign="bottom">
                                    Services are identified by the first word in the SMS. Each
                                    `%s' in the URL corresponds to one word in the SMS message.
                                    Words are separated with spaces. A keyword is matched only if
                                    the number of words in the SMS message is the same as the
                                    number of `%s' fields in the URL. This allows you to
                                    configure the gateway to use different URLs for the same
                                    keyword depending on the number of words the SMS message
                                    contains. The keyword is case insensitive, which means you don't
                                    have to use aliases to handle different cased versions of your keyword.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">keyword-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    This field may be used to enable service-selection based on a regular expression.
                                    You can define either keyword or keyword-regex in configuration, but not both in
                                    the same sms-service. keyword-regex is case sensitive.
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">aliases</tt></td>
                                <td>word-list</td>
                                <td valign="bottom">
                                    If the service has aliases, they are listed as a list with 
                                    each entry separated with a semicolon (';'). Aliases are case
                                    insensitive just like keyword.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">name</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Optional name to identify the service in logs. If unset,
                                <tt class="literal">keyword</tt> is used.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">get-url (c)</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    Requested URL. The url can include a list of parameters, which are
                                    parsed before the url is fetched. See below for these
                                    parameters. Also works with plain 'url'
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">post-url (c)</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    Requested URL. As above, but request is done as POST, not GET.
                                    Always matches the keyword, regardless of pattern matching.
                                    See notes on POST other where.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">post-xml (c)</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    Requested URL. As above, but request is done as XML POST.
                                    Always matches the keyword, regardless of pattern matching.
                                    See notes on POST other where and <a href="#postxml"><i>XML Post</i></a>
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">file (c)</tt></td>
                                <td>filename</td>
                                <td valign="bottom">
                                    File read from a local disc. Use this variable only if no
                                <tt class="literal">url</tt> is set. All escape codes (parameters)
                                in <tt class="literal">url</tt> are supported in filename. 
                                The last character of the file (usually linefeed) is removed.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">text (c)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Predefined text answer. Only if there is neither <tt class="literal">url</tt> nor 
                                <tt class="literal">file</tt> set. Escape codes (parameters) are
                                usable here, too.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">exec (c)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Executes the given shell command as the current UID of the
                                    running smsbox user and returns the output to 
                                <tt class="literal">stdout</tt> as reply.
                                Escape codes (parameters) are
                                usable here, too. BEWARE: You may harm your system if you use
                                this sms-service type without serious caution! Make sure anyone
                                who is allowed to use these kind of services is checked using 
                                white/black-list mechanisms for security reasons.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">accepted-smsc</tt></td>
                                <td>id-list</td>
                                <td valign="bottom">
                                    Accept ONLY SMS messages arriving from SMSC with matching ID.
                                    <a name="AEN4067" href="#FTN.AEN4067"><span class="footnote">[a]</span></a>
                                    Separate multiple entries with ';'. For example, if 
                                <tt class="literal">accepted-smsc</tt>
                                is "RL;SON", accept messages which originate from SMSC with
                                ID set as 'RL' or 'SON'
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">accepted-account</tt></td>
                                <td>id-list</td>
                                <td valign="bottom">
                                    Accept ONLY SMS messages arriving with a matching ACCOUNT field.
                                    <a name="AEN4075" href="#FTN.AEN4075"><span class="footnote">[b]</span></a>
                                    Separate multiple entries with ';'. For example, if 
                                <tt class="literal">accepted-account</tt>
                                is "FOO;BAR", accept messages which originate with the ACCOUNT
                                field set as 'FOO' or 'BAR'
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">allowed-prefix</tt></td>
                                <td><tt class="literal">prefix-list</tt></td>
                                <td valign="bottom">
                                    A list of phone number prefixes of the sender number which are 
                                    accepted to be received by this service. 
                                    <a name="AEN4084" href="#FTN.AEN4084"><span class="footnote">[c]</span></a>
                                    Multiple entries are separated with 
                                    semicolon (';'). For example, "91;93" selects this service for
                                    these prefixes. 
                                    If denied-prefix is unset, only this numbers are allowed. If 
                                    denied is set, number are allowed if present in allowed or not 
                                    in denied list.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">denied-prefix</tt></td>
                                <td><tt class="literal">prefix-list</tt></td>
                                <td valign="bottom">
                                    A list of phone number prefixes of the sender number which are 
                                    NOT accepted to be sent through this SMSC.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">allowed-receiver-prefix</tt></td>
                                <td><tt class="literal">prefix-list</tt></td>
                                <td valign="bottom">
                                    A list of phone number prefixes of the receiver number which are 
                                    accepted to be received by this service. This may be used to
                                    allow only inbound SMS to certain shortcut numbers to be allowed
                                    to this service.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">denied-receiver-prefix</tt></td>
                                <td><tt class="literal">prefix-list</tt></td>
                                <td valign="bottom">
                                    A list of phone number prefixes of the receiver number which are 
                                    NOT accepted to be sent through this SMSC.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">catch-all</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    Catch keyword regardless of '%s' parameters in pattern.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">send-sender</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    Used only with POST. If set to true, number of the handset is
                                    set, otherwise not.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">strip-keyword</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    Used only with POST. Remove matched keyword from message text
                                    before sending it onward.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">faked-sender</tt></td>
                                <td>phone-number</td>
                                <td valign="bottom">
                                    This number is set as sender. Most SMS centers ignore this,
                                    and use their fixed number instead. This option
                                    overrides all other sender setting methods.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">max-messages</tt></td>
                                <td>number</td>
                                <td valign="bottom">
                                    If the message to be sent is longer than maximum length of an SMS
                                    it will be split into several parts. <tt class="literal">max-messages</tt>
                                lets you specify a maximum number of individual SMS messages that
                                can be used. If
                                <tt class="literal">max-messages</tt> is set to 0, no reply is sent, 
                                except for error messages. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">accept-x-kannel-headers</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    Request reply can include special X-Kannel headers but these
                                    are only accepted if this variable is set to true. See
                                    <a href="#xkannel"><i>Extended headers</i></a>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">assume-plain-text</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    If client does not set Content-Type for reply, it is normally
                                    application/octet-stream which is then handled as data in
                                    Kannel. This can be forced to be plain/text to allow backward
                                    compatibility, when data was not expected.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">concatenation</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    Long messages can be sent as independent SMS messages with
                                <tt class="literal">concatenation = false</tt> or as concatenated messages
                                with <tt class="literal">concatenation = true</tt>. Concatenated messages
                                are reassembled into one long message by the receiving device.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">split-chars</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Allowed characters to split the message into several messages.
                                    So, with "#!" the message is split from last '#' or '!', which is 
                                    included in the previous part.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">split-suffix</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    If the message is split into several ones, this string is appended to 
                                    each message except the last one.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">omit-empty</tt></td>
                                <td>bool</td>
                                <td valign="bottom">
                                    Normally, Kannel sends a warning to the user if there was an
                                    empty reply from the service provider.  If
                                <tt class="literal">omit-empty</tt> is set to 'true', Kannel will send
                                nothing at all in such a case.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">header</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    If specified, this string is automatically added to each SMS sent with
                                    this service. If the message is split, it is added to each part.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">footer</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    As header, but not inserted into head but appended to end.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">prefix</tt></td>
                                <td>string</td>
                                <td rowspan="2" valign="bottom">
                                    Stuff in answer that is cut away, only things between prefix
                                    and suffix is left. Not case sensitive. Matches the first prefix
                                    and then the first suffix. These are only used for 
                                <tt class="literal">url</tt> type services, and only if both are
                                specified.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">suffix</tt></td>
                                <td>string</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">white-list</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    Load a list of accepted senders of SMS messages. If a 
                                    sender of an SMS message is not in this list, any message 
                                    received from the SMSC is rejected, unless a <tt class="literal">
                                    black-list</tt> service is defined. See notes of phone 
                                number format from numhash.h header file. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">black-list</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    As white-list, but SMS messages from these numbers are
                                    automatically discarded
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">accepted-smsc-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    Accept only SMS messages arriving from SMSCs with a matching ID.
                                    <a name="AEN4201" href="#FTN.AEN4201"><span class="footnote">[d]</span></a>
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">accepted-account-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    Accept ONLY SMS messages arriving with a matching ACCOUNT field.
                                    <a name="AEN4209" href="#FTN.AEN4209"><span class="footnote">[e]</span></a>
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">allowed-prefix-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    A set of phone number prefixes of sender-numbers accepted by this service.
                                    <a name="AEN4217" href="#FTN.AEN4217"><span class="footnote">[f]</span></a>
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">denied-prefix-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    A set of phone number prefixes of sender-numbers which may
                                    not use this service.
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">allowed-receiver-prefix-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    A set of phone number prefixes of receiver-numbers which 
                                    may receive data sent by this service. This can be used to
                                    allow only inbound SMS to certain shortcut numbers to be allowed
                                    to this service.
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">denied-receiver-prefix-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    A set of phone number prefixes of receiver-numbers which may not
                                    receive data sent by this service.
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">white-list-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    Defines a set of accepted senders of SMS messages. If a 
                                    sender of an SMS message is not in this list, the message is rejected.
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">black-list-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    As white-list-regex, but SMS messages from these numbers are
                                    automatically discarded.
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">alt-charset</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Defines which character encoding is used for the SMS message when
                                    passed to a remote HTTP application. This includes how the SMS message
                                    text is send in the HTTP GET parameter list and in the HTTP POST bidy.
                                    Uses <tt class="literal">iconv()</tt> routines to convert from and to that 
                                specific character set encoding. 
                                See your local <tt class="literal">iconv_open(3)</tt> manual page for the 
                                supported character encodings and the type strings that should be 
                                presented for this directive.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dlr-url</tt></td>
                                <td>string (URL)</td>
                                <td valign="bottom">
                                    Optional Defines a default URL which is fetched for DLR event, if no 
                                    specific X-Kannel HTTP header parameter is returned by the HTTP response.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dlr-mask</tt></td>
                                <td>number (bit mask)</td>
                                <td valign="bottom">
                                    Optional. Defines a default DLR event bit mask which is used in 
                                    combination with the <tt class="literal">dlr-url</tt> config directive, 
                                if no specific X-Kannel HTTP header parameter is returned by the 
                                HTTP response.
                                </td>
                                </tr>
                                </tbody>
                                <tbody>
                                    <tr>
                                        <td colspan="3">Notes:<br><a name="FTN.AEN4067">a. </a>Even if this service is denied,
                                            Kannel still searches for other service which accepts the message,
                                            or default service.<br><a name="FTN.AEN4075">b. </a>Even if this service is denied,
                                            Kannel still searches for other service which accepts the message,
                                            or default service.<br><a name="FTN.AEN4084">c. </a>Like in accepted-smsc, 
                                            Kannel still searches for other service which accepts the message.
                                            This way there could be several services with the same keyword and
                                            different results.<br><a name="FTN.AEN4201">d. </a>Even if this service is denied,
                                            Kannel still searches for other service which accepts the message,
                                            or default service.<br><a name="FTN.AEN4209">e. </a>Even if this service is denied,
                                            Kannel still searches for other service which accepts the message,
                                            or default service.<br><a name="FTN.AEN4217">f. </a>Like in accepted-smsc-regex, 
                                            Kannel still searches for another service which accepts the message.
                                            This way there could be several services with the same keyword and
                                            different results.<br>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="table">
                            <a name="escapecodes"></a>
                            <p><b>Table 7-10. Parameters (Escape Codes)</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                </colgroup>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">%k</tt></td>
                                <td>
                                    the keyword in the SMS request (i.e., the first word in the SMS message)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%s</tt></td>
                                <td>
                                    next word from the SMS message, starting with
                                    the second one (i.e., the first word, the
                                    keyword, is not included); problematic characters
                                    for URLs are encoded (e.g., '+' becomes '%2B')
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%S</tt></td>
                                <td>
                                    same as %s, but '*' is converted to '~' (useful
                                    when user enters a URL) and URL encoding isn't done
                                    (all others do URL encode)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%r</tt></td>
                                <td>
                                    words not yet used by %s; e.g., if the message
                                    is "FOO BAR FOOBAR BAZ", and the has been one %s,
                                    %r will mean "FOOBAR BAZ"
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%a</tt></td>
                                <td>
                                    all words of the SMS message, including the first one, with spaces
                                    squeezed to one
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%b</tt></td>
                                <td>
                                    the original SMS message, in a binary form
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%t</tt></td>
                                <td>
                                    the time the message was sent, formatted as
                                    "YYYY-MM-DD HH:MM", e.g., "1999-09-21 14:18"
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%T</tt></td>
                                <td>
                                    the time the message was sent, in UNIX epoch timestamp format
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%p</tt></td>
                                <td>
                                    the phone number of the sender of the SMS message
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%P</tt></td>
                                <td>
                                    the phone number of the receiver of the SMS message
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%q</tt></td>
                                <td>
                                    like %p, but a leading `00' is replaced with `+'
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%Q</tt></td>
                                <td>
                                    like %P, but a leading `00' is replaced with `+'
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%i</tt></td>
                                <td>
                                    the smsc-id of the connection that received the message
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%I</tt></td>
                                <td>
                                    the SMS ID of the internal message structure
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%d</tt></td>
                                <td>
                                    the delivery report value
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%R</tt></td>
                                <td>
                                    the delivery report URL value
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%D</tt></td>
                                <td>
                                    meta-data from the SMSC. See <a href="#meta-data">Meta Data</a> for more into.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%A</tt></td>
                                <td>
                                    the delivery report SMSC reply, if any
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%F</tt></td>
                                <td>
                                    the <tt class="literal">foreign</tt> (smsc-provided) message ID. Only
                                relevant on DLR url's.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%n</tt></td>
                                <td>
                                    the sendsms-user or sms-service name
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%c</tt></td>
                                <td>
                                    message coding: 0 (default, 7 bits), 1 (8 bits) or 2 (Unicode)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%m</tt></td>
                                <td>
                                    message class bits of DCS: 0 (directly to display, flash),
                                    1 (to mobile), 2 (to SIM) or 3 (to SIM toolkit).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%M</tt></td>
                                <td>
                                    mwi (message waiting indicator) bits of DCS:
                                    0 (voice), 1, (fax), 2 (email) or 3 (other) for activation
                                    and 4, 5, 6, 7 for deactivation respectively.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%C</tt></td>
                                <td>
                                    message charset: for a "normal" message, it will 
                                    be "GSM" (coding=0), "binary" (coding=1) or 
                                    "UTF-16BE" (coding=2). If the message was successfully
                                    recoded from Unicode, it will be "WINDOWS-1252"
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%u</tt></td>
                                <td>
                                <tt class="literal">udh</tt> of incoming message
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%B</tt></td>
                                <td>
                                    billing identifier/information of incoming message. The value
                                    depends on the SMSC module and the associated billing semantics
                                    of the specific SMSC providing the information. For EMI2 the value
                                    is the XSer 0c field, for SMPP MO it is the service_type of the 
                                    deliver_sm PDU, and for SMPP DLR it is the DLR message err component. 
                                    (Note: This is used for proxying billing 
                                    information to external applications. There is no semantics 
                                    associated while processing these.)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%o</tt></td>
                                <td>
                                    account identifier/information of incoming message. The value
                                    depends on the SMSC module and has been introduced to allow the
                                    forwarding of an operator ID from aggregator SMSCs to the application
                                    layer, hence the smsbox HTTP calling instance.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%O</tt></td>
                                <td>
                                    DCS (Data coding schema) value.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%f</tt></td>
                                <td>
                                    Originating SMSC of incoming message. The value is set if
                                    the AT driver is used to receive a SMS on a gsm modem.
                                    The value of %f will contain the number of the SMSC sending
                                    the SMS to the SIM card. Other SMSC types than AT do not
                                    set this field so it will be empty.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%x</tt></td>
                                <td>
                                    the smsbox-id of the message, identifying from which smsbox connection
                                    the message is originating. (Only available withing the
                                <tt class="literal">access-log-format</tt> directive)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%v</tt></td>
                                <td>
                                    Validity period in minutes. Available only if SMSC supports
                                    and sent this value.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%V</tt></td>
                                <td>
                                    Deferred in minutes. Available only if SMSC supports
                                    and sent this value.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">%#</tt></td>
                                <td>
                                    This allows to pass meta-data individual parameters into urls.
                                    The syntax is as follows: <tt class="literal">%#group#parameter#</tt>
                                For example: <tt class="literal">%#smpp#my_param#</tt> would be replaced 
                                with the value 'my_param' from the group 'smpp' coming inside the 
                                meta_data field.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <p>Some sample 'sms-service' groups:
                        </p>
                        <pre class="programlisting">
group = sms-service
keyword = nop
text = "You asked nothing and I did it!"
catch-all = true

group = sms-service
keyword = complex
get-url = "http://host/service?sender=%p&amp;text=%r"
accept-x-kannel-headers = true
max-messages = 3
concatenation = true

group = sms-service
keyword = default
text = "No action specified"
                        </pre>
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN4412">How sms-service interprets the HTTP response</a></h3>
                        <p>When an <tt class="literal">sms-service</tt> requests a document
                        via HTTP, it will accept one of four types of content types:
                        </p>
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN4416"></a>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                </colgroup>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">text/plain</tt></td>
                                <td>Blanks are squeezed into one, rest is chopped to fit an
                                    SMS message.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">text/html</tt></td>
                                <td>Tags are removed, rest is chopped to fit an
                                    SMS message.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">text/vnd.wap.wml</tt></td>
                                <td>Processed like HTML.</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">text/xml</tt></td>
                                <td>Processed as a POST-XML. See <a href="#postxml"><i>XML Post</i></a></td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">application/octet-stream</tt></td>
                                <td>The body will be transmitted as the SMS message, as
                                    8-bit data. This can be avoided by setting
                                <tt class="literal">assume-plain-text</tt> variable on for the
                                SMS-service.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                        <p></p>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="xkannel">Extended headers</a></h4>
                            <p>Kannel uses and accepts several X-Kannel headers to be
                                used with SMS-services, if option
                            <tt class="literal">accept-x-kannel-headers</tt> was provided in the
                            relevant 'sms-service' group.
                            </p>
                            <div class="table">
                                <a name="AEN4445"></a>
                                <p><b>Table 7-11. X-Kannel Headers</b></p>
                                <table frame="void" class="CALSTABLE" border="0">
                                    <colgroup>
                                        <col>
                                        <col>
                                    </colgroup>
                                    <thead>
                                        <tr>
                                            <th>SMSPush equivalent</th>
                                            <th>X-Kannel Header</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><tt class="literal">username</tt></td>
                                    <td><tt class="literal">X-Kannel-Username</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">password</tt></td>
                                    <td><tt class="literal">X-Kannel-Password</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">from</tt></td>
                                    <td><tt class="literal">X-Kannel-From</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">to</tt></td>
                                    <td><tt class="literal">X-Kannel-To</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">text</tt></td>
                                    <td>request body</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">charset</tt></td>
                                    <td>charset as in <tt class="literal">Content-Type: text/html; charset=ISO-8859-1</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">udh</tt></td>
                                    <td><tt class="literal">X-Kannel-UDH</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">smsc</tt></td>
                                    <td><tt class="literal">X-Kannel-SMSC</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">flash</tt></td>
                                    <td><tt class="literal">X-Kannel-Flash</tt> (deprecated, see <tt class="literal">X-Kannel-MClass</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">mclass</tt></td>
                                    <td><tt class="literal">X-Kannel-MClass</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">mwi</tt></td>
                                    <td><tt class="literal">X-Kannel-MWI</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">compress</tt></td>
                                    <td><tt class="literal">X-Kannel-Compress</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">coding</tt></td>
                                    <td><tt class="literal">X-Kannel-Coding</tt>. If unset, defaults to 0 
                                    (7 bits) if <tt class="literal">Content-Type</tt> is <tt class="literal">text/plain
                                    </tt>, <tt class="literal">text/html</tt> or 
                                    <tt class="literal">text/vnd.wap.wml</tt>. On 
                                    <tt class="literal">application/octet-stream</tt>, defaults to
                                    8 bits (1). All other <tt class="literal">Content-Type</tt> values 
                                    are rejected.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">validity</tt></td>
                                    <td><tt class="literal">X-Kannel-Validity</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">deferred</tt></td>
                                    <td><tt class="literal">X-Kannel-Deferred</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">dlr-mask</tt></td>
                                    <td><tt class="literal">X-Kannel-DLR-Mask</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">dlr-url</tt></td>
                                    <td><tt class="literal">X-Kannel-DLR-Url</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">account</tt></td>
                                    <td><tt class="literal">X-Kannel-Account</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">pid</tt></td>
                                    <td><tt class="literal">X-Kannel-PID</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">alt-dcs</tt></td>
                                    <td><tt class="literal">X-Kannel-Alt-DCS</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">binfo</tt></td>
                                    <td><tt class="literal">X-Kannel-BInfo</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">rpi</tt></td>
                                    <td><tt class="literal">X-Kannel-RPI</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">priority</tt></td>
                                    <td><tt class="literal">X-Kannel-Priority</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">meta-data</tt></td>
                                    <td><tt class="literal">X-Kannel-Meta-Data</tt></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="kannelpost">Kannel POST</a></h4>
                            <p>Kannel can do POST if <tt class="literal">service</tt> is
                            contains a <tt class="literal">post-url="..."</tt>.
                            </p>
                            <div class="table">
                                <a name="AEN4584"></a>
                                <p><b>Table 7-12. X-Kannel Post Headers</b></p>
                                <table frame="void" class="CALSTABLE" border="0">
                                    <colgroup>
                                        <col>
                                        <col>
                                    </colgroup>
                                    <thead>
                                        <tr>
                                            <th>Parameter (escape code) equivalent</th>
                                            <th>X-Kannel Header</th>
                                            <th>Notes</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><tt class="literal">%p (from)</tt></td>
                                    <td><tt class="literal">X-Kannel-From</tt></td>
                                    <td>Only sent if <tt class="literal">send-sender</tt> is true</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">%P (to)</tt></td>
                                    <td><tt class="literal">X-Kannel-To</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">%t (time)</tt></td>
                                    <td><tt class="literal">X-Kannel-Time</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">%u (udh)</tt></td>
                                    <td><tt class="literal">X-Kannel-UDH</tt></td>
                                    <td>in hex format: <tt class="literal">06050415820000</tt></td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">%i (smsc)</tt></td>
                                    <td><tt class="literal">X-Kannel-SMSC</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">- (mclass)</tt></td>
                                    <td><tt class="literal">X-Kannel-MClass</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">- (pid)</tt></td>
                                    <td><tt class="literal">X-Kannel-PID</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">- (alt-dcs)</tt></td>
                                    <td><tt class="literal">X-Kannel-Alt-DCS</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">- (mwi)</tt></td>
                                    <td><tt class="literal">X-Kannel-MWI</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">%c (coding)</tt></td>
                                    <td><tt class="literal">X-Kannel-Coding</tt></td>
                                    <td>0=7 Bits, 1=8 Bits, 2=UCS-2</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">- (compress)</tt></td>
                                    <td><tt class="literal">X-Kannel-Compress</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">- (validity)</tt></td>
                                    <td><tt class="literal">X-Kannel-Validity</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">- (deferred)</tt></td>
                                    <td><tt class="literal">X-Kannel-Deferred</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">%n (service name)</tt></td>
                                    <td><tt class="literal">X-Kannel-Service</tt></td>
                                    <td>&nbsp;</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">%D (meta-data)</tt></td>
                                    <td><tt class="literal">X-Kannel-Meta-Data</tt></td>
                                    <td>Meta-Data (Only SMPP TLV's supported at the moment)</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">%a or %r (text)</tt></td>
                                    <td>request body</td>
                                    <td>Kannel send all words (%a) unless <tt class="literal">strip-keyword</tt> is true</td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">%C (charset)</tt></td>
                                    <td>present in <tt class="literal">Content-Type</tt> <tt class="literal">HTTP</tt></td>
                                    <td>Example: <tt class="literal">Content-Type: text/plain; charset=ISO-8859-1</tt></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="postxml">XML Post</a></h4>
                            <p>Kannel can send and receive XML POST with the following
                                format:
                            </p>
                            <pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE ...&gt;
&lt;message&gt;
  &lt;submit&gt;
    &lt;da&gt;&lt;number&gt;destination number (to)&lt;/number&gt;&lt;/da&gt;
    &lt;oa&gt;&lt;number&gt;originating number (from)&lt;/number&gt;&lt;/oa&gt;
    &lt;ud&gt;user data (text)&lt;/ud&gt;
    &lt;udh&gt;user data header (udh)&lt;/udh&gt;
    &lt;meta-data&gt;meta-data&lt;/meta-data&gt;
    &lt;dcs&gt;
      &lt;mclass&gt;mclass&lt;/mclass&gt;
      &lt;coding&gt;coding&lt;/coding&gt;
      &lt;mwi&gt;mwi&lt;/mwi&gt;
      &lt;compress&gt;compress&lt;/compress&gt;
      &lt;alt-dcs&gt;alt-dcs&lt;/alt-dcs&gt;
    &lt;/dcs&gt;
    &lt;pid&gt;pid&lt;/pid&gt;
    &lt;rpi&gt;rpi&lt;/rpi&gt;
    &lt;vp&gt;
      &lt;delay&gt;validity time in minutes&lt;/delay&gt;
    &lt;/vp&gt;
    &lt;timing&gt;
      &lt;delay&gt;deferred time in minutes&lt;/delay&gt;
    &lt;/timing&gt;
    &lt;statusrequest&gt;
      &lt;dlr-mask&gt;dlr-mask&lt;/dlr-mask&gt;
      &lt;dlr-url&gt;dlr-url&lt;/dlr-url&gt;
    &lt;/statusrequest&gt;

    &lt;!-- request from application to Kannel --&gt;
    &lt;from&gt;
      &lt;user&gt;username&lt;/user&gt;
      &lt;username&gt;username&lt;/username&gt; 
      &lt;pass&gt;password&lt;/pass&gt;
      &lt;password&gt;password&lt;/password&gt;
      &lt;account&gt;account&lt;/account&gt;
    &lt;/from&gt;
    &lt;to&gt;smsc-id&lt;/to&gt;

    &lt;!-- request from Kannel to application --&gt;
    &lt;from&gt;smsc-id&lt;/from&gt;
    &lt;to&gt;service-name&lt;/to&gt;

  &lt;/submit&gt;
&lt;/message&gt;
                            </pre>
                            <div class="note">
                                <blockquote class="note">
                                    <p><b>Note: </b>Don't forget to set POST Content-Type to 
                                    <tt class="literal">text/xml</tt>!
                                    </p>
                                </blockquote>
                            </div>
                            <p>There could be several <tt class="literal">da</tt> entries for <tt class="literal">sendsms-user
                            </tt> to enable multi-recipient messages. <tt class="literal">da</tt> doesn't make
                            sense in <tt class="literal">sms-service</tt>.
                            </p>
                            <p><tt class="literal">udh</tt> is the same format as <tt class="literal">X-Kannel-UDH</tt>.
                            Example: &lt;udh&gt;06050415820000&lt;/udh&gt;.
                            </p>
                            <p>On Kannel-&gt;application, <tt class="literal">from</tt> is the <tt class="literal">smsc-id</tt>
                            that message arrives and <tt class="literal">to</tt> is the service name.
                            </p>
                            <p>On application-&gt;Kannel, <tt class="literal">from</tt> contains the credentials (
                            <tt class="literal">user/username</tt>, <tt class="literal">pass/password</tt> and <tt class="literal">
                                account</tt> and <tt class="literal">to</tt> corresponds to the <tt class="literal">smsc-id
                            </tt> to submit the message.
                            </p>
                            <p><tt class="literal">user</tt> and <tt class="literal">username</tt> are equivalent and 
                            only one of them should be used. (same for <tt class="literal">pass</tt> and <tt class="literal">
                                password</tt>.
                            </p>
                            <p>When application POST in Kannel, as in GET, only <tt class="literal">user</tt>, <tt class="literal">
                                pass</tt> and <tt class="literal">da</tt> are required. Everything else is optional. 
                            (<tt class="literal">oa</tt> could be needed too is there's no <tt class="literal">default-sender</tt>
                            or <tt class="literal">forced-sender</tt>.
                            </p>
                            <div class="warning">
                                <p></p>
                                <table class="warning" border="1" width="100%">
                                    <tbody>
                                        <tr>
                                            <td align="CENTER"><b>Warning</b></td>
                                        </tr>
                                        <tr>
                                            <td align="LEFT">
                                                <p>This is experimental code. XML format could and should change to fully
                                                    met IETF's sms-xml standard (yet in draft) and additional tags needed by Kannel should be
                                                    pondered.
                                                </p>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN4739">SendSMS-user configurations</a></h3>
                        <p>To enable an SMS push, you must set
                        <tt class="literal">sendsms-port</tt> into the 'smsbox' group and define one or
                        more 'sendsms-user' groups. Each of these groups define one
                        account, which can be used for the SMS push, via HTTP interface (see
                        below)
                        </p>
                        <div class="table">
                            <a name="AEN4743"></a>
                            <p><b>Table 7-13. SendSMS-User Group Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group (m)</tt></td>
                                <td><tt class="literal">sendsms-user</tt></td>
                                <td valign="bottom">
                                    This is a mandatory variable
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">username (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Name for the user/account. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">password (m)</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Password for the user (see HTTP interface, below)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">name</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    As in 'sms-service' groups.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">user-deny-ip</tt></td>
                                <td>IP-list</td>
                                <td rowspan="2" valign="bottom">
                                    As other deny/allow IP lists, but for this user (i.e. this
                                    user is not allowed to do the SMS push HTTP request from
                                    other IPs than allowed ones). If not set, there is no
                                    limitations.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">user-allow-IP</tt></td>
                                <td>IP-list</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">forced-smsc</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Force SMSC ID as a 'string' (linked to SMS routing, see 'smsc' groups)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">default-smsc</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    If no SMSC ID is given with the send-sms request (see below), use
                                    this one. No idea to use with forced-smsc.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">default-sender</tt></td>
                                <td>phone-number</td>
                                <td valign="bottom">
                                    This number is set as sender if not set by <tt class="literal">from</tt>
                                get/post parameter 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">faked-sender</tt></td>
                                <td>phone-number</td>
                                <td valign="bottom">
                                    As in 'sms-service' groups
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">max-messages</tt></td>
                                <td>number</td>
                                <td>&nbsp;</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">concatenation</tt></td>
                                <td>bool</td>
                                <td>&nbsp;</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">split-chars</tt></td>
                                <td>string</td>
                                <td>&nbsp;</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">split-suffix</tt></td>
                                <td>string</td>
                                <td>&nbsp;</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">omit-empty</tt></td>
                                <td>bool</td>
                                <td>&nbsp;</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">header</tt></td>
                                <td>string</td>
                                <td>&nbsp;</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">footer</tt></td>
                                <td>string</td>
                                <td>&nbsp;</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">allowed-prefix</tt></td>
                                <td><tt class="literal">prefix-list</tt></td>
                                <td valign="bottom">
                                    A list of phone number prefixes which are accepted to be
                                    sent using this username. Multiple entries are separated with 
                                    semicolon (';'). For example, "040;050" prevents sending of
                                    any SMS message with prefix of 040 or 050 through this SMSC.
                                    If denied-prefix is unset, only this numbers are allowed. If
                                    set, number are allowed if present in allowed or not in 
                                    denied list.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">denied-prefix</tt></td>
                                <td><tt class="literal">prefix-list</tt></td>
                                <td valign="bottom">
                                    A list of phone number prefixes which are NOT accepted to be
                                    sent using this username.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">white-list</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    Load a list of accepted destinations of SMS messages. If a 
                                    destination of an SMS message is not in this list, any message 
                                    received from the HTTP interface is rejected. See notes of phone 
                                    number format from numhash.h header file. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">black-list</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    As white-list, but SMS messages from these numbers are
                                    automatically rejected.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dlr-url</tt></td>
                                <td>URL</td>
                                <td valign="bottom">
                                    URL to be fetched if a <tt class="literal">dlr-mask</tt> CGI 
                                parameter is present.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">allowed-prefix-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    A set of phone numbers which are accepted to be
                                    sent using this username. 
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">denied-prefix-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    A set of phone numbers which may not
                                    send using this username. 
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">white-list-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    Defines a set of accepted destinations of SMS messages. If a 
                                    destination of an SMS message is not in this list, any message 
                                    received from the HTTP interface is rejected. 
                                    See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">black-list-regex</tt></td>
                                <td>POSIX regular expression</td>
                                <td valign="bottom">
                                    As <tt class="literal">white-list-regex</tt>, but SMS messages originating from 
                                a number matching the pattern are discarded.
                                See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <p>Some sample 'sendsms-user' groups:
                        </p>
                        <pre class="programlisting">
group = sendsms-user
username = simple
password = elpmis

group = sendsms-user
username = complex
password = 76ftY
user-deny-ip = "*.*.*.*"
user-allow-ip = "123.234.123.234"
max-messages = 3
concatenation = true
forced-smsc = SOL
                        </pre>
                        The second one is very limited and only allows a user from IP
                        "123.234.123.234". On the other hand, the user can send a longer
                        message, up to 3 SMSes long, which is sent as concatenated
                        SMS.
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN4886">Over-The-Air configurations</a></h3>
                        <p>To enable Over-The-Air configuration of phones or other client
                            devices that support the protocol you need to configure a <tt class="literal">
                            sendsms-user</tt>.<tt class="literal">ota-setting</tt> group is not 
                        necessary, you can send settings to the phone as a XML document, but
                        this method is perhaps more suitable for continuous provisioning.
                        </p>
                        <p>If you want to send multiple OTA configurations through the smsbox
                            and you do not want to send XML documents, you will have to declare a 
                        <tt class="literal">ota-id</tt> string to the different <tt class="literal">ota-setting
                        </tt> groups.
                        </p>
                        <div class="table">
                            <a name="AEN4894"></a>
                            <p><b>Table 7-14. OTA Setting Group Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group</tt></td>
                                <td><tt class="literal">ota-setting</tt></td>
                                <td valign="bottom">
                                    This is a mandatory variable
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">ota-id</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    An optional name or id for the ota-setting. Any string is
                                    acceptable, but semicolon ';' may cause problems, so avoid
                                    it and any other special non-alphabet characters. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">location</tt></td>
                                <td><tt class="literal">URL</tt></td>
                                <td valign="bottom">
                                    The address of the HTTP server for your WAP services, i.e. 
                                <tt class="literal">http://wap.company.com</tt>
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">service</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Description of the service
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">ipaddress</tt></td>
                                <td><tt class="literal">IP</tt></td>
                                <td valign="bottom">
                                    IP address of your WAP gateway 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">phonenumber</tt></td>
                                <td><tt class="literal">phone-number</tt></td>
                                <td valign="bottom">
                                    Phone number used to establish the PPP connection
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">speed</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Connection speed: 9600 or 14400. Defaults to 9600.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">bearer</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Bearer type: data or sms. Defaults to data.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">calltype</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Call type: isdn or analog. Defaults to isdn.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">connection</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Connection type: cont or temp. Cont uses TCP port 9201
                                    and Temp uses UDP port 9200. Defaults to cont.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">pppsecurity</tt></td>
                                <td><tt class="literal">on or off</tt></td>
                                <td valign="bottom">
                                    Enable CHAP authentication if set to on, PAP otherwise
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">authentication</tt></td>
                                <td><tt class="literal"></tt></td>
                                <td valign="bottom">
                                    normal or secure. Indicates whether WTLS should be used 
                                    or not. Defaults to normal.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">login</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Login name.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">secret</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Login password
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <p>A sample 'ota-setting' group:
                        </p>
                        <pre class="programlisting">
group = ota-setting
location = http://wap.company.com
service = "Our company's WAP site"
ipaddress = 10.11.12.13
phonenumber = 013456789
bearer = data
calltype = analog
connection = cont
pppsecurity = off
authentication = normal
login = wapusr
secret = thepasswd
                        </pre>
                        And a 'sendsms-user' to use with it. With concatenation enabled:
                        <pre class="programlisting">
group = sendsms-user
username = otauser
password = foo
max-messages = 2
concatenation = 1
                        </pre>
                        <p></p>
                        <div class="table">
                            <a name="AEN4991"></a>
                            <p><b>Table 7-15. OTA Bookmark Group Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Variable</th>
                                        <th>Value</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">group</tt></td>
                                <td><tt class="literal">ota-bookmark</tt></td>
                                <td valign="bottom">
                                    This is a mandatory variable
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">ota-id</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    An optional name or id for the ota-bookmark. Any string is
                                    acceptable, but semicolon ';' may cause problems, so avoid
                                    it and any other special non-alphabet characters. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">url</tt></td>
                                <td><tt class="literal">URL</tt></td>
                                <td valign="bottom">
                                    The address of the HTTP server for your WAP services, i.e. 
                                <tt class="literal">http://wap.company.com</tt>
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">name</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Description of the service
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <p>A sample 'ota-bookmark' group:
                        </p>
                        <pre class="programlisting">
group = ota-bookmark
ota-id = wap-link
url = "http://wap.company.com"
service = "Our company's WAP site"
                        </pre>
                        And a 'sendsms-user' to use with it, with the same conditions as for the
                        'ota-setting' group.
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN5027">Setting up more complex services</a></h3>
                        <p>The basic service system is very limited - it can only
                            answer to original requester and it cannot send UDH data, for
                            example. This chapter explains some more sophisticated and complex
                            SMS service setups.
                        </p>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN5030">Redirected replies</a></h4>
                            <p>The basic service system always sends the answer back to
                                original requester, but sometimes the content server needs to send
                                something to other terminals or delay the answer. To create 
                                such systems, an SMS push is used.
                            </p>
                            <p>The idea is to get the initial request, but then send no
                                reply. Instead, the reply (if any) is sent via HTTP
                                sendsms-interface as SMS Push. This way the service
                                application has full control of the return content, and can do all
                                needed formatting beforehand.
                            </p>
                            <p>Note that when no reply is wanted, remember to set the variable
                            <tt class="literal">max-messages</tt> to zero (0) so that no reply is sent, unless an
                            error occurs. Simple sample:
                            </p>
                            <pre class="programlisting">
group = sms-service
keyword = talk
get-url = "http://my.applet.machine/Servlet/talk?sender=%p&amp;text=%r"
max-messages = 0
                            </pre>
                        </div>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN5037">Setting up operator specific services</a></h4>
                            <p>Those running Kannel with several SMS centers might need to
                                define services according to the relying SMS center. To achieve this,
                                first you need to give an ID name for SMS center connections (see
                                above). Then use the <tt class="literal">accepted-smsc</tt> variable to 
                            define which messages can use that service.
                            </p>
                            <pre class="programlisting">
group = sms-service
keyword = weather
accepted-smsc = SOL
get-url = "http://my.applet.machine/Servlet/weather?sender=%p&amp;operator=SOL&amp;text=%r"
                            </pre>
                        </div>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN5042">Setting up multi-operator Kannel</a></h4>
                            <p>Sometimes there is a need for Kannel to listen to two (or
                                more) distinct SMS centers, and messages must be routed to services
                                according to where they came from, and replies likewise must return
                                to same SMSC. This is done via <tt class="literal">smsc-id</tt>
                            magic. Here is a shortened sample configuration, which handles to
                            distinct SMS servers and services:
                            </p>
                            <pre class="programlisting">
group = smsc
smsc-id = A
denied-smsc-id = B
...

group = smsc
smsc-id = B
denied-smsc-id = A
...

group = sms-service
accepted-smsc = A
get-url = "..."

group = sms-service
accepted-smsc = B
get-url = "..."
                            </pre>
                            <p>As can be seen, the <tt class="literal">smsc-id</tt> is used to
                            identify the SMS center from which the message came. Then, the
                            <tt class="literal">denied-smsc-id</tt> variable is used to prevent
                            messages originally from the other SMS center from being sent
                            through the other one. Finally 'sms-service' groups are defined
                            with <tt class="literal">accepted-smsc</tt> so that they only accept
                            messages from certain SMS center.
                            </p>
                            <p>If you want to use SMS push services, requesters 
                                should then set the <tt class="literal">smsc</tt> request parameter, or
                            'sendsms-user' groups should be defined like this:
                            </p>
                            <pre class="programlisting">
group = sendsms-user
username = operator_A
password = foo
forced-smsc = A

group = sendsms-user
username = operator_B
password = bar
forced-smsc = B
                            </pre>
                            <p>Note that if your SMS centers do not set the sender phone
                                number but rely on number transmitted, you should set
                            <tt class="literal">faked-sender</tt> to all 'sendsms-user'
                            groups.
                            </p>
                        </div>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5056">Running SMS gateway</a></h2>
                    <div class="sect2">
                        <h3 class="sect2"><a name="AEN5058">Using the HTTP interface to send SMS messages</a></h3>
                        <p>After you have configured Kannel to allow the sendsms
                            service, you can send SMS messages via HTTP, e.g., using a
                            WWW browser. The URL looks something like this:
                        </p>
                        <pre class="programlisting">
http://smsbox.host.name:13013/cgi-bin/sendsms?
username=foo&amp;password=bar&amp;to=0123456&amp;text=Hello+world
                        </pre>
                        Thus, technically,
                        you make an HTTP GET request. This means that all the information
                        is stuffed into the URL. If you want to use this often via a
                        browser, you probably want to make an HTML form for this.
                        <p></p>
                        <p>
                            Kannel will answer to sendsms request with following codes and
                            body texts:
                        </p>
                        <div class="table">
                            <a name="AEN5063"></a>
                            <p><b>Table 7-16. SMS Push reply codes</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Status</th>
                                        <th>Body</th>
                                        <th>Meaning</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">202</tt></td>
                                <td><tt class="literal">0: Accepted for delivery</tt></td>
                                <td valign="bottom">
                                    The message has been accepted and is delivered onward to a SMSC
                                    driver. Note that this status does not ensure that the
                                    intended recipient receives the message.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">202</tt></td>
                                <td><tt class="literal">3: Queued for later delivery</tt></td>
                                <td valign="bottom">
                                    The bearerbox accepted and stored the message, but there was
                                    temporarily no SMSC driver to accept the message so it was
                                    queued. However, it should be delivered later on.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">4xx</tt></td>
                                <td>(varies)</td>
                                <td valign="bottom">
                                    There was something wrong in the request or Kannel was so
                                    configured that the message cannot be in any circumstances
                                    delivered. Check the request and Kannel configuration.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">503</tt></td>
                                <td><tt class="literal">Temporal failure, try again later.</tt></td>
                                <td valign="bottom">
                                    There was temporal failure in Kannel. Try again later.
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="table">
                            <a name="AEN5095"></a>
                            <p><b>Table 7-17. SMS Push (send-sms) CGI Variables</b></p>
                            <table frame="void" class="CALSTABLE" border="0">
                                <colgroup>
                                    <col>
                                    <col>
                                    <col>
                                </colgroup>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">username</tt> (or <tt class="literal">user</tt>)</td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Username or account name. Must be <tt class="literal">username</tt> of the one
                                'sendsms-user' group in the Kannel configuration,
                                or results in 'Authorization failed' reply.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">password</tt> (or <tt class="literal">pass</tt>)</td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Password associated with given <tt class="literal">username</tt>. Must match
                                corresponding field in the 'sendsms-user' group of
                                the Kannel configuration, or 'Authorization failed' is returned.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">from</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Phone number of the sender. This field is usually overridden
                                    by the SMS Center, or it can be overridden by
                                <tt class="literal">faked-sender</tt> variable in the
                                <tt class="literal">sendsms-user</tt> group. If this variable is not
                                set, smsbox <tt class="literal">global-sender</tt> is used.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">to</tt></td>
                                <td><tt class="literal">phone number list</tt></td>
                                <td valign="bottom">
                                    Phone number of the receiver. To send to multiple receivers,
                                    separate each entry with <span class="emphasis"><i class="emphasis">space</i></span> (' ', '+'
                                    url-encoded) - but note that this can be deactivated via
                                <tt class="literal">sendsms-chars</tt> in the 'smsbox' group.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">text</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Contents of the message, URL encoded as necessary. The content
                                    can be more than 160 characters, but then
                                <tt class="literal">sendsms-user</tt> group must have
                                <tt class="literal">max-messages</tt> set more than 1.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">charset</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Charset of text message. Used to convert to a format suitable for
                                    7 bits or to UCS-2. Defaults to UTF-8 if coding is 7 bits and
                                    UTF-16BE if coding is UCS-2.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">udh</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Optional User Data Header (UDH) part of the message. Must be
                                    URL encoded.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">smsc</tt></td>
                                <td><tt class="literal">string</tt></td>
                                <td valign="bottom">
                                    Optional virtual smsc-id from which the message is supposed to 
                                    have arrived. This is used for routing purposes, if any denied
                                    or preferred SMS centers are set up in SMS center
                                    configuration. This variable can be overridden with a
                                <tt class="literal">forced-smsc</tt> configuration
                                variable. Likewise, the <tt class="literal">default-smsc</tt> variable
                                can be used to set the SMSC if it is not set otherwise.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">flash</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Deprecated. See <tt class="literal">mclass</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">mclass</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional. Sets the Message Class in DCS field.
                                    Accepts values between 0 and 3, for Message Class 0 to 3, 
                                    A value of 0 sends the message directly to display, 1 sends
                                    to mobile, 2 to SIM and 3 to SIM toolkit.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">mwi</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional. Sets Message Waiting Indicator bits in DCS field.
                                    If given, the message will be encoded as a Message Waiting
                                    Indicator. The accepted values are 0,1,2 and 3 for activating the
                                    voice, fax, email and other indicator, or 4,5,6,7 for deactivating,
                                    respectively.
                                    This option excludes the <tt class="literal">flash</tt> option.
                                <a name="mwi-messages" href="#FTN.mwi-messages"><span class="footnote">[a]</span></a>
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">compress</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional. Sets the Compression bit in DCS Field.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">coding</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional. Sets the coding scheme bits in DCS field.
                                    Accepts values 0 to 2, for 7bit, 8bit or UCS-2.
                                    If unset, defaults to 7 bits unless a udh is defined, which sets
                                    coding to 8bits.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">validity</tt></td>
                                <td><tt class="literal">number (minutes)</tt></td>
                                <td valign="bottom">
                                    Optional. If given, Kannel will inform SMS Center that it should only
                                    try to send the message for this many minutes. If the destination
                                    mobile is off other situation that it cannot receive the sms, the
                                    smsc discards the message.
                                    Note: you must have your Kannel box time synchronized with the SMS Center.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">deferred</tt></td>
                                <td><tt class="literal">number (minutes)</tt></td>
                                <td valign="bottom">
                                    Optional. If given, the SMS center will postpone the message to be
                                    delivered at now plus this many minutes.
                                    Note: you must have your Kannel box time synchronized with the SMS Center.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dlrmask</tt></td>
                                <td><tt class="literal">number (bit mask)</tt></td>
                                <td valign="bottom">
                                    Deprecated. See <tt class="literal">dlr-mask</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dlr-mask</tt></td>
                                <td><tt class="literal">number (bit mask)</tt></td>
                                <td valign="bottom">
                                    Optional. Request for delivery reports with the state of the sent 
                                    message. The value is a bit mask composed of: 1: Delivered to phone, 
                                    2: Non-Delivered to Phone, 4: Queued on SMSC, 8: Delivered to SMSC, 
                                    16: Non-Delivered to SMSC. Must set <tt class="literal">dlr-url</tt> on 
                                <tt class="literal">sendsms-user</tt> group or use the 
                                <tt class="literal">dlr-url</tt> CGI variable. 
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dlrurl</tt></td>
                                <td><tt class="literal">string (url)</tt></td>
                                <td valign="bottom">
                                    Deprecated. See <tt class="literal">dlr-url</tt>.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">dlr-url</tt></td>
                                <td><tt class="literal">string (url)</tt></td>
                                <td valign="bottom">
                                    Optional. If <tt class="literal">dlr-mask</tt> is given, this is the url to
                                be fetched. (Must be url-encoded)
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">pid</tt></td>
                                <td><tt class="literal">byte</tt></td>
                                <td valign="bottom">
                                    Optional. Sets the PID value. (See ETSI Documentation).
                                    Ex: SIM Toolkit messages would use something like 
                                <tt class="literal">&amp;pid=127&amp;coding=1&amp;alt-dcs=1&amp;mclass=3</tt>
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">alt-dcs</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional. If unset, Kannel uses the alt-dcs defined on smsc configuration,
                                    or 0X per default. If equals to 1, uses FX. If equals to 0, force 0X.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">rpi</tt></td>
                                <td><tt class="literal">number</tt></td>
                                <td valign="bottom">
                                    Optional. Sets the Return Path Indicator (RPI) value. (See ETSI Documentation).
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">account</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Optional. Account name or number to carry forward for billing purposes.
                                    This field is logged as ACT in the log file so it allows you to do some
                                    accounting on it if your front end uses the same username for all services
                                    but wants to distinguish them in the log. In the case of a HTTP SMSC
                                    type the account name is prepended with the service-name (username) and a colon (:)
                                    and forwarded to the next instance of Kannel. This allows hierarchical accounting.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">binfo</tt></td>
                                <td>string</td>
                                <td valign="bottom">
                                    Optional. Billing identifier/information proxy field used to pass arbitrary
                                    billing transaction IDs or information to the specific SMSC modules. For EMI2 this
                                    is encapsulated into the XSer 0c field, for SMPP this is encapsulated into the 
                                    service_type of the submit_sm PDU.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">priority</tt></td>
                                <td>number</td>
                                <td valign="bottom">
                                    Optional. Sets the Priority value (range 0-3 is allowed).
                                    (Defaults to 0, which is the lowest priority).
                                </td>
                                </tr>
                                </tbody>
                                <tbody>
                                    <tr>
                                        <td colspan="3">Notes:<br><a name="FTN.mwi-messages">a. </a>To set number of messages, use
                                <tt class="literal">mwi=[0-3]&amp;coding=0&amp;udh=%04%01%02%&lt;XX&gt;%&lt;YY&gt;</tt>,
                                where YY are the number of messages, in HEX, and XX are <tt class="literal">mwi</tt>
                                plus 0xC0 if <tt class="literal">text</tt> field is not empty.<br>
                                </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN5273">Using the HTTP interface to send OTA configuration messages</a></h3>
                        <p>OTA messages can be sent to mobile phones or devices to auto-configure the  
                            settings for WAP. They are actually complex SMS messages with UDH and sent as
                            concatenated messages if too long (and compiled if necessary).
                        </p>
                        <p>You may either pass an HTTP request as GET method or POST method to the 
                            HTTP interface.
                        </p>
                        <p>If you want to send a configuration that is defined within Kannel's 
                            configuration file itself you have to pass a valid 
                        <tt class="literal">ota-id</tt> value otherwise the content of the request will 
                        be compiled to as OTA message.
                        </p>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN5279">OTA settings and bookmark documents</a></h4>
                            <p>
                                Here is an example XML document (this one contains CSD settings for logging
                                in to a mobile service; note that you must store DTD locally):
                            </p>
                            <pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE CHARACTERISTIC-LIST SYSTEM "file:///gw/settings.dtd"&gt;
&lt;CHARACTERISTIC-LIST&gt;

  &lt;CHARACTERISTIC TYPE="ADDRESS"&gt;
    &lt;PARM NAME="BEARER" VALUE="GSM/CSD"/&gt;
    &lt;PARM NAME="PROXY" VALUE="10.11.12.13"/&gt;
    &lt;PARM NAME="PORT" VALUE="9201"/&gt;
    &lt;PARM NAME="CSD_DIALSTRING" VALUE="+12345678"/&gt;
    &lt;PARM NAME="PPP_AUTHTYPE" VALUE="PAP"/&gt;
    &lt;PARM NAME="PPP_AUTHNAME" VALUE="yourusername"/&gt;
    &lt;PARM NAME="PPP_AUTHSECRET" VALUE="yourauthsecret"/&gt;
    &lt;PARM NAME="CSD_CALLTYPE" VALUE="ISDN"/&gt;
    &lt;PARM NAME="CSD_CALLSPEED" VALUE="9600"/&gt;
  &lt;/CHARACTERISTIC&gt;

  &lt;CHARACTERISTIC TYPE="URL" 
                  VALUE="http://wap.company.com/"/&gt;

  &lt;CHARACTERISTIC TYPE="NAME"&gt;
    &lt;PARM NAME="NAME" VALUE="Your WAP Company"/&gt;
  &lt;/CHARACTERISTIC&gt;

&lt;/CHARACTERISTIC-LIST&gt;
                            </pre>
                            A bookmark document looks like this:
                            <pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE CHARACTERISTIC_LIST SYSTEM "file:///gw/settings.dtd"&gt;
&lt;CHARACTERISTIC-LIST&gt;
  &lt;CHARACTERISTIC TYPE="BOOKMARK"&gt;
    &lt;PARM NAME="NAME" VALUE="WAP Company"/&gt;
    &lt;PARM NAME="URL" VALUE="http://wap.company.com/"/&gt;
  &lt;/CHARACTERISTIC&gt;
&lt;/CHARACTERISTIC-LIST&gt;
                            </pre>
                            Document type definition (DTD) for these documents is not
                            available from Internet, you must supply it as a file. Kannel
                            gw directory contains an
                            example, <tt class="literal">settings.dtd</tt>.
                            <p></p>
                        </div>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN5285">OTA syncsettings documents</a></h4>
                            <p>Used for the provisioning of sync configuration to
                                SyncMl enabled handsets. Best supported by sonyericcsson
                                terminals.
                            </p>
                            <p>Sample syncsettings documents to set contacts, connection data
                                and authentication:
                            </p>
                            <pre class="programlisting">
&lt;SyncSettings&gt;
&lt;Version&gt;1.0&lt;/Version&gt;
&lt;HostAddr&gt;http://syncml.server.com&lt;/HostAddr&gt;
&lt;RemoteDB&gt;
  &lt;CTType&gt;text/x-vcard&lt;/CTType&gt;
  &lt;CTVer&gt;2.1&lt;/CTVer&gt;
  &lt;URI&gt;contact&lt;/URI&gt;
  &lt;Name&gt;Address Book&lt;/Name&gt;
&lt;/RemoteDB&gt;
&lt;Name&gt;Synchonization&lt;/Name&gt;
&lt;Auth&gt;
  &lt;AuthLevel&gt;1&lt;/AuthLevel&gt;
  &lt;AuthScheme&gt;1&lt;/AuthScheme&gt;
  &lt;Username&gt;yourusername&lt;/Username&gt;
  &lt;Cred&gt;passwordbase64encoded&lt;/Cred&gt;
&lt;/Auth&gt;
&lt;/SyncSettings&gt;
                            </pre>
                            <p></p>
                        </div>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN5290">OMA provisioning content</a></h4>
                            <p>OMA provisioning allows the configuration of a wider
                                range of settings than previously available in OTA
                                terminals. Refer to OMA-WAP-ProvCont-v1_1-20021112-C (at
                                http://www.openmobilealliance.org/tech/docs/) for details.
                            </p>
                            <p>A shared secret (i.e. a pin or the phone IMSI) can be
                                used to authenticate the settings. Defaults are 'userpin'
                                and '1234' a. See the cgi variables 'sec' and 'pin' for
                                available authentication options.
                            </p>
                        </div>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN5294">GET method for the OTA HTTP interface</a></h4>
                            <p>An example URL (OTA configuration defined in the Kannel 
                                configuration file):
                            </p>
                            <pre class="screen"><kbd class="userinput">
	http://smsbox.host.name:13013/cgi-bin/sendota?
	    otaid=myconfig&amp;username=foo&amp;password=bar&amp;to=0123456
	</kbd></pre>
                            URL containing XML document looks like this (you must URL encode it before sending
                            it over HTTP): 
                            <pre class="screen"><kbd class="userinput">
	http://smsbox.host.name:13013/cgi-bin/sendota?
	    username=foo&amp;password=bar&amp;to=0123456&amp;
	    text=MyURLEncodedXMLdocument&amp;type=settings
	</kbd></pre>
                            You can send either settings, bookmark, syncsettings, or
                            oma-settings, set CGI variable type accordingly.  Default for
                            this variable is settings.
                            <p></p>
                            <div class="table">
                                <a name="AEN5301"></a>
                                <p><b>Table 7-18. OTA CGI Variables</b></p>
                                <table frame="void" class="CALSTABLE" border="0">
                                    <colgroup>
                                        <col>
                                        <col>
                                        <col>
                                    </colgroup>
                                    <tbody>
                                        <tr>
                                            <td><tt class="literal">otaid</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Name or ID of the 'ota-setting' group in Kannel configuration
                                        that should be sent to the phone. This variable is optional.
                                        If it is not given the first 'ota-setting' group is sent. This
                                        is unnecessary when a XML document is send to the phone.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">username</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Username of the 'sendsms-user' group in Kannel configuration, that has
                                        been configured to send OTA messages.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">password</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Password associated with given <tt class="literal">username</tt>. Must match
                                    corresponding field in 'sendsms-user' group in Kannel configuration, or
                                    'Authorization failed' is returned.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">to</tt></td>
                                    <td><tt class="literal">number</tt></td>
                                    <td valign="bottom">
                                        Number of the phone that is to receive the OTA configuration message.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">from</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Phone number of the sender. This field is usually overridden by
                                        the SMS Center, or it can be overridden by faked-sender
                                        variable in the sendsms-user group. If this variable is not
                                        set, smsbox global-sender is used.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">smsc</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Optional virtual smsc-id from which the message is supposed to 
                                        have arrived. This is used for routing purposes, if any denied
                                        or preferred SMS centers are set up in SMS center
                                        configuration. This variable can be overridden with a
                                    <tt class="literal">forced-smsc</tt> configuration
                                    variable. Likewise, the <tt class="literal">default-smsc</tt> variable
                                    can be used to set the SMSC if it is not set otherwise.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">text</tt></td>
                                    <td><tt class="literal">XML document</tt></td>
                                    <td valign="bottom">
                                        An URL encoded XML document, containing either settings or bookmarks.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">type</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Type of the XML document, supported values are "settings",
                                        "bookmarks", "syncsettings", and "oma-settings". Default is "settings".
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">sec</tt></td>
                                    <td><tt class="literal">string</tt></td>
                                    <td valign="bottom">
                                        Security model used to authenticate oma-settings. One of:
                                        "userpin", "netwpin", "usernetwpin", or "userpinmac".
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">pin</tt></td>
                                    <td><tt class="literal">number</tt></td>
                                    <td valign="bottom">
                                        Authentication token.
                                    </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="ppg"></a>Chapter 8. Setting up Push Proxy Gateway</h1>
                <p>This chapter explains how to set up a push proxy gateway (PPG). 
                    An example configuration file are given. A working push proxy gateway
                    is described. Routing wap pushes to a certain smsc and asking for
                    <span class="emphasis"><i class="emphasis">SMS level</i></span> delivery reports are described.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5372">Configuring ppg core group, for push initiator (PI) interface</a></h2>
                    <p>PPG configuration group defines gateway's service interface.
                        Configuring a PPG working with a trusted PI is easiest. Actually,
                        you need no configuration at all: in this case a PPG with default 
                        values will be set up. Do not rely on this, default values may change.
                        For PPG core configuration variables, see table 7.1.
                    </p>
                    <p>An example of a core configuration for PPG working only with 
                        specific addresses follows. Note that ppg-deny-ip-list is not actually 
                        necessary, but does make configuring simpler: IPs here are always denied,
                        even when they are mentioned in the allowed IPs list.
                    </p>
                    <p>Ppg-url is a simple stamp, used for routing requests to the right 
                        service. You can change this stamp by setting <tt class="literal">push-url</tt> 
                    configuration variable.
                    </p>
                    <pre class="programlisting">
group = ppg
ppg-url = /wappush
ppg-port = 8080
concurrent-pushes = 100
users = 1024
ppg-allow-ip = 194.100.32.125;127.0.0.1
ppg-deny-ip = 194.100.32.89;194.100.32.103
trusted-pi = false
                    </pre>
                    <div class="table">
                        <a name="AEN5379"></a>
                        <p><b>Table 8-1. PPG core group configuration variables</b></p>
                        <table frame="void" class="CALSTABLE" border="0">
                            <colgroup>
                                <col>
                                <col>
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Variable</th>
                                    <th>Value</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><tt class="literal">group</tt></td>
                            <td><span class="emphasis"><i class="emphasis">ppg</i></span></td>
                            <td valign="bottom">
                                Mandatory value. Tells that we are configuring the PPG group.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ppg-port</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number</i></span></td>
                            <td valign="bottom">
                                The port PPG is listening at. Default 8080.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ppg-ssl-port (o)</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number</i></span></td>
                            <td valign="bottom">
                                Mandatory value for PPG HTTPS support. The port at which PPG listens
                                for HTTPS requests. There are no defaults; you must set the value 
                                separately.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ssl-server-cert-file</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Mandatory value for PPG HTTPS support. The file containing server's ssl
                                certificate.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ssl-server-key-file</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Mandatory value for PPG HTTPS support. The file containing server's ssl
                                private key.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ppg-url</tt></td>
                            <td><span class="emphasis"><i class="emphasis">url</i></span></td>
                            <td valign="bottom">
                                URL locating PPG services. Default <tt class="literal">/wappush
                            </tt>.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">global-sender</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Sender phone number required by some protocols.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">concurrent-pushes</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number</i></span></td>
                            <td valign="bottom">
                                Number of concurrent pushes expected. Note that PPG <span class="emphasis"><i class="emphasis">
                                        does</i></span> work even value is too low; it will only be 
                                slower. Default 100.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">users</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number</i></span></td>
                            <td valign="bottom">
                                Number of actually configured user accounts. Note that PPG 
                                <span class="emphasis"><i class="emphasis">does</i></span> work even value is too low; it will 
                                only be slower. Default 1024.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">trusted-pi</tt></td>
                            <td><span class="emphasis"><i class="emphasis">boolean</i></span></td>
                            <td valign="bottom">
                                If true, PI does authentication for PPG. Obviously, both of them
                                must reside inside same firewall. Default true. If this variable
                                is true, all security variables are ignored (even though they
                                may be present).
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ppg-deny-ip</tt></td>
                            <td><span class="emphasis"><i class="emphasis">ip-list</i></span></td>
                            <td valign="bottom">
                                PPG will not accept pushes from these IPs. Wild-cards are allowed.
                                If this attribute is missing, no IP is denied <span class="emphasis"><i class="emphasis"> by this
                                        list </i></span>.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ppg-allow-ip</tt></td>
                            <td><span class="emphasis"><i class="emphasis">ip-list</i></span></td>
                            <td valign="bottom">
                                PPG will accept pushes from these, and only these, IPs. Wild-cards
                                are allowed. Adding this list means that IPs not mentioned are 
                                denied, too.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">default-smsc</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                If no SMSC ID is given with the wappush HTTP request (see below), use
                                this one as default route for all push messages.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">default-dlr</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                If no dlr url is given with the wappush HTTP request (see below), use
                                this one as default route for all push messages.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ppg-smsbox-id</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                All ppg delivery reports are handled by this smsbox. This routes all
                                DLR messages inside beaerbox to the specified smsbox for processing
                                the HTTP requests to the DLR-URL.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">service-name</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                This is sms service name used by smsbox for wap push.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">default-dlr</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                If no dlr url is given with the wappush HTTP request (see below), use
                                this one as default route for all push messages.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">service-name</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                This is sms service name used by smsbox for wap push..
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">concatenation</tt></td>
                            <td><span class="emphasis"><i class="emphasis">boolean</i></span></td>
                            <td valign="bottom">
                                Segment wap push binary sms. Default on. You need
                                not normally set this value.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">max-messages</tt></td>
                            <td><span class="emphasis"><i class="emphasis">integer</i></span></td>
                            <td valign="bottom">
                                Maximum number of sm messages generated. Default
                                10. You need not set this variable, expect when 
                                your push documents are <span class="emphasis"><i class="emphasis">very</i></span>
                                long.
                            </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5513">Configuring PPG user group variables</a></h2>
                    <p>In addition of pi lists similar to the core group, ppg 
                        configuration specific to a certain user contains variables used for
                        authentication and enforcing restrictions to phone numbers pi may 
                        contact. All variables are elaborated in table 7.2.
                    </p>
                    <p>As an example, let us see how to configure a ppg user (a pi, 
                        named here 'picom') allowed to send pushes only from a specified ip.
                    </p>
                    <pre class="programlisting">
group = wap-push-user
wap-push-user = picom
ppg-username = foo
ppg-password = bar
allow-ip = 62.254.217.163
                    </pre>
                    <p>It goes without saying that in real systems you must use more
                        complex passwords than bar.
                    </p>
                    <div class="table">
                        <a name="AEN5519"></a>
                        <p><b>Table 8-2. PPG user group configuration variables</b></p>
                        <table frame="void" class="CALSTABLE" border="0">
                            <colgroup>
                                <col>
                                <col>
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Variable</th>
                                    <th>Value</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><tt class="literal">group</tt></td>
                            <td><span class="emphasis"><i class="emphasis">wap-push-user</i></span></td>
                            <td valign="bottom">
                                Mandatory value. Tells that we are configuring the users group.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">wap-push-user</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                (More) human readable name of an user.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ppg-username</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Username for this user.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ppg-password</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Password for this user.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">allowed-prefix</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number-list</i></span></td>
                            <td valign="bottom">
                                Phone number prefixes allowed in pushes coming from this pi. These
                                prefixes must conform international phone number format.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">denied-prefix</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number-list</i></span></td>
                            <td valign="bottom">
                                Phone number prefixes denied in pushes coming from this pi. These
                                prefixes must conform international phone number format.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">white-list</tt></td>
                            <td><span class="emphasis"><i class="emphasis">url</i></span></td>
                            <td valign="bottom">
                                Defines an url where from the white-list can be fetched. White list
                                itself contains list of phone numbers accepting pushes from this 
                                pi.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">black-list</tt></td>
                            <td><span class="emphasis"><i class="emphasis">url</i></span></td>
                            <td valign="bottom">
                                Defines an url where from the blacklist can be fetched. Blacklist 
                                itself contains list of phone number not accepting pushes from 
                                this pi.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">allow-ip</tt></td>
                            <td><span class="emphasis"><i class="emphasis">ip-list</i></span></td>
                            <td valign="bottom">
                                Defines IPs where from this pi can do pushes. Adding this list 
                                means that IPs not mentioned are denied.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">deny-ip</tt></td>
                            <td><span class="emphasis"><i class="emphasis">ip-list</i></span></td>
                            <td valign="bottom">
                                Defines IPs where from this pi cannot do pushes. IPs not mentioned
                                in either list are denied, too.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">default-smsc</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                If no SMSC ID is given with the wappush HTTP request (see below), use
                                this one as default route for this specific push user.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">forced-smsc</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Allow only routing to a defined SMSC ID for this specific push user.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">dlr-url</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                If no dlr  is given with the wappush HTTP request (see below), use
                                this one as default route for this specific push user.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">smsbox-id</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Smsbox handling delivery reports fro this user.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">forced-smsc</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Allow only routing to a defined SMSC ID for this specific push user.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">white-list-regex</tt></td>
                            <td>POSIX regular expression</td>
                            <td valign="bottom">
                                Defines the set of phone-numbers accepting pushes from this 
                                pi.
                                See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">black-list-regex</tt></td>
                            <td>POSIX regular expression</td>
                            <td valign="bottom">
                                Defines the set of phone-numbers rejecting pushes from this 
                                pi.
                                See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">allowed-prefix-regex</tt></td>
                            <td>POSIX regular expression</td>
                            <td valign="bottom">
                                Set of phone number prefixes allowed in pushes coming from this pi. 
                                See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">denied-list-regex</tt></td>
                            <td>POSIX regular expression</td>
                            <td valign="bottom">
                                Set of phone number prefixes denied in pushes coming from this pi. 
                                See section on <a href="#regular-expressions">Regular Expressions</a> for details.
                            </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5642">Finishing ppg configuration</a></h2>
                    <p>PPG uses SMS for sending SI to the phone and an IP bearer to
                        fetch content specified by it (see chapter Overview of WAP Push). This
                        means both wapbox and bearer smsc connections are in use. So your push 
                        proxy gateway configuration file must contain groups core, wapbox, smsc 
                        and smsbox. These are configured normal way, only smsc group may have 
                        push-specific variables. Note that following configurations are only an 
                        example, you may need more complex ones.
                    </p>
                    <p>Bearerbox setup does not require any new variables:</p>
                    <pre class="programlisting">
group = core
admin-port = 13000
smsbox-port = 13001
wapbox-port = 13002
admin-password = b
wdp-interface-name = "*"
log-file = "filename"
log-level = 1
box-deny-ip = "*.*.*.*"
box-allow-ip = "127.0.0.1"
unified-prefix = "00358,0"
                    </pre>
                    <p>You must set up wapbox, for pulling (fetching) the wap data, and
                        of course starting the push itself. No new variables here, either.
                    </p>
                    <pre class="programlisting">
group = wapbox
bearerbox-host = localhost
log-file = "filename"
log-level = 0
syslog-level = none
                    </pre>
                    <p>To set up smsc connections, for pushing SI or SL over SMS. Here
                        HTTP SMSC is used as an example. Variables no-sender and no-coding 
                        simplify HTTP request generated by Kannel. Send-url specifies content 
                        gateway, or sendsms service.
                    </p>
                    <pre class="programlisting">
group = smsc
smsc = http
smsc-id = HTTP
port = 10000
system-type = kannel
smsc-username = foo
smsc-password = bar
no-sender = true
no-coding = true
send-url = http://host:port/path
                    </pre>
                    <p>To set up smsbox. This is used for ppg delivery reports,
                        see later.
                    </p>
                    <pre class="programlisting">
group = smsbox
bearerbox-host = localhost
smsbox-id = dlrbox
                    </pre>
                    <p>Kannel sources contain a sample push configuration file 
                    <tt class="literal">gw/pushkannel.conf</tt>.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5655">Running a push proxy gateway</a></h2>
                    <p>Push proxy gateway is started by simply typing, using separate 
                        windows:
                    </p>
                    <pre class="screen"><kbd class="userinput">
	gw/bearerbox [config-file]
	gw/wapbox [config-file]
	</kbd></pre>
                    You can, of course, use more complex command line options.
                    <p></p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5660">An example using HTTP SMSC</a></h2>
                    <p>An easy way to test and implement push services is to put ppg
                        in the front of an existing sendsms service capable to send SMS data
                        messages and to understand HTTP requests generated by HTTP SMSC.
                        (See next chapter.) Then you need only configure SMSC configuration 
                        send-url to point to sendsms service.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5663">An example of minimum SI document</a></h2>
                    <p> Service indication (SI) should work with all types of
                        phones, service loading does not. URL to be loaded is the
                        main content of the document in both cases, however. Here an 
                        example (this is a minimum si document, not usable for testing,
                        probably, but you want PPG to generate only one one SM per 
                        SI, if at all possible):
                    </p>
                    <pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE si PUBLIC "-//WAPFORUM//DTD SI 1.0//EN"
"http://www.wapforum.org/DTD/si.dtd"&gt;
&lt;si&gt;
    &lt;indication href="http://www.gni.ch"
        si-id="1@gni.ch"&gt;
            You have 4 new emails
    &lt;/indication&gt;
&lt;/si&gt;
                    </pre>
                    <p>Note following points:
                        a) Every SI must have different si-id. If there are none,
                        href is used as an (very unsatisfactory) id.
                        b) this si should not interrupt the phone's current action.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5668">An example push (tokenized SI) document</a></h2>
                    <p>HTTP SMSC generates a HTTP get request when it get a send-message 
                        event, expressed in Unicode. The content gateway, or the sendsms 
                        service must, of course, understand this URL. So here is an example,
                        cgi variable text contains the url escaped form of a SI document. It is
                        usable for testing prototype phones.
                    </p>
                    <pre class="screen"><kbd class="userinput">
	http://matrix:8080/phplib/kannelgw.php?user=*deleted*&amp;
	pass=*deleted*=to=%2B358408676001&amp;text=3D%02%06%17%AE%96localhost
	%3A8080%00%AF%80%8D%CF%B4%80%02%05j%00E%C6%0C%03wap.iobox.fi%00%11%03
	1%40wiral.com%00%07%0A%C3%07%19%99%06%25%15%23%15%10%C3%04+%02%060%01
	%03Want+to+test+a+fetch%3F%00%01%01&amp;udh=%06%05%04%0B%84%23%F0
	</kbd></pre>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5673">Default network and bearer used by push proxy gateway</a></h2>
                    <p> If network and bearer attributes of the pap control document are
                        missing or set any, Kannel uses address type for routing purposes: if
                        the address type is a phone number (TYPE=PLMN), network defaults to GSM
                        and bearer to SMS; if it is a IP-address (TYPE=IPv4), network defaults
                        to GSM and bearer to CSD. So following minimal pap document works:
                    </p>
                    <pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE pap PUBLIC "-//WAPFORUM//DTD PAP//EN"
          "http://www.wapforum.org/DTD/pap_1.0.dtd"&gt;
&lt;pap&gt;
  &lt;push-message push-id="9fjeo39jf084@pi.com"&gt;
    &lt;address address-value="WAPPUSH=+358408676001/TYPE=PLMN@ppg.carrier.com"/&gt;
  &lt;/push-message&gt;
&lt;/pap&gt;
                    </pre>
                    <p></p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5677">Push related Kannel headers</a></h2>
                    <p>This chapter recapitulates Kannel headers used by ppg.</p>
                    <p>PPG uses many Kannel headers. These are very similar as ones
                        used by smsbox. (Both send sms to to the phone, after all.)
                    </p>
                    <div class="table">
                        <a name="AEN5681"></a>
                        <p><b>Table 8-3. Kannel headers used by PPG</b></p>
                        <table frame="void" class="CALSTABLE" border="0">
                            <colgroup>
                                <col>
                                <col>
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Variable</th>
                                    <th>Value</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><tt class="literal">X-Kannel-SMSC</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">Name of smsc used to deliver this push.
                                Smsc configuration must contain some of corresponding variables, 
                                see 
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">X-Kannel-DLR-URL</tt></td>
                            <td><span class="emphasis"><i class="emphasis">url</i></span></td>
                            <td valign="bottom">Url smsbox would call this url when doing 
                                the delivery report. Note that it can contain all Kannel escapes.
                                See table 6.7 for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">X-Kannel-DLR-Mask</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number</i></span></td>
                            <td valign="bottom">Mask telling smsbox when it should do
                                the delivery reports. Values are same as used by smsbox, see
                                chapter Delivery Reports for details.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">X-Kannel-Smsbox-Id</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">Tells which smsbox does the delivery
                                report. Smsbox configuration must contain corresponding 
                                variable.
                            </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5714">Requesting SMS level delivery reports for WAP pushes</a></h2>
                    <p>Push content is a normal binary SM, so you can ask delivery 
                        reports for them. These are useful for testing purposes (did the
                        phone get the content at all, or did it just reject it.) Another
                        use is create fall-back services for phones not supporting displaying
                        a specific push content. (MMS one being perhaps currently most
                        obvious.) Generally speaking, this service is very similar to 
                        smsbox one. See chapter Delivery Reports for details.
                    </p>
                    <p> For ppg sms delivery reports you will need a fully working 
                        smsbox. Add configuration variable <tt class="literal">smsbox-id</tt> to
                    <tt class="literal">smsbox</tt> group (it is necessary, because there
                    is no MT from any smsbox corresponding the delivery report 
                    bearerbox is receiving):
                    </p>
                    <pre class="programlisting">
       group = smsbox
       smsbox-id = dlrbox
       bearerbox-host = localhost
       log-file = "/var/log/kannel/smsbox-core.log"
       log-level = 0
       access-log = "/var/log/kannel/smsbox-access.log"
                    </pre>
                    <p> Start smsbox normal way after updating the configuration
                        file. 
                    </p>
                    <p> You must add to PPG configuration file two less obvious
                        variables: <tt class="literal">ppg-smsbox-id</tt> and <tt class="literal">
                        service-name</tt>. <tt class="literal">Ppg-smsbox-id</tt> 
                    defines smsbox through which you want to route delivery reports,
                    <tt class="literal">service-name</tt> makes possible for smsbox to
                    handle wap pushes as a separate sms service.
                    </p>
                    <p>Setting <tt class="literal">ppg-smsbox-id</tt> will route all
                    ppg messages through same smsbox. You can route delivery 
                    reports of separate user through separate smsboxes, by using
                    configuration variable <tt class="literal">smsbox-id</tt> in group
                    wap push user. Or you can use <tt class="literal">X-Kannel-Smsbox-Id
                    </tt>. This means routing every message separately. 
                    </p>
                    <p> You can supply dlr url and dlr mask as kannel header, or
                        as a configuration variable in ppg user or ppg core group. (This
                        is order of precedence, too.) First one is valid for only one
                        message, second for a specific user, and third for every ppg
                        user. 
                    </p>
                    <p> So following is a minimum ppg core group for sms delivery
                        reports:
                    </p>
                    <pre class="programlisting">
group = ppg
ppg-url = /wappush
ppg-port = 8080
concurrent-pushes = 100
trusted-pi = true
users = 1024
service-name = ppg
ppg-smsbox-id = dlrbox
                    </pre>
                    <p>And you can add Kannel headers to http post request. Here
                        an example code snippet (C using Kannel gwlib; this example asks
                        for all possible delivery reports).
                    </p>
                    <pre class="programlisting">
http_header_add(push_headers, "X-Kannel-SMSC", "link0");
http_header_add(push_headers, "X-Kannel-DLR-Url",
                "http://193.53.0.56:8001/notification-dlr?smsc-id=%i"
                "&amp;status=%d&amp;answer=%A&amp;to=%P&amp;from=%p&amp;ts=%t");
http_header_add(push_headers, "X-Kannel-DLR-Mask",
                octstr_get_cstr(dos = octstr_format("%d", 31)));
http_header_add(push_headers, "X-Kannel-Smsbox-Id", "dlrbox"));
                    </pre>
                    <p>Here status=%d tells the type of the delivery report and
                        answer=%A the delivery report itself (sms content of it).
                        Other ones are needed to map delivery report to original wap
                        push.
                    </p>
                    <p>With these  you can use with following http post request</p>
                    <pre class="screen"><kbd class="userinput">
       http://193.53.0.56:8080/phplib/kannelgw.php?user=*deleted*&amp;
       pass=*deleted*=to=%2B358408676001&amp;text=3D%02%06%17%AE%96localhost
       %3A8080%00%AF%80%8D%CF%B4%80%02%05j%00E%C6%0C%03wap.iobox.fi%00%11%03
       1%40wiral.com%00%07%0A%C3%07%19%99%06%25%15%23%15%10%C3%04+%02%060%01
       %03Want+to+test+a+fetch%3F%00%01%01&amp;udh=%06%05%04%0B%84%23%F0
</kbd></pre>
                    <p>Note that you can use all sms service escapes in dlrurl, see
                        Parameters (Escape Codes) for details.
                    </p>
                    <p> If you want to set dlr url for a specific user, you must set
                        configuration variable <tt class="literal">dlr-url</tt>in <tt class="literal">
                        wap-push-user</tt>, if for entire ppg, <tt class="literal">default-dlr-url
                    </tt> in group <tt class="literal">ppg</tt>. Value must naturally match
                    with one used in group smsc.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5746">Routing WAP pushes to a specific smsc</a></h2>
                    <p> This chapter explains how to route wap push to a specific
                        smsc. 
                    </p>
                    <p> Smsc routing for wap pushes is similar to sms pushes. So,
                        firstly you must define configuration variable <tt class="literal">smsc-id
                    </tt> in smsc group (or groups) in question. Say you used
                    value <tt class="literal">link0</tt>. You can send this as a Kannel
                    header:
                    </p>
                    <pre class="programlisting">
http_header_add(push_headers, "X-Kannel-SMSC", "link0");
                    </pre>
                    <p>Then you can issue a request:</p>
                    <pre class="screen"><kbd class="userinput">
       http://193.53.0.56:8080/phplib/kannelgw.php?user=*deleted*&amp;
       pass=*deleted*=to=%2B358408676001&amp;text=3D%02%06%17%AE%96localhost
       %3A8080%00%AF%80%8D%CF%B4%80%02%05j%00E%C6%0C%03wap.iobox.fi%00%11%03
       1%40wiral.com%00%07%0A%C3%07%19%99%06%25%15%23%15%10%C3%04+%02%060%01
       %03Want+to+test+a+fetch%3F%00%01%01&amp;udh=%06%05%04%0B%84%23%F0
</kbd></pre>
                    <p> You can use configuration variables to route all messages of a
                        specific user or all ppg messages. Set <tt class="literal">default-smsc</tt>
                    in group wap-push-user or in group ppg.
                    </p>
                    <p>Again precedence of various methods of setting the smsc is 
                        kannel header, then configuration variable in group wap push user and
                        then in group ppg.
                    </p>
                </div>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="ssl-enabling"></a>Chapter 9. Using SSL for HTTP</h1>
                <p>This chapter explains how you can use SSL to ensure
                    secure HTTP communication on both, client and server side.
                </p>
                <p>Beware that the gateway, is acting in both roles of
                    the HTTP model:
                </p>
                <p></p>
                <ol type="1">
                    <li>
                        <p>as HTTP client, i.e. for requesting URLs 
                            while acting as WAP gateway and while fetching information
                            for the SMS services.
                        </p>
                    </li>
                    <li>
                        <p>as HTTP server, i.e. for the administration HTTP
                            interface, the PPG and for the sendsms HTTP interface.
                        </p>
                    </li>
                </ol>
                That is why you can specify separate certification files within
                the core group to be used for the HTTP sides.
                <p></p>
                <p>You can use one or both sides of the SSL support. There 
                    is no mandatory to use both if only one is desired.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5769">Using SSL client support</a></h2>
                    <p>To use the client support please use the following
                        configuration directive within the core group
                    </p>
                    <pre class="programlisting">
group = core
...
ssl-client-certkey-file = "filename"
                    </pre>
                    <p>Now you are able to use https:// scheme URLs within 
                        your WML decks and SMS services.
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5774">Using SSL server support for the administration HTTP
                            interface</a>
                    </h2>
                    <p>To use the SSL-enabled HTTP server please use the 
                        following configuration directive within the core group
                    </p>
                    <pre class="programlisting">
group = core
...
admin-port-ssl = true
...
ssl-server-cert-file = "filename"
ssl-server-key-file = "filename"
                    </pre>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5778">Using SSL server support for the sendsms HTTP
                            interface</a>
                    </h2>
                    <p>To use the SSL-enabled HTTP server please use the 
                        following configuration directive within the core and 
                        smsbox groups
                    </p>
                    <pre class="programlisting">
group = core
...
ssl-server-cert-file = "filename"
ssl-server-key-file = "filename"

group = smsbox
...
sendsms-port-ssl = true
                    </pre>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5782">Using SSL server support for PPG HTTPS interface</a></h2>
                    <p>
                        If you want use PAP over HTTPS, (it is, a https scheme) add following 
                        directives to the ppg core group:
                    </p>
                    <pre class="programlisting">
group = ppg
...
ppg-ssl-port = 8090
ssl-server-cert-file = "/etc/kannel/cert1.pem"
ssl-server-key-file = "/etc/kannel/key1.pem"
                    </pre>
                    <p></p>
                    <p>
                        PPG uses a separate port for HTTPS traffic, so so you must define it. This
                        means that you can use both HTTP and HTTPS, when needed.
                    </p>
                </div>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="delivery-reports"></a>Chapter 10. SMS Delivery Reports</h1>
                <p>This chapter explains how to set up Kannel to deliver delivery reports.
                </p>
                <p>Delivery reports are a method to tell your system if the message
                    has arrived on the destination phone. There are different things which can happen
                    to a message on the way to the phone which are:
                </p>
                <p>
                </p>
                <p></p>
                <ul>
                    <li>
                        <p>Message gets rejected by the SMSC (unknown subscriber, invalid destination number etc).</p>
                    </li>
                    <li>
                        <p>Message gets accepted by the SMSC but the phone rejects the message.</p>
                    </li>
                    <li>
                        <p>Message gets accepted by the SMSC but the phone is off or out of reach.
                            The message gets buffered.
                        </p>
                    </li>
                    <li>
                        <p>Message gets successfully delivered.</p>
                    </li>
                </ul>
                <p></p>
                <div class="note">
                    <blockquote class="note">
                        <p><b>Note: </b>If you want to use delivery reports, you must define a <tt class="literal">smsc-id</tt> for each smsc group.</p>
                    </blockquote>
                </div>
                <p>When you deliver SMS to Kannel you have to indicate what kind of delivery report messages you
                    would like to receive back from the system. The delivery report types currently implemented are:
                </p>
                <p></p>
                <ul>
                    <li>
                        <p>1: delivery success</p>
                    </li>
                    <li>
                        <p>2: delivery failure</p>
                    </li>
                    <li>
                        <p>4: message buffered</p>
                    </li>
                    <li>
                        <p>8: smsc submit</p>
                    </li>
                    <li>
                        <p>16: smsc reject</p>
                    </li>
                    <li>
                        <p>32: smsc intermediate notifications</p>
                    </li>
                </ul>
                If you want multiple report types, you simply add the values together. For example if you want to get delivery success and/or failure
                you set the <tt class="literal">dlr-mask</tt> value to 1+2. and so on. If you specify <tt class="literal">dlr-mask</tt> on the URL you pass on to
                Kannel you also need to specify <tt class="literal">dlr-url</tt>. <tt class="literal">dlr-url</tt> should contain the URL to which
                Kannel should place a HTTP requests once the delivery report is ready to be delivered back to your system.
                <p></p>
                <p>
                    An example transaction would work as following.
                </p>
                <p></p>
                <ul>
                    <li>
                        <p>1. you send a message using dlr-mask=7 and dlr-url=http://www.xyz.com/cgi/dlr.php?myId=123456&amp;type=%d</p>
                    </li>
                    <li>
                        <p>2. Kannel forwards the message to the SMSC and keeps track of the message</p>
                    </li>
                    <li>
                        <p>3. The SMSC can not reach the phone and thus returns a buffered message</p>
                    </li>
                    <li>
                        <p>4. Kannel calls http://www.xyz.com/cgi/dlr.php?myId=123456&amp;type=4 to indicate the message being buffered</p>
                    </li>
                    <li>
                        <p>5. The phone is switched on and the SMS gets delivered from the SMSC. The SMSC reports this to Kannel</p>
                    </li>
                    <li>
                        <p>6. Kannel calls http://www.xyz.com/cgi/dlr.php?myId=123456&amp;type=1 to indicate the final success</p>
                    </li>
                </ul>
                <div class="note">
                    <blockquote class="note">
                        <p><b>Note: </b>
                            If you put your own message ID in the dlr-url like in the example above, you can then use this ID to update your database
                            with the message status.
                        </p>
                    </blockquote>
                </div>
                Depending on the SMSC type not all type of messages are supported. For example a CIMD SMSC does
                not support buffered messages. Also some SMSC drivers have not implemented all DLR types.
                <p></p>
            </div>
            <div class="chapter">
                <hr>
                <h1><a name="bug-reporting"></a>Chapter 11. Getting help and reporting bugs</h1>
                <p>This chapter explains where to find help with problems
                    related to the gateway, and the preferred procedure for reporting
                    bugs and sending corrections to them.
                </p>
                <p>The Kannel development mailing list is devel@kannel.org.  To subscribe, send mail to <a href="mailto:devel-subscribe@kannel.org" target="_top">devel-subscribe@kannel.org</a>.
                    This is currently the best location for asking help and reporting
                    bugs. Please include configuration file and version number.
                </p>
            </div>
            <div class="appendix">
                <hr>
                <h1><a name="upgrading-notes"></a>Appendix A. Upgrading notes</h1>
                <p>This appendix includes pertinent information about required
                    changes on upgrades.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5846">From 1.2.x or 1.3.1 to 1.3.2 and later</a></h2>
                    <p>
                    </p>
                    <p></p>
                    <ul>
                        <li>
                            <p>1. <tt class="literal">at</tt> module was dropped and <tt class="literal">at2</tt> module is now called <tt class="literal">at</tt></p>
                        </li>
                        <li>
                            <p>2. <tt class="literal">emi</tt> module was renamed to <tt class="literal">emi_x25</tt>, <tt class="literal">emi_ip</tt> sub-module was dropped and <tt class="literal">emi2</tt> is now called <tt class="literal">emi</tt>.</p>
                        </li>
                    </ul>
                    <p></p>
                </div>
            </div>
            <div class="appendix">
                <hr>
                <h1><a name="certificates"></a>Appendix B. Certificate generation</h1>
                <p>This appendix includes pertinent information about required SSL
                    certificate genaration, where needed.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5865">Self-signed 1024-bit RSA SSL certificates using openssl</a></h2>
                    <p>
                    </p>
                    <p></p>
                    <ol type="1">
                        <li>
                            <p>Generate private key:</p>
                            <p><tt class="literal">openssl genrsa -des3 -out server.key 1024</tt></p>
                        <p>You will be asked for a passphrase.</p>
                        </li>
                        <li>
                            <p>Generate a certificate request:</p>
                            <p><tt class="literal">
                            openssl req -new -key server.key -out server.csr
                        </tt>
                        </p>
                        <p>Several questions follow. At the end you may send server.csr
                            to a certificate authority, which in turn will sign it and
                            generate the certificate for you, or you can sign it yourself.
                        </p>
                        </li>
                        <li>
                            <p>Remove passphrase from key:</p>
                            <p><tt class="literal">cp server.key server.key.org</tt>
                        </p>
                        <p><tt class="literal">openssl rsa -in server.key.org -out server.key
                        </tt>
                        </p>
                        <p><tt class="literal">rm server.key.org</tt></p>
                        </li>
                        <li>
                            <p>Self-sign the certificate:</p>
                            <p>If you chose not to send the request to a Certificate
                                Authority, you will need to sign it yourself. This one is good
                                for 1 year:
                            </p>
                            <p><tt class="literal">openssl x509 -req -days 365 -in server.csr -signkey
                            server.key -out server.crt</tt>
                        </p>
                        </li>
                        <li>
                            <p>Move keys to desired location:</p>
                            <p><tt class="literal">mv server.crt /etc/kannel/public/server.crt</tt></p>
                        <p><tt class="literal">mv server.key /etc/kannel/private/server.key
                        </tt>
                        </p>
                        <p><tt class="literal">mv server.csr /etc/ianwap/private/ianwap.csr (key
                            request)</tt>
                        </p>
                        </li>
                    </ol>
                    <p></p>
                    <p>Update configuration accordingly</p>
                </div>
            </div>
            <div class="appendix">
                <hr>
                <h1><a name="AEN5901"></a>Appendix C. Using the fake WAP sender</h1>
                <p>This appendix explains how to use the fake WAP sender
                    to test the gateway.
                </p>
            </div>
            <div class="appendix">
                <hr>
                <h1><a name="AEN5904"></a>Appendix D. Using the fake SMS center</h1>
                <p>Fakesmsc is a simple testing tool to test out Kannel and
                    its SMS services. It <span class="emphasis"><i class="emphasis">cannot</i></span> be used to
                    send messages to mobile terminals, it is just a simulated SMS
                    center with no connection to real terminals.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5908">Setting up fakesmsc</a></h2>
                    <p>This section sums up needed steps to set up system for
                        fakesmsc use.
                    </p>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN5911">Compiling fakesmsc</a></h3>
                        <p>The fake SMS center should compile at the same time as main
                            Kannel compiles. The outcome binary,
                        <tt class="literal">fakesmsc</tt>, is in <tt class="literal">test</tt>
                        directory. The source code is quite simple and trivial, and is
                        easily edited.
                        </p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN5916">Configuring Kannel</a></h3>
                        <p>To use <tt class="literal">fakesmsc</tt> to test out Kannel, you
                        have to add it to main configuration file (see above). The
                        simplest form for this configuration group is like this:
                        </p>
                        <pre class="programlisting">
group = smsc
smsc = fake
port = 10000
                        </pre>
                        <p>The fakesmsc configuration group accepts all common 'smsc' 
                            configuration group variables, like <tt class="literal">smsc-id</tt>,
                        <tt class="literal">preferred-smsc-id</tt> or
                        <tt class="literal">denied-smsc-id</tt>, which can be used to test out
                        routing systems and diverted services, before setting up real
                        SMS center connections. If you include a fakesmsc group when
                        bearerbox is connected to real SMS centers, you should add
                        the <tt class="literal">connect-allow-ip</tt> variable to prevent
                        unauthorized use.
                        </p>
                        <p>To set up multiple fakesmsc'es, just add new
                            groups. Remember to put a different port number to each one.
                        </p>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5927">Running Kannel with fakesmsc connections</a></h2>
                    <p>After configuring Kannel, you can start testing
                        it. The bearerbox will listen for fakesmsc client connections
                        to the port(s) specified in the configuration file.
                    </p>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN5930">Starting fake SMS center</a></h3>
                        <p>Each fakesmsc is started from command line, with all sent
                            messages after command name. If any options are used (see below),
                            they are put between the command and the messages. The usage is as
                            follows:
                        </p>
                        <pre class="programlisting">
test/fakesmsc [options] &lt;message1&gt; [message2 ...]
                        </pre>
                        <p>Options and messages are explained below, but as a quick
                            example, a typical startup can go like this:
                        </p>
                        <pre class="programlisting">
test/fakesmsc -i 0.1 -m 100 "100 200 text nop" "100 300 text echo this"
                        </pre>
                        <p>This tells fakesmsc to connect to bearerbox at localhost:10000
                            (default) and send a hundred messages with an interval of 0.1 seconds.
                            Each message is from number 100, and is either to number 200 with
                            message 'nop' or to 300 with message 'echo this'.
                        </p>
                        <p>Messages received from bearerbox are shown in the same format
                            (described below).
                        </p>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN5938">Fake messages</a></h4>
                            <p>Each message consists of four or five parts: sender number,
                                receiver number, type, udh (if present) and main message itself.
                                Sender and receiver numbers do not mean anything except for log files
                                and number-based routing in Kannel.
                            </p>
                            <p>The parts of a message are separated with spaces. As each message is
                                taken as one argument, it must be put in quotation marks.
                            </p>
                            <p>Message type must be one of the following: "text", "data" and "udh".
                                Here's an example of using each:
                            </p>
                            <pre class="programlisting">
test/fakesmsc -i 0.01 -v 1 -m 1000 "100 300 text echo this message"
test/fakesmsc -i 0.01 -m 1000 "100 300 data echo+these+chars%03%04%7f"
test/fakesmsc -m 1 "100 500 udh %0eudh+stuff+here main+message"
                            </pre>
                            <p>For "text", the rest of the argument is taken as the literal
                                message. For "data", the next part must be the url-encoded version of
                                the message. Space is coded as '+'. For "udh", the next 2 parts
                                are the UDH and main message. Both must be in url-encoded form.
                            </p>
                            <p>If multiple messages are given, fakesmsc randomly chooses
                                one for each sending.
                            </p>
                        </div>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN5946">Interactive mode</a></h4>
                            <p>If no messages are passed on the command line when starting fakesmsc,
                                it runs on "interactive mode".
                            </p>
                            <p>When running on this mode, fakesmsc accept single messages typed on stdin
                                (without quotation marks) and displays the responses on stdout. This allows
                                for a more finely controlled interaction with the backend applications.
                            </p>
                        </div>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN5950">Fakesmsc command line options</a></h4>
                            <p>Fake SMS center can be started with various optional command
                                line arguments.
                            </p>
                            <div class="table">
                                <a name="AEN5953"></a>
                                <p><b>Table D-1. Fakesmsc command line options</b></p>
                                <table frame="void" class="CALSTABLE" border="0">
                                    <colgroup>
                                        <col>
                                        <col>
                                        <col>
                                    </colgroup>
                                    <thead>
                                        <tr>
                                            <th>Switch</th>
                                            <th>Value</th>
                                            <th>Description</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><tt class="literal">-H</tt></td>
                                    <td><span class="emphasis"><i class="emphasis">host</i></span></td>
                                    <td valign="bottom">
                                        Use host <span class="emphasis"><i class="emphasis">host</i></span> instead of default
                                    <tt class="literal">localhost</tt>.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">-r</tt></td>
                                    <td><span class="emphasis"><i class="emphasis">port</i></span></td>
                                    <td valign="bottom">
                                        Use port number <span class="emphasis"><i class="emphasis">port</i></span> instead of default
                                        10000.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">-i</tt></td>
                                    <td><span class="emphasis"><i class="emphasis">interval</i></span></td>
                                    <td valign="bottom">
                                        Use message interval <span class="emphasis"><i class="emphasis">interval</i></span> (in seconds,
                                        fractions accepted) instead of default interval 1.0 seconds.
                                    </td>
                                    </tr>
                                    <tr>
                                        <td><tt class="literal">-m</tt></td>
                                    <td><span class="emphasis"><i class="emphasis">max</i></span></td>
                                    <td valign="bottom">
                                        Send a maximum of <span class="emphasis"><i class="emphasis">max</i></span> messages. Value -1
                                        means that an unlimited number of messages is sent. Default -1.
                                        Using 0 can be useful to listen for messages sent via other
                                        channels.
                                    </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                            <p>In addition, fakesmsc accepts all common Kannel <a href="#arguments"><i>Command line options</i></a> like 
                            <tt class="literal">--verbosity</tt>.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="appendix">
                <hr>
                <h1><a name="AEN5994"></a>Appendix E. Setting up a test environment for Push Proxy Gateway</h1>
                <p>This appendix explains how to set a test environment for PPG. 
                    This contains a simulated SMSC, for instance a http server simulation
                    (this is used as example, because it is simplest) and a simulated
                    push initiator. Between them, there is the push proxy gateway to be
                    tested. This means that you must configure HTTP SMSC.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN5997">Creating push content and control document for testing</a></h2>
                    <p>
                        Here is an example of a push control document, which gives PPG 
                        instructions how to do the pushing.
                    </p>
                    <pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE pap PUBLIC "-//WAPFORUM//DTD PAP//EN"
          "http://www.wapforum.org/DTD/pap_1.0.dtd"&gt;
&lt;pap&gt;
  &lt;push-message push-id="9fjeo39jf084@pi.com"
                deliver-before-timestamp="2001-09-28T06:45:00Z"
                deliver-after-timestamp="2001-02-28T06:45:00Z"
                progress-notes-requested="false"&gt;
    &lt;address address-value="WAPPUSH=+358408676001/TYPE=PLMN@ppg.carrier.com"/&gt;
    &lt;quality-of-service priority="low"
                        delivery-method="unconfirmed"
                        network-required="true"
                        network="GSM"
                        bearer-required="true"
                        bearer="SMS"/&gt;
  &lt;/push-message&gt;
&lt;/pap&gt;
                    </pre>
                    Because the push content is send to the phone over SMS, right value for
                    <tt class="literal">network-required</tt> and <tt class="literal">bearer-required
                    </tt> is true, for <tt class="literal">network</tt> GSM and for <tt class="literal">bearer
                    </tt> SMS. However, you can omit these values altogether, if you use
                    a phone number as an address. Address value is international phone number and
                    it must start with plus. It is used here as an unique identifier, SMSC, or 
                    sendsms script must transform it to an usable phone number.
                    <p></p>
                    <p>
                        Here is an example of Service Indication, a type of push content. 
                        Essentially, the phone displays, when it receives this SI, the text 
                        "Want to test a fetch" and if the user wants, fetches the content 
                        located by URL <tt class="literal">http://wap.iobox.fi</tt>.
                    </p>
                    <pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE si PUBLIC "-//WAPFORUM//DTD SI 1.0//EN"
          "http://www.wapforum.org/DTD/si.dtd"&gt;
&lt;si&gt;
  &lt;indication href="http://wap.iobox.fi"
              si-id="1@wiral.com"
              action="signal-high"
              created="1999-06-25T15:23:15Z"
              si-expires="2002-06-30T00:00:00Z"&gt;
    Want to test a fetch?
  &lt;/indication&gt;
&lt;/si&gt;
                    </pre>
                    Note that the date value of the si-expires attribute contains trailing
                    zeroes. They are OK here, because SI tokenizer removes them. But phones
                    does not accept them in the final SMS data message. You should probably
                    use <tt class="literal">action="signal-high"</tt> for testing purposes, for
                    it causes an immediate presentation of the push message. Production
                    usage is a quite another matter.
                    <p></p>
                    <p>
                        Another example of push content is Service Loading. In principle, the phone
                        should fetch immediately content from URL <tt class="literal">http://wap.iobox.fi
                    </tt> when it receives this document. This sounds quite insecure, and
                    indeed, user invention is probably required before fetching.
                    </p>
                    <pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE sl PUBLIC "-//WAPFORUM//DTD SL 1.0//EN"
          "http://www.wapforum.org/DTD/sl.dtd"&gt;
&lt;sl href="http://wap.iobox.fi"
    action="execute-high"&gt;
&lt;/sl&gt;
                    </pre>
                    <p></p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6012">Starting necessary programs</a></h2>
                    <p>PPG test environment contains, in addition of wapbox and 
                        bearerbox, two test programs, <tt class="literal">test_ppg</tt> (simulating
                    push initiator) and <tt class="literal">test_http_server</tt> (simulating 
                    a SMSC center accepting pushed content send over SMS. You can find 
                    both of these programs in <tt class="literal">test</tt> directory, and they 
                    both are short and easily editable. 
                    </p>
                    <p>To set up a test environment, you must first configure a push
                        proxy gateway (setting flag trusted-pi true makes testing easier). 
                        This explained in Chapter "Setting up push proxy gateway". Then issue 
                        following commands, in Kannel's root directory and in separate windows:
                    </p>
                    <pre class="screen"><kbd class="userinput">
	gw/bearerbox [config-file]
	gw/wapbox [config-file]
	</kbd></pre>
                    Of course you can use more complicated wapbox and bearerbox command
                    line options, if necessary.
                    <p></p>
                    <p>To run a http smsc,  start http server simulation:
                    </p>
                    <pre class="screen"><kbd class="userinput">
	test/test_http_server -p port
	</kbd></pre>
                    You can, of course, select the port at will. Remember, though, that
                    PPG listens at the port defined in the ppg configuration file. Other 
                    <tt class="literal">test_http_server</tt> options are irrelevant here.
                    <p></p>
                    <p>Lastly, start making push requests, for instance with a test 
                        program <tt class="literal"> test_ppg</tt>. Its first argument is a URL 
                    specifying location of push services. Other arguments are two file 
                    names, first one push content and second one pap control document. 
                    (For command line options, see Table C.1.). For example doing one 
                    push(you can simplify push url by setting a ppg configuration variable,
                    see "Setting up push proxy gateway"; q flag here prevents dumping of 
                    test_ppg program debugging information):
                    </p>
                    <pre class="screen"><kbd class="userinput">
	test/test_ppg -q http://ppg-host-name:ppg-port/ppg-url [content_file] 
	[control_file]
	</kbd></pre>
                    <p> This presumes that you have set trusted-pi true.
                    </p>
                    <p>If you want use authentication in a test environment, you can pass
                        username and password either using headers (setting flag -b) or url (you
                        must have set trusted-pi false and added wap-push-user configuration group):
                    </p>
                    <pre class="screen"><kbd class="userinput">
	test/test_ppg -q http://ppg-host-name:ppg-port?username=ppg-username'&amp;'
	password=ppg-password [content_file] [control_file]
	</kbd></pre>
                    <div class="table">
                        <a name="AEN6033"></a>
                        <p><b>Table E-1. Test_ppg's command line options</b></p>
                        <table frame="void" class="CALSTABLE" border="0">
                            <colgroup>
                                <col>
                                <col>
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Switch</th>
                                    <th>Value</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><tt class="literal">-c</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Use content qualifier <span class="emphasis"><i class="emphasis">string</i></span> instead of 
                                default <tt class="literal">si</tt> (service indication). Allowed 
                            values are wml, si, sl, sia, multipart, nil and scrap. Nil and 
                            scrap are used for debugging purposes. Wml does work with some 
                            older phone simulators.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-a</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Use application id <span class="emphasis"><i class="emphasis">string</i></span> instead of default
                            <tt class="literal">any</tt>. Application identifies the application in
                            the phone that should handle the push request. Sia, ua, mms, nil
                            and scrap are accepted. Nil and scrap are used for debugging 
                            purposes.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-e</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Use transfer encoding when sending a push content. Only base64 is
                                currently supported.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-b</tt></td>
                            <td><span class="emphasis"><i class="emphasis">boolean</i></span></td>
                            <td valign="bottom">
                                Use headers for authentication, instead of url. Default off.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-i</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number</i></span></td>
                            <td valign="bottom">
                                Wait interval <span class="emphasis"><i class="emphasis">number</i></span> instead of default
                            <tt class="literal">0</tt> between pushes.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-r</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number</i></span></td>
                            <td valign="bottom">
                                Do <span class="emphasis"><i class="emphasis">number</i></span> requests instead of default
                            <tt class="literal">1</tt>.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-t</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number</i></span></td>
                            <td valign="bottom">
                                Use <span class="emphasis"><i class="emphasis">number</i></span> threads instead of default
                            <tt class="literal">1</tt>.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-s</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Use <tt class="literal">string</tt> as a X-WAP-Application-Id
                            header (You must supply whole header).
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-I</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Use <tt class="literal">string</tt> as a X-WAP-Initiator-URI
                            header (You must supply whole header).
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-B</tt></td>
                            <td><span class="emphasis"><i class="emphasis">boolean</i></span></td>
                            <td valign="bottom">
                                If set, accept binary content. Default is off.
                            <tt class="literal">1</tt>.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-d</tt></td>
                            <td><span class="emphasis"><i class="emphasis">enumerated string</i></span></td>
                            <td valign="bottom">
                                Set delimiter to be used. Acceptable values are crlf and
                                lf. Default is <tt class="literal">crlf</tt>.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-p</tt></td>
                            <td><span class="emphasis"><i class="emphasis">boolean</i></span></td>
                            <td valign="bottom">
                                If set, add an preamble (hard-coded one). Default
                                is off.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">-E</tt></td>
                            <td><span class="emphasis"><i class="emphasis">boolean</i></span></td>
                            <td valign="bottom">
                                if set, add an epilogue (hard-coded). Default is off.
                            </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6134">Using Nokia Toolkit as a part of a developing environment</a></h2>
                    <p>This chapter describes a developing environment using Nokia 
                        Toolkit instead of <tt class="literal">test_http_server</tt> program.
                    </p>
                    <p>You cannot use a real phone for testing a push server. Sending
                        random messages to a phone does not work, because its only feedback
                        (if it works properly) in error situations is dropping the offending
                        message.
                    </p>
                    <p>Nokia Toolkit, instead, displays push headers, decompiles
                        tokenized documents and outputs debugging information. It is not,
                        of course, a carbon copy of a real phone. But it is still useful
                        for checking spec conformance of push servers.
                    </p>
                    <p>Toolkit runs on Windows, the first thing you must is to install
                        a virtual machine (VMWare is one possibility) in the machine where
                        Kannel runs. Then you must configure Toolkit for working with a push
                        gateway.
                    </p>
                    <p>Then start <tt class="literal">bearerbox</tt> and <tt class="literal">wapbox
                    </tt> similar way as told before. You must set the correct client
                    address in the push document send by <tt class="literal">test_ppg</tt>
                    program. Use IP address of our virtual machine (easiest way to get this
                    is to ping your virtual machine name in the dos prompt window). Your
                    bearer is in this case IP. An example pap document follows:
                    </p>
                    <pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE pap PUBLIC "-//WAPFORUM//DTD PAP//EN"
          "http://www.wapforum.org/DTD/pap_1.0.dtd"&gt;
&lt;pap&gt;
  &lt;push-message push-id="9fjeo39jf084@pi.com"
                deliver-before-timestamp="2001-09-28T06:45:00Z"
                deliver-after-timestamp="2001-02-28T06:45:00Z"
                progress-notes-requested="false"&gt;
    &lt;address address-value="WAPPUSH=192.168.214.1/TYPE=IPV4@ppg.carrier.com"/&gt;
    &lt;quality-of-service priority="low"
                        delivery-method="unconfirmed"
    &lt;/quality-of-service&gt;
  &lt;/push-message&gt;
&lt;/pap&gt;
                    </pre>
                    <p>Note address-value format. It is contains type and value, 
                        because PAP protocol supports different address formats.
                    </p>
                    <p>You must use <tt class="literal">test_ppg</tt>'s -a and -c flags
                    when pushing messages to Toolkit. -A defines the client application
                    handling pushes, right value for it is ua. -C defines the content 
                    type of your push message. SI works with all Toolkits, wml only
                    with some older versions. 
                    </p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6149">Testing PAP protocol over HTTPS</a></h2>
                    <p>
                        When testing HTTPS connection to PPG, you probably want use test_ppg's
                        configuration file, because number of required parameters is quite 
                        high. Here is a example test_ppg configuration file:
                    </p>
                    <pre class="programlisting">
 group = test-ppg
 retries = 2
 pi-ssl = yes
 ssl-client-certkey-file = /etc/kannel/certkey.pem
 
 group = configuration
 push-url = https://localhost:8900/wappush
 pap-file = /etc/kannel/ipnoqos.txt
 content-file = /etc/kannel/si.txt
 username = foo
 password = bar
                    </pre>
                    <p>
                        With a configuration file, you can do a push by typing:
                    </p>
                    <pre class="screen"><kbd class="userinput">
        test/test_ppg -q [configuration_file]
	</kbd></pre>
                    <div class="table">
                        <a name="AEN6156"></a>
                        <p><b>Table E-2. Test_ppg's configuration file directives</b></p>
                        <table frame="void" class="CALSTABLE" border="0">
                            <colgroup>
                                <col>
                                <col>
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Directive</th>
                                    <th>Value</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><tt class="literal">group</tt></td>
                            <td><span class="emphasis"><i class="emphasis">test_ppg</i></span></td>
                            <td valign="bottom">
                                Mandatory parameter. Start of test_ppg's core group.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">retries</tt></td>
                            <td><span class="emphasis"><i class="emphasis">number</i></span></td>
                            <td valign="bottom">
                                The client tries to log in to PPG <span class="emphasis"><i class="emphasis">number</i></span> times
                                before discarding the push request. Default is 2.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">pi-ssl</tt></td>
                            <td><span class="emphasis"><i class="emphasis">boolean</i></span></td>
                            <td valign="bottom">
                                Mandatory parameter for HTTPS connection. Does the client use HTTPS
                                connection. Default is no.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ssl-client-certkey-file</tt></td>
                            <td><span class="emphasis"><i class="emphasis">filename</i></span></td>
                            <td valign="bottom">
                                Mandatory parameter for HTTPS connection. File containing the client's 
                                ssl certificate and private key. 
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">ssl-trusted-ca-file</tt></td>
                            <td>filename</td>
                            <td valign="bottom">
                                Mandatory parameter for HTTPS connection.This file contains the 
                                certificates test_ppg is willing to trust. If this directive is not set, 
                                certificates are not validated and HTTPS would not be tested.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">group</tt></td>
                            <td><span class="emphasis"><i class="emphasis">configuration</i></span></td>
                            <td valign="bottom">
                                Mandatory parameter. Start of test_ppg's test group.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">push-url</tt></td>
                            <td><span class="emphasis"><i class="emphasis">url</i></span></td>
                            <td valign="bottom">
                                Mandatory value. URL locating PPG's services.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">pap-file</tt></td>
                            <td><span class="emphasis"><i class="emphasis">filename</i></span></td>
                            <td valign="bottom">
                                Mandatory value. File containing pap request's control document.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">content-file</tt></td>
                            <td><span class="emphasis"><i class="emphasis">filename</i></span></td>
                            <td valign="bottom">
                                Mandatory value. File containing pap request's content document.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">username</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Mandatory value. PPG service user's username.
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">password</tt></td>
                            <td><span class="emphasis"><i class="emphasis">string</i></span></td>
                            <td valign="bottom">
                                Mandatory value. PPG service user's password.
                            </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="appendix">
                <hr>
                <h1><a name="AEN6231"></a>Appendix F. Setting up a dial-up line</h1>
                <p>This appendix explains how to set up a dial-up line in Linux
                    for use with the Kannel WAP gateway. In order for it to work you need
                    a Linux kernel with PPP capabilities. Most distributions provides PPP
                    kernel support by default. For more information how to compile PPP
                    support into the kernel please read the "Linux Kernel HOWTO"
                    at http://www.linuxdoc.org/.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6234">Analog modem</a></h2>
                    <p>This section explains how to set up a dial-up line with an
                        analog modem.
                    </p>
                    <p>Download and install the mgetty package.</p>
                    <pre class="screen"><kbd class="userinput">
	rpm -ivh mgetty-VERSION-rpm
	</kbd></pre>
                    <p>To run mgetty as a daemon, add the following line to
                        /etc/inittab.
                    </p>
                    <p>Read man inittab for more detailed information. In this
                        example we assume your modem is connected to the serial port ttyS0
                        (COM 1).
                    </p>
                    <pre class="screen"><kbd class="userinput">
	S0:2345:respawn:/sbin/mgetty ttyS0 -x 6 -D /dev/ttyS0
	</kbd></pre>
                    <p>We need to start the pppd automatically when mgetty receives
                        an AutoPPP request. Add the next line to /etc/mgetty+sendfax/login.config
                    </p>
                    <pre class="screen"><kbd class="userinput">
	/AutoPPP/ - - /usr/sbin/pppd file /etc/ppp/options.server
	</kbd></pre>
                    <p>In /etc/mgetty+sendfax/mgetty.config you might need to change
                        the connect speed between the computer and the modem. Note: this is
                        not the connect speed between the WAP client and the server modem.
                        If you are e.g. going to use a Nokia 7110 as the server side modem
                        you need to change the speed to 19200. Usually you can just leave the
                        speed to the default value (38400).
                    </p>
                    <pre class="screen"><kbd class="userinput">
	speed 38400
	</kbd></pre>
                    <p>Add the following lines to /etc/ppp/options.server</p>
                    <pre class="screen"><kbd class="userinput">
	refuse-chap
	require-pap
	lock
	modem
	crtscts
	passive
	192.168.1.10:192.168.1.20
	debug
	</kbd></pre>
                    <p>In /etc/ppp/pap-secrets add the username and password for the
                        ppp account. The IP address is the one assigned to the phone.
                    </p>
                    <pre class="screen"><kbd class="userinput">
	wapuser * wappswd 192.168.0.20
	</kbd></pre>
                    <p>Configure your phone (this example is for Nokia 7110)</p>
                    <pre class="screen"><kbd class="userinput">
	homepage http:/yourhost/hello.wml
	connection type continuous
	connection security off
	bearer data
	dial up number (your phone number)
	ip address (IP of host running bearerbox)
	auth type normal
	data call type analogue
	data call speed 9600
	username wapuser
	password wappswd
	</kbd></pre>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6259">ISDN terminal</a></h2>
                    <p>This section needs to be written</p>
                </div>
            </div>
            <div class="appendix">
                <hr>
                <h1><a name="regular-expressions"></a>Appendix G. Regular Expressions</h1>
                <p>Note: this is not intended to be an introduction to regular expressions (short: regex) but a 
                    description of their application within Kannel. For general information regarding regexes
                    please refer to <a href="#Biblio-regexp">[Biblio-regexp]</a>.
                </p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6266">Syntax and semantics of the regex configuration parameter</a></h2>
                    <p>This section describes the regex-configuration parameters and their effects in combination with the
                        respective non-regex-parameter, e.g. <tt class="literal">white-list</tt> and <tt class="literal">white-list-regex</tt>.
                    </p>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN6271">How-to setup the regex-parameters</a></h3>
                        <p>examples, short syntax, what happens on errors
                            Regex-parameters are configured just as every other parameter is configured. Regular expressions are
                            supported as defined by POSIX Extended Regular Expressions. Suppose a configuration where only SMS messages
                            originating from a sender using a number with a prefix of "040", "050", "070" or "090" are accepted.
                            Without regexes the configuration would read
                        </p>
                        <pre class="programlisting">
                allowed-prefix="040;050;070;090"
                        </pre>
                        Using regular expressions yields a more concise configuration
                        <pre class="programlisting">
                allowed-prefix-regex=^0[4579]0
                        </pre>
                        The following table gives an overview over some regex-operators and their meaning, the POSIX Regular
                        Expressions manual page (regex(7)). Once again, the extended regex-syntax is used and the table is 
                        just meant as a means to give a quick-start to regular expressions, the next section features some more
                        complex examples.
                        <div class="informaltable">
                            <p></p>
                            <a name="AEN6276"></a>
                            <table class="CALSTABLE" border="1">
                                <colgroup>
                                    <col>
                                    <col>
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th>Operator</th>
                                        <th>Meaning</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><tt class="literal">|</tt></td>
                                <td>or, for example "dog|hog" matches dog or hog.</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">{number,number}</tt></td>
                                <td>repetition, for example "a{2,5}" matches - among others - 
                                    "aa", "aaa" and "baaaaad"
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">*</tt></td>
                                <td>shorthand for {0,}</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">?</tt></td>
                                <td>shorthand for {0,1}</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">+</tt></td>
                                <td>shorthand for {1,}</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">[]</tt></td>
                                <td>bracket expression, defines a class of possible single character matches.
                                    For example "[hb]og" matches "hog" and "bog". If the expression starts with
                                <tt class="literal">^</tt> then the class is negated, e.g. "[^hb]og" does not match
                                "hog" and "bog" but matches for example "dog".
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">()</tt></td>
                                <td>groups patterns, e.g. "[hb]o(g|ld)" matches "hog", "hold", "bog", "bold"
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">[:class:]</tt></td>
                                <td>A character class such as digit, space etc. See wctype(3) for details.
                                </td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">^</tt></td>
                                <td>Start of line anchor.</td>
                                </tr>
                                <tr>
                                    <td><tt class="literal">$</tt></td>
                                <td>End of line anchor.</td>
                                </tr>
                                </tbody>
                            </table>
                            <p></p>
                        </div>
                        The advantages of regular expressions are at hand
                        <p></p>
                        <ul>
                            <li>
                                <p>Regexes are easier to understand, if one is fluent in POSIX Regular Expressions. 
                                    Although simple expressions as shown above should be clear to everyone who has
                                    ever used a standard UN*X shell.
                                </p>
                            </li>
                            <li>
                                <p>Regexes are easier to maintain. Suppose the example above needed to cope with 
                                    dozens of different prefixes each with subtle differences, in such cases using a - carefully
                                    constructed - regular expression could help to keep things in apple pie order. 
                                    Furthermore regexes help reducing redundancy within the configuration.
                                </p>
                            </li>
                            <li>
                                <p>Regexes more flexible than standard parameters.
                                </p>
                            </li>
                        </ul>
                        Nevertheless, it must be mentioned that - in addition to the overhead involved - complexity is an issue, 
                        too. Although the syntactic correctness of each used regular expression is ensured (see below)
                        the semantic correctness cannot be automatically proofed.
                        <p></p>
                        <p>
                            Expressions that are not compilable, which means they are not valid POSIX regexes, force  Kannel
                            to panic with a message like (note the missing "]")
                        </p>
                        <pre class="screen"><samp class="computeroutput">
                ERROR: gwlib/regex.c:106: gw_regex_comp_real: regex compilation `[hbo(g|ld)' failed: Invalid regular expression (Called from gw/urltrans.c:987:create_onetrans.)
                PANIC: Could not compile pattern '[hbo(g|ld)'
	</samp></pre>
                        As shown the erroneous pattern is reported in the error message. 
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN6334">Regex and non-regex-parameters</a></h3>
                        <p>
                            Using the regex and non-regex version of a parameter at the same time should be done with caution.
                            Both are combined in a boolean-or sense, for example
                        </p>
                        <pre class="programlisting">
                white-list=01234
                white-list-regex=^5(23)?$
                        </pre>
                        implies that a number is accepted either if it is "01234", "5" or "523" - note the use of anchors!
                        The same goes for all the other parameters, thus both mechanisms can be used without problems in parallel,
                        but care should be taken that the implications are understood and wanted.
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN6338">Performance issues</a></h3>
                        <p>While there is some overhead involved, the actual performance degradation is negligible.
                            At startup - e.g. when the configuration files are parsed - the regular expressions are pre-compiled
                            and stored in the pre-compiled fashion, thus future comparisons involve executing the expression on 
                            some string only. To be on the sure side, before using regexes extensively some benchmarking should be
                            performed, to verify that the loss of performance is acceptable.
                        </p>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6341">Examples</a></h2>
                    <p>This section discusses some simple scenarios and potential solutions based on regexes.
                        The examples are not meant to be comprehensive but rather informative.
                    </p>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN6344">Example 1: core-configuration</a></h3>
                        <p>The bearerbox must only accept SMS messages from three costumers. The first costumer uses numbers
                            that always start with "0824" the second one uses numbers that start with either "0123" and end in 
                            "314" or start with "0882" and end in "666". The third costumer uses numbers starting with "0167"
                            and ending in a number between "30" and "57".
                        </p>
                        <p>
                            Important in this and in the following examples is the use of anchors, otherwise a "string contains"
                            semantic instead of a "string is equal" semantic would be used.
                        </p>
                        <pre class="programlisting">
                group=core
                ...
                white-list-regex=^((0824[0-9]+)|(0123[0-9]+314)|(0882[0-9]+666)|(0167[0-9]+([34][0-9]|5[0-7])))$
                ...
                        </pre>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN6349">Example 3: smsc-configuration</a></h3>
                        <p>Only SMS messages originating from certain SMSCs (<tt class="literal">smsc-id</tt> is either 
                        "foo", "bar" or "blah")
                        are preferably forwarded to this smsc. 
                        Furthermore all SMSCs with an id containing "vodafone" must never
                        be forwarded to the smsc. Not the missing anchors around "vodafone".
                        </p>
                        <pre class="programlisting">
                group=smsc
                ...
                preferred-smsc-id-regex=^(foo|bar|blah)$
                denied-prefix-regex=vodafone
                ...
                        </pre>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN6354">Example 4: sms-service-configuration</a></h3>
                        <p>Please note that there are a mandatory <tt class="literal">keyword</tt> and an optional
                        <tt class="literal">keyword-regex</tt> fields.
                        That means that service selection can be simplified as in the following example.
                        Suppose that some Web-content should be delivered to the mobile. Different costumers use the 
                        same service but they rely on different keywords. Whenever a sms-service is requested, Kannel
                        first checks whether a regex has been defined, if not a literal match based on <tt class="literal">keyword</tt>
                        is performed. If a regex is configured then the literal match is never tried.
                        </p>
                        <pre class="programlisting">
                group=sms-service
                ...
                keyword=web_service
                keyword-regex=^(data|www|text|net)$
                get-url=http://someserver.net/getContent.jsp
                ...
                        </pre>
                    </div>
                </div>
            </div>
            <div class="appendix">
                <hr>
                <h1><a name="meta-data"></a>Appendix H. Meta Data</h1>
                <p>This appendix describes the elements and syntax required to access meta-data coming from and going to SMSC connections.</p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6364">Overview</a></h2>
                    <p>Many SMSC services have means to exchange data that doesn't conform to the established format</p>
                    <p>For example, the SMPP protocol defines the TLV (Tag, Length, Value) mechanism to allow adding arbitrary parameters
                        to it's PDU's, thus extending it's functionality.
                    </p>
                    <p>To achieve this, a special group and parameters were added to abstract the meta-data into something that could be used disregarding
                        the SMSC type.
                    </p>
                    <p>Currently only the SMPP module is implemented, but the format chosen allows for other modules to be added in the future.</p>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6370">SMPP Implementation</a></h2>
                    <p>A special group type <tt class="literal">smpp-tlv</tt> is needed for each TLV. Each group defines the address, data type and length of the TLV</p>
                    <p>Example configuration:</p>
                    <pre class="programlisting">
group = smpp-tlv
name = my_tlv_name
tag = 0x1601
type = octetstring
length = 20
smsc-id = a;b;c
                    </pre>
                    <div class="informaltable">
                        <p></p>
                        <a name="AEN6376"></a>
                        <table frame="void" class="CALSTABLE" border="0">
                            <colgroup>
                                <col>
                                <col>
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Variable</th>
                                    <th>Data Type</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><tt class="literal">tag</tt></td>
                            <td><tt class="literal">hex</tt></td>
                            <td valign="bottom">
                                32-Bit HEX address for the given TLV. Must match SMPP specifications for the TLV (or be agreed with the SMSC operator).
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">type</tt></td>
                            <td><tt class="literal">string</tt></td>
                            <td valign="bottom">
                                Accepted data type. Accepted values are <tt class="literal">integer</tt>, <tt class="literal">nulterminated</tt> and <tt class="literal">octetstring</tt>.
                            Must match SMPP specifications for the TLV (or be agreed with the SMSC operator).
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">length</tt></td>
                            <td><tt class="literal">integer</tt></td>
                            <td valign="bottom">
                                Maximum data length expected in bytes. Must match SMPP specifications for the TLV (or be agreed with the SMSC operator).
                            </td>
                            </tr>
                            <tr>
                                <td><tt class="literal">smsc-id</tt></td>
                            <td><tt class="literal">string</tt></td>
                            <td valign="bottom">
                                An optional smsc-id for which this TLV is valid. If smsc-id is not given
                                then this TLV is valid for all SMSCs.
                                To define list of smsc-id, just use ; as split char.
                            </td>
                            </tr>
                            </tbody>
                        </table>
                        <p></p>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN6411">MO Messages</a></h3>
                        <p>Meta Data coming from MO messages comes urlencoded into the <tt class="literal">%D</tt> parameter. Only TLV parameters defined on the configuration file are honored.</p>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN6415">Example</a></h4>
                            <p><tt class="literal">http://localhost/myscript?...&amp;meta-data=%D&amp;...</tt></p>
                        </div>
                    </div>
                    <div class="sect2">
                        <hr>
                        <h3 class="sect2"><a name="AEN6419">MT Messages</a></h3>
                        <p>To send into an MT messages the <tt class="literal">meta-data</tt> parameter should be used.</p>
                        <p>The format used to pass the data has 2 parts: The <tt class="literal">?smsc-type?</tt> (surrounded by question marks),
                        which specify the kind of smsc receiving the data (at the moment only <tt class="literal">smpp</tt> is implemented) and then a set of key/value
                        pairs with the data to be transmitted. Extra smsc-types can be added surrounded by question marks and followed by the key/value pairs.
                        </p>
                        <p>In other words,  the data should be coded using the following format, where URLENCODE() implies that the data between parentheses should
                            be urlencoded:
                        </p>
                        <p><tt class="literal">?URLENCODE(&lt;smsc-type1&gt;)?URLENCODE(key1)=URLENCODE(value1)&amp;URLENCODE(key2)=URLENCODE(value2)&amp;...</tt></p>
                        <p><tt class="literal">?URLENCODE(&lt;smsc-type2&gt;)?URLENCODE(key1)=URLENCODE(value1)&amp;...</tt></p>
                        <p>Only the parameters defined on the configuration file are honored.</p>
                        <p>Important: For the sendsms interface, you must URLENCODE the resulting string again to pass it as a single parameter on the URL.</p>
                        <div class="sect3">
                            <hr>
                            <h4 class="sect3"><a name="AEN6433">Examples</a></h4>
                            <p>If we want to send the parameter "my-data" with value "Hello World" to an SMSC over SMPP, we'd use:</p>
                            <p>sendsms get-url:</p>
                            <p><tt class="literal">http://localhost:13013/cgi-bin/sendsms?...&amp;meta-data=%3Fsmpp%3Fmy-data%3DHello%2BWorld</tt></p>
                            <p>sendsms post:</p>
                            <p>Send <tt class="literal">?smpp?my-data=Hello+World</tt> on the <tt class="literal">X-Kannel-Meta-Data</tt> header</p>
                            <p>XML:</p>
                            <p><tt class="literal">&lt;meta-data&gt;?smpp?my-data=Hello+World&lt;/meta-data&gt;</tt></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="appendix">
                <hr>
                <h1><a name="AEN6446"></a>Appendix I. Log files</h1>
                <p>This appendix describes the log file format.</p>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6449">Bearerbox Access Log</a></h2>
                    <pre class="screen"><samp class="computeroutput">
	2001-01-01 12:00:00 Sent SMS [SMSC:smsc] [SVC:sms] [ACT:account] [BINFO:binfo] [FID:1234567890] [META:meta]
            [from:12345] [to:67890] [flags:0:1:0:0:0] [msg:11:Hello World] [udh:0]
	</samp></pre>
                    <div class="informaltable">
                        <p></p>
                        <a name="AEN6453"></a>
                        <table frame="void" class="CALSTABLE" border="0">
                            <colgroup>
                                <col>
                                <col>
                                <col>
                            </colgroup>
                            <thead>
                                <tr>
                                    <th>Variable</th>
                                    <th>Value</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Date</td>
                                    <td>2001-01-01 12:00:00</td>
                                    <td valign="bottom">
                                        Date
                                    </td>
                                </tr>
                                <tr>
                                    <td>Result</td>
                                    <td>Sent SMS</td>
                                    <td valign="bottom">
                                        Result: Send, failed, DLR (deliver report), Received, etc.
                                    </td>
                                </tr>
                                <tr>
                                    <td>SMSC</td>
                                    <td>smsc</td>
                                    <td valign="bottom">
                                        Smsc id (<tt class="literal">smsc-id</tt>) defined in configuration 
                            group <tt class="literal">smsc</tt> 
                            </td>
                            </tr>
                            <tr>
                                <td>SVC</td>
                                <td>sms</td>
                                <td valign="bottom">
                                    Service name (<tt class="literal">name</tt>) defined in configuration 
                            group <tt class="literal">sendsms-user</tt>
                            </td>
                            </tr>
                            <tr>
                                <td>ACT</td>
                                <td>account</td>
                                <td valign="bottom">
                                    Account name (<tt class="literal">name</tt>) defined in configuration 
                            group <tt class="literal">sendsms-user</tt>
                            </td>
                            </tr>
                            <tr>
                                <td>BINF</td>
                                <td>binfo</td>
                                <td valign="bottom">
                                    Billing information used to send this message.
                                </td>
                            </tr>
                            <tr>
                                <td>Foreign ID</td>
                                <td>1234567890</td>
                                <td valign="bottom">
                                    Foreign (SMSC-provided) Message ID (only available on MT messages)
                                </td>
                            </tr>
                            <tr>
                                <td>META</td>
                                <td>meta-data</td>
                                <td valign="bottom">
                                    Meta-data used to send this message.
                                    See <a href="#meta-data">Meta Data</a> for an explanation about meta-data.
                                </td>
                            </tr>
                            <tr>
                                <td>from</td>
                                <td>12345</td>
                                <td valign="bottom">
                                    Sender
                                </td>
                            </tr>
                            <tr>
                                <td>to</td>
                                <td>67890</td>
                                <td valign="bottom">
                                    Recipient
                                </td>
                            </tr>
                            <tr>
                                <td>Flags</td>
                                <td>0:1:0:0:0</td>
                                <td valign="bottom">
                                    Flags: MClass, Coding, MWI, Compress, DLRMask
                                </td>
                            </tr>
                            <tr>
                                <td>Message Text</td>
                                <td>11:Hello World</td>
                                <td valign="bottom">
                                    Size of message and message dump (in text or hex if it's binary)
                                </td>
                            </tr>
                            <tr>
                                <td>User Data Header</td>
                                <td>0:</td>
                                <td valign="bottom">
                                    Size of UDH and UDH Hex dump 
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        <p></p>
                    </div>
                </div>
                <div class="sect1">
                    <hr>
                    <h2 class="sect1"><a name="AEN6520">Log rotation</a></h2>
                    <p>If Kannel is configured so that the bearerbox, wapbox and/or smsbox 
                        log to file each of these log files will continue to grow unless administered
                        in some way (this is specially true if access logs are created and/or the 
                        log level is set to debug). 
                    </p>
                    <p>
                        A typical way of administering log files is to 'rotate' the logs on a regular 
                        basis using a tool such as logrotate.  A sample logrotate script (to be added 
                        to /etc/logrotate.d) is shown below. In this example the Kannel log files found 
                        in /var/log/kannel are rotated and compressed daily over 365 days.  See the 
                        documentation for logrotate for more details.  Of particular note however is the 
                        postrotate command, this killall -HUP issues a HUP command to each Kannel
                        box running. The HUP signal has the effect of reopening the log file, without this 
                        command Kannel will continue to write to the rotated log file.
                    </p>
                    <pre class="screen"><kbd class="userinput">
        /var/log/kannel/*.log {
              daily
              missingok
              rotate 365
              compress
              delaycompress
              notifempty
              create 640 kannel adm
              sharedscripts
              postrotate
                    killall -HUP bearerbox smsbox wapbox || true &gt; /dev/null 2&gt; /dev/null
              endscript
        }
        </kbd></pre>
                </div>
            </div>
            <div class="GLOSSARY">
                <h1><a name="AEN6526"></a>Glossary</h1>
                <div class="glossdiv">
                    <h1 class="glossdiv"><a name="AEN6528">M</a></h1>
                    <dl>
                        <dt><a name="MO"></a><b>MO</b></dt>
                        <dd>
                            <p>Mobile Originated - a SMS from mobile to application</p>
                        </dd>
                        <dt><a name="MT"></a><b>MT</b></dt>
                        <dd>
                            <p>Mobile Terminated - a SMS from application to mobile</p>
                        </dd>
                        <dt><a name="MWI"></a><b>MWI</b></dt>
                        <dd>
                            <p>Message Waiting Indicator (See <a href="#Biblio-3GPP-23038">[Biblio-3GPP-23038]</a>)</p>
                        </dd>
                        <dt><a name="MCLASS"></a><b>MClass</b></dt>
                        <dd>
                            <p>Message Class (See <a href="#Biblio-3GPP-23038">[Biblio-3GPP-23038]</a>)</p>
                        </dd>
                        <dt><a name="CODING"></a><b>Coding</b></dt>
                        <dd>
                            <p>Message Coding (See <a href="#Biblio-3GPP-23038">[Biblio-3GPP-23038]</a>)</p>
                        </dd>
                    </dl>
                </div>
            </div>
            <a name="AEN6553"></a>
            <hr>
            <h1><a name="AEN6553"></a>Bibliography</h1>
            <div class="biblioentry">
                <a name="Biblio-RFC-2616"></a>
                <p><i>RFC 2616 - Hypertext Transfer Protocol -- HTTP/1.1</i>, <a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html" target="_top">http://www.w3.org/Protocols/rfc2616/rfc2616.html</a>, <i>Request for Comments: 2616</i>, The Internet Society, 1999.</p>
                <div class="BIBLIOENTRYBLOCK" style="margin-left: 0.5in"></div>
            </div>
            <div class="biblioentry">
                <a name="Biblio-3GPP-23038"></a>
                <p><i>3GPP 23.038</i>, <a href="http://www.3gpp.org/ftp/Specs/latest/Rel-5/23_series/23038-500.zip" target="_top">http://www.3gpp.org/ftp/Specs/latest/Rel-5/23_series/23038-500.zip</a>, <i>...</i>, 3GPP, ?.</p>
                <div class="BIBLIOENTRYBLOCK" style="margin-left: 0.5in"></div>
            </div>
            <div class="biblioentry">
                <a name="Biblio-3GPP-23040"></a>
                <p><i>3GPP 23.040</i>, <a href="http://www.3gpp.org/ftp/Specs/latest/Rel-5/23_series/23040-530.zip" target="_top">http://www.3gpp.org/ftp/Specs/latest/Rel-5/23_series/23040-530.zip</a>, <i>...</i>, 3GPP, ?.</p>
                <div class="BIBLIOENTRYBLOCK" style="margin-left: 0.5in"></div>
            </div>
            <div class="biblioentry">
                <a name="Biblio-regexp"></a>
                <p><i>regex(7), GNU regex manual</i><i>: </i><i></i>, GNU, 1998.</p>
                <div class="BIBLIOENTRYBLOCK" style="margin-left: 0.5in"></div>
            </div>
        </div>
    </body>
</html>
